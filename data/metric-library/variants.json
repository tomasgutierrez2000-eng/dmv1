[
  {
    "variant_id": "# Loans",
    "variant_name": "Total Number of Loans",
    "parent_metric_id": "# Loans",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count loans",
    "executable_metric_id": "# Loans",
    "detailed_description": "Count of individual loans within portfolio or facility grouping. Supports exposure granularity analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.756Z",
    "updated_at": "2026-02-21T18:04:26.756Z"
  },
  {
    "variant_id": "all_in_rate_pct",
    "variant_name": "Weighted Average All-In Rate (%)",
    "parent_metric_id": "all_in_rate_pct",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(All-In Rate × Exposure) / Total Exposure",
    "executable_metric_id": "all_in_rate_pct",
    "detailed_description": "Total effective interest rate including base rate and spread. Calculated pricing KPI that provides insight into total yield generation and supports risk-adjusted return analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.756Z",
    "updated_at": "2026-02-21T18:04:26.756Z"
  },
  {
    "variant_id": "amendmentStartDate",
    "variant_name": "—",
    "parent_metric_id": "amendmentStartDate",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Timestamp",
    "executable_metric_id": "amendmentStartDate",
    "detailed_description": "Date amendment became effective.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.756Z",
    "updated_at": "2026-02-21T18:04:26.756Z"
  },
  {
    "variant_id": "amendmentStatus",
    "variant_name": "—",
    "parent_metric_id": "amendmentStatus",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Descriptive",
    "executable_metric_id": "amendmentStatus",
    "detailed_description": "Status of amendment approval lifecycle.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.756Z",
    "updated_at": "2026-02-21T18:04:26.756Z"
  },
  {
    "variant_id": "amendmentType",
    "variant_name": "—",
    "parent_metric_id": "amendmentType",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Descriptive",
    "executable_metric_id": "amendmentType",
    "detailed_description": "Type of contractual amendment (e.g., covenant reset, maturity extension).",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.757Z",
    "updated_at": "2026-02-21T18:04:26.757Z"
  },
  {
    "variant_id": "As Of Date",
    "variant_name": "—",
    "parent_metric_id": "As Of Date",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Timestamp",
    "executable_metric_id": "As Of Date",
    "detailed_description": "Snapshot date associated with the exposure record. Serves as timestamp reference for reporting accuracy.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.757Z",
    "updated_at": "2026-02-21T18:04:26.757Z"
  },
  {
    "variant_id": "Avg Spread (%)",
    "variant_name": "Weighted Average Spread (%)",
    "parent_metric_id": "Avg Spread (%)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Spread × Exposure) / Total Exposure",
    "executable_metric_id": "Avg Spread (%)",
    "detailed_description": "Weighted average credit spread across exposures. Calculated as Σ(Spread × Exposure) / Total Exposure. Provides insight into portfolio pricing discipline and yield profile.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.757Z",
    "updated_at": "2026-02-21T18:04:26.757Z"
  },
  {
    "variant_id": "Avg Tenor (Years)",
    "variant_name": "Weighted Average Tenor (Years)",
    "parent_metric_id": "Avg Tenor (Years)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Tenor × Exposure) / Total Exposure",
    "executable_metric_id": "Avg Tenor (Years)",
    "detailed_description": "Weighted average remaining maturity across exposures. Calculated as Σ(Tenor × Exposure) / Total Exposure. Measures portfolio duration and refinancing risk exposure.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.757Z",
    "updated_at": "2026-02-21T18:04:26.757Z"
  },
  {
    "variant_id": "base_rate_pct",
    "variant_name": "Weighted Average Base Rate (%)",
    "parent_metric_id": "base_rate_pct",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Base Rate × Exposure) / Total Exposure",
    "executable_metric_id": "base_rate_pct",
    "detailed_description": "Reference benchmark interest rate applicable to the exposure (e.g., SOFR, Prime). Forms base component of total facility pricing.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.757Z",
    "updated_at": "2026-02-21T18:04:26.757Z"
  },
  {
    "variant_id": "Capital Allocated ($M)",
    "variant_name": "Total Capital Allocated ($$M)",
    "parent_metric_id": "Capital Allocated ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum of capital assigned",
    "executable_metric_id": "Capital Allocated ($M)",
    "detailed_description": "Economic or regulatory capital assigned to exposure. Used in RAROC and capital efficiency evaluation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.758Z",
    "updated_at": "2026-02-21T18:04:26.758Z"
  },
  {
    "variant_id": "Cashflow ($M)",
    "variant_name": "Total Cashflow ($$M)",
    "parent_metric_id": "Cashflow ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ Cashflow",
    "executable_metric_id": "Cashflow ($M)",
    "detailed_description": "Operating cash flow generated by borrower in millions USD. Primary indicator of repayment capacity.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.758Z",
    "updated_at": "2026-02-21T18:04:26.758Z"
  },
  {
    "variant_id": "Collateral Value ($M)",
    "variant_name": "Collateral Coverage Ratio (%)",
    "parent_metric_id": "Collateral Value ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Collateral Value / Exposure) × 100",
    "executable_metric_id": "Collateral Value ($M)",
    "detailed_description": "Value of pledged collateral securing exposure in millions USD. Supports recovery analysis and secured lending assessment.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.758Z",
    "updated_at": "2026-02-21T18:04:26.758Z"
  },
  {
    "variant_id": "Committed Amount ($M)",
    "variant_name": "Total Committed Amount ($$M)",
    "parent_metric_id": "Committed Amount ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ Committed Amount",
    "executable_metric_id": "Committed Amount ($M)",
    "detailed_description": "Total approved committed credit amount in millions USD representing contractual lending capacity.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.758Z",
    "updated_at": "2026-02-21T18:04:26.758Z"
  },
  {
    "variant_id": "Cost of Funds ($M)",
    "variant_name": "Total Cost of Funds ($$M)",
    "parent_metric_id": "Cost of Funds ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum of funding costs",
    "executable_metric_id": "Cost of Funds ($M)",
    "detailed_description": "Funding expense allocated to exposure in millions USD. Supports net profitability and risk-adjusted return calculations.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.758Z",
    "updated_at": "2026-02-21T18:04:26.758Z"
  },
  {
    "variant_id": "Counterparty Allocation %",
    "variant_name": "Exposure Concentration %",
    "parent_metric_id": "Counterparty Allocation %",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Exposure by Counterparty / Total Exposure) × 100",
    "executable_metric_id": "Counterparty Allocation %",
    "detailed_description": "Exposure allocated to specific counterparty divided by total exposure. Concentration KPI measuring obligor dependency risk.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.759Z",
    "updated_at": "2026-02-21T18:04:26.759Z"
  },
  {
    "variant_id": "Counterparty ID",
    "variant_name": "—",
    "parent_metric_id": "Counterparty ID",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Identifier",
    "executable_metric_id": "Counterparty ID",
    "detailed_description": "Unique system identifier assigned to the borrower or obligor. Used for exposure aggregation and risk consolidation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.759Z",
    "updated_at": "2026-02-21T18:04:26.759Z"
  },
  {
    "variant_id": "Counterparty Name",
    "variant_name": "—",
    "parent_metric_id": "Counterparty Name",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Identifier",
    "executable_metric_id": "Counterparty Name",
    "detailed_description": "Legal name of the borrowing entity. Used for reporting, documentation, and risk attribution.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.759Z",
    "updated_at": "2026-02-21T18:04:26.759Z"
  },
  {
    "variant_id": "Country",
    "variant_name": "Exposure by Country (%)",
    "parent_metric_id": "Country",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Exposure by country / Total exposure × 100",
    "executable_metric_id": "Country",
    "detailed_description": "Country of risk or booking location. Supports geographic concentration and sovereign risk analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.760Z",
    "updated_at": "2026-02-21T18:04:26.760Z"
  },
  {
    "variant_id": "creditAgreementId",
    "variant_name": "—",
    "parent_metric_id": "creditAgreementId",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Identifier",
    "executable_metric_id": "creditAgreementId",
    "detailed_description": "Unique identifier linking facility to governing credit agreement documentation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.760Z",
    "updated_at": "2026-02-21T18:04:26.760Z"
  },
  {
    "variant_id": "Criticized",
    "variant_name": "% Criticized Loans (%)",
    "parent_metric_id": "Criticized",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Count criticized / Total) × 100",
    "executable_metric_id": "Criticized",
    "detailed_description": "Flag identifying exposures requiring heightened monitoring due to elevated credit risk. Governance control used for enhanced monitoring, reserve consideration, and management reporting.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.761Z",
    "updated_at": "2026-02-21T18:04:26.761Z"
  },
  {
    "variant_id": "crossEntityExposureAmount",
    "variant_name": "Total Cross-Entity Exposure ($M)",
    "parent_metric_id": "crossEntityExposureAmount",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum of such exposures",
    "executable_metric_id": "crossEntityExposureAmount",
    "detailed_description": "Total exposure amount allocated across legal entities. Supports intra-group concentration transparency.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.762Z",
    "updated_at": "2026-02-21T18:04:26.762Z"
  },
  {
    "variant_id": "Current Risk Rating",
    "variant_name": "Exposure-Weighted Average Risk Rating",
    "parent_metric_id": "Current Risk Rating",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Risk Rating × Exposure) / Total Exposure",
    "executable_metric_id": "Current Risk Rating",
    "detailed_description": "Most recent internal credit rating assigned at reporting date. Used for segmentation and exposure-weighted risk aggregation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.762Z",
    "updated_at": "2026-02-21T18:04:26.762Z"
  },
  {
    "variant_id": "Days Delinquent",
    "variant_name": "Average Days Delinquent",
    "parent_metric_id": "Days Delinquent",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Average over delinquent loans",
    "executable_metric_id": "Days Delinquent",
    "detailed_description": "Number of days contractual payment obligation is past due. Used for staging classification and early credit deterioration monitoring.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.763Z",
    "updated_at": "2026-02-21T18:04:26.763Z"
  },
  {
    "variant_id": "Days Until Maturity",
    "variant_name": "Average Days to Maturity",
    "parent_metric_id": "Days Until Maturity",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Average (Maturity Date - Reporting Date)",
    "executable_metric_id": "Days Until Maturity",
    "detailed_description": "Number of calendar days remaining until contractual maturity, calculated as (Maturity Date – Reporting Date). Derived tenor metric providing insight into rollover risk and portfolio duration concentration.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.763Z",
    "updated_at": "2026-02-21T18:04:26.763Z"
  },
  {
    "variant_id": "days_overdue",
    "variant_name": "Average Days Overdue",
    "parent_metric_id": "days_overdue",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Weighted average days overdue",
    "executable_metric_id": "days_overdue",
    "detailed_description": "Number of calendar days payment remains unpaid beyond due date. Supports staging classification and regulatory default identification.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.764Z",
    "updated_at": "2026-02-21T18:04:26.764Z"
  },
  {
    "variant_id": "Delinquency Rate (%)",
    "variant_name": "Delinquency Rate",
    "parent_metric_id": "Delinquency Rate (%)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count delinquent loans / Total loans × 100",
    "executable_metric_id": "Delinquency Rate (%)",
    "detailed_description": "Calculated as Count of Delinquent Loans / Total Loans × 100. Portfolio stress KPI measuring prevalence of past-due exposures.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.765Z",
    "updated_at": "2026-02-21T18:04:26.765Z"
  },
  {
    "variant_id": "Delinquent",
    "variant_name": "% Delinquent Loans (%)",
    "parent_metric_id": "Delinquent",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Count delinquent loans / Total loans) × 100",
    "executable_metric_id": "Delinquent",
    "detailed_description": "Indicator that exposure is past due. Used for credit monitoring, staging assessment, and early default identification.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.765Z",
    "updated_at": "2026-02-21T18:04:26.765Z"
  },
  {
    "variant_id": "delinquent_amount_m",
    "variant_name": "Total Delinquent Amount ($M)",
    "parent_metric_id": "delinquent_amount_m",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ Delinquent Amount",
    "executable_metric_id": "delinquent_amount_m",
    "detailed_description": "Total outstanding exposure that is contractually past due in millions USD. Provides direct measurement of impaired balances and supports staging and loss forecasting analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.765Z",
    "updated_at": "2026-02-21T18:04:26.765Z"
  },
  {
    "variant_id": "Deteriorated",
    "variant_name": "% Deteriorated Loans (%)",
    "parent_metric_id": "Deteriorated",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Count deteriorated / Total) × 100",
    "executable_metric_id": "Deteriorated",
    "detailed_description": "Derived indicator that the facility’s internal credit rating has worsened during the reporting period. Provides automated early deterioration signal supporting migration monitoring and risk escalation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.766Z",
    "updated_at": "2026-02-21T18:04:26.766Z"
  },
  {
    "variant_id": "DSCR",
    "variant_name": "% Facilities with DSCR < 1",
    "parent_metric_id": "DSCR",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count(DSCR<1) / Total facilities × 100",
    "executable_metric_id": "DSCR",
    "detailed_description": "Cashflow divided by Total Debt Service. Calculated KPI measuring borrower’s ability to meet debt obligations from operating cash flow and providing insight into covenant compliance and credit resilience.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.766Z",
    "updated_at": "2026-02-21T18:04:26.766Z"
  },
  {
    "variant_id": "effectiveDate",
    "variant_name": "—",
    "parent_metric_id": "effectiveDate",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Timestamp",
    "executable_metric_id": "effectiveDate",
    "detailed_description": "Date on which credit agreement or facility became legally effective.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.766Z",
    "updated_at": "2026-02-21T18:04:26.766Z"
  },
  {
    "variant_id": "EL_Rate",
    "variant_name": "Average Expected Loss Rate (%)",
    "parent_metric_id": "EL_Rate",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Expected Loss / Exposure) × 100",
    "executable_metric_id": "EL_Rate",
    "detailed_description": "Expected Loss divided by Exposure. Derived KPI measuring loss intensity relative to exposure size, enabling comparative risk ranking across facilities or counterparties.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.767Z",
    "updated_at": "2026-02-21T18:04:26.767Z"
  },
  {
    "variant_id": "Exception_Rate",
    "variant_name": "% Facilities with Exceptions",
    "parent_metric_id": "Exception_Rate",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count exceptions / Total facilities × 100",
    "executable_metric_id": "Exception_Rate",
    "detailed_description": "Percentage of exposures within portfolio with approved pricing or policy exceptions. Derived governance KPI measuring policy discipline and risk culture strength.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.767Z",
    "updated_at": "2026-02-21T18:04:26.767Z"
  },
  {
    "variant_id": "expected_loss_m",
    "variant_name": "Total Expected Loss ($M)",
    "parent_metric_id": "expected_loss_m",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Exposure × PD × LGD)",
    "executable_metric_id": "expected_loss_m",
    "detailed_description": "PD × LGD × EAD. Calculated forward-looking credit loss estimate providing insight into economic loss expectations and supporting provisioning, capital allocation, and portfolio risk prioritization.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.768Z",
    "updated_at": "2026-02-21T18:04:26.768Z"
  },
  {
    "variant_id": "Expected_Loss_USD",
    "variant_name": "Total Expected Loss ($)",
    "parent_metric_id": "Expected_Loss_USD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Exposure × PD × LGD)",
    "executable_metric_id": "Expected_Loss_USD",
    "detailed_description": "PD × LGD × EAD expressed in USD. Calculated forward-looking loss metric supporting provisioning, capital planning, and stress testing analytics.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.768Z",
    "updated_at": "2026-02-21T18:04:26.768Z"
  },
  {
    "variant_id": "Exposure - (\"Current\") Outstanding",
    "variant_name": "Total Outstanding Exposure ($M)",
    "parent_metric_id": "Exposure - (\"Current\") Outstanding",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Outstanding Exposure)",
    "executable_metric_id": "Exposure - (\"Current\") Outstanding",
    "detailed_description": "Current drawn principal balance outstanding in millions USD. Represents funded credit risk at reporting date.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.768Z",
    "updated_at": "2026-02-21T18:04:26.768Z"
  },
  {
    "variant_id": "Exposure - Undrawn",
    "variant_name": "Total Undrawn Exposure ($M)",
    "parent_metric_id": "Exposure - Undrawn",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Undrawn Exposure)",
    "executable_metric_id": "Exposure - Undrawn",
    "detailed_description": "Committed but not yet drawn portion of credit exposure in millions USD. Reflects contingent funding risk.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.769Z",
    "updated_at": "2026-02-21T18:04:26.769Z"
  },
  {
    "variant_id": "Exposure - Utilized",
    "variant_name": "Utilization Rate (%)",
    "parent_metric_id": "Exposure - Utilized",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Utilized Exposure / Committed Amount) × 100",
    "executable_metric_id": "Exposure - Utilized",
    "detailed_description": "Portion of committed exposure currently drawn. Used to assess funding deployment and credit capacity usage.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.769Z",
    "updated_at": "2026-02-21T18:04:26.769Z"
  },
  {
    "variant_id": "Exposure ($M)",
    "variant_name": "Total Exposure ($$M)",
    "parent_metric_id": "Exposure ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ Exposure",
    "executable_metric_id": "Exposure ($M)",
    "detailed_description": "Current funded credit exposure outstanding in millions USD. Core balance sheet risk metric representing on-balance-sheet credit risk.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.769Z",
    "updated_at": "2026-02-21T18:04:26.769Z"
  },
  {
    "variant_id": "Exposure Limit ($M)",
    "variant_name": "Utilization %",
    "parent_metric_id": "Exposure Limit ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Exposure / Exposure Limit) × 100",
    "executable_metric_id": "Exposure Limit ($M)",
    "detailed_description": "Maximum approved credit exposure authorized for the counterparty or facility in millions USD. Represents formal risk appetite allocation and governance control threshold.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.770Z",
    "updated_at": "2026-02-21T18:04:26.770Z"
  },
  {
    "variant_id": "exposure_at_default_m",
    "variant_name": "Total Exposure at Default ($M)",
    "parent_metric_id": "exposure_at_default_m",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ Exposure at Default",
    "executable_metric_id": "exposure_at_default_m",
    "detailed_description": "Total expected exposure outstanding at time of default in millions USD. Regulatory capital modeling input that reflects forward-looking credit risk position.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.770Z",
    "updated_at": "2026-02-21T18:04:26.770Z"
  },
  {
    "variant_id": "external_rating",
    "variant_name": "% Exposure Rated Investment Grade",
    "parent_metric_id": "external_rating",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Exposure rated BBB+ or above / Total exposure) × 100",
    "executable_metric_id": "external_rating",
    "detailed_description": "Current external credit agency rating assigned to the obligor. Used for benchmarking, regulatory reporting, and external credit risk validation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.771Z",
    "updated_at": "2026-02-21T18:04:26.771Z"
  },
  {
    "variant_id": "Facility ID",
    "variant_name": "—",
    "parent_metric_id": "Facility ID",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Identifier",
    "executable_metric_id": "Facility ID",
    "detailed_description": "Unique identifier assigned to the lending facility within enterprise systems. Used to aggregate balances, risk metrics, pricing data, and contractual attributes at the facility level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.771Z",
    "updated_at": "2026-02-21T18:04:26.771Z"
  },
  {
    "variant_id": "Facility Name",
    "variant_name": "—",
    "parent_metric_id": "Facility Name",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Descriptive",
    "executable_metric_id": "Facility Name",
    "detailed_description": "Descriptive name of the facility as documented in the credit agreement. Used for reporting clarity and operational reference.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.772Z",
    "updated_at": "2026-02-21T18:04:26.772Z"
  },
  {
    "variant_id": "Facility Utilization Status (e.g., Sufficient, Approaching, Fully Utilized)",
    "variant_name": "% Facilities Fully Utilized",
    "parent_metric_id": "Facility Utilization Status (e.g., Sufficient, Approaching, Fully Utilized)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count fully utilized / Total facilities × 100",
    "executable_metric_id": "Facility Utilization Status (e.g., Sufficient, Approaching, Fully Utilized)",
    "detailed_description": "Derived categorical classification of utilization level based on current drawn exposure relative to committed amount. Operational KPI providing early warning insight into limit pressure, liquidity usage, and potential capacity constraints.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.772Z",
    "updated_at": "2026-02-21T18:04:26.772Z"
  },
  {
    "variant_id": "facilityType",
    "variant_name": "Exposure by Facility Type",
    "parent_metric_id": "facilityType",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum exposure by facility type",
    "executable_metric_id": "facilityType",
    "detailed_description": "Type of credit facility (e.g., Term Loan, Revolver, Letter of Credit). Enables product-level segmentation, risk concentration analysis, and performance benchmarking.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.773Z",
    "updated_at": "2026-02-21T18:04:26.773Z"
  },
  {
    "variant_id": "Fee Rate (%)",
    "variant_name": "Weighted Average Fee Rate (%)",
    "parent_metric_id": "Fee Rate (%)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Fee Rate × Exposure) / Total Exposure",
    "executable_metric_id": "Fee Rate (%)",
    "detailed_description": "Fee percentage applied to committed or undrawn exposure. Calculated KPI supporting pricing adequacy and revenue optimization analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.773Z",
    "updated_at": "2026-02-21T18:04:26.773Z"
  },
  {
    "variant_id": "fr2590Category",
    "variant_name": "Exposure by Regulatory Category",
    "parent_metric_id": "fr2590Category",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum exposure by category",
    "executable_metric_id": "fr2590Category",
    "detailed_description": "Regulatory classification aligned to FR Y-14 / FR 2590 frameworks. Supports capital and stress testing submissions.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.773Z",
    "updated_at": "2026-02-21T18:04:26.773Z"
  },
  {
    "variant_id": "hasAmendment",
    "variant_name": "% Facilities with Amendments",
    "parent_metric_id": "hasAmendment",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count amended facilities / Total facilities × 100",
    "executable_metric_id": "hasAmendment",
    "detailed_description": "Indicator that facility agreement has undergone amendment. Portfolio KPI (% Facilities with Amendments) signals restructuring activity.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.774Z",
    "updated_at": "2026-02-21T18:04:26.774Z"
  },
  {
    "variant_id": "hasCrossEntityExposure",
    "variant_name": "% Facilities with Cross-Entity Exposure",
    "parent_metric_id": "hasCrossEntityExposure",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count with cross-entity / Total × 100",
    "executable_metric_id": "hasCrossEntityExposure",
    "detailed_description": "Indicator of exposure allocated across multiple legal entities. Portfolio KPI (% Cross-Entity Exposure) highlights structural complexity.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.774Z",
    "updated_at": "2026-02-21T18:04:26.774Z"
  },
  {
    "variant_id": "id",
    "variant_name": "—",
    "parent_metric_id": "id",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Identifier",
    "executable_metric_id": "id",
    "detailed_description": "Unique identifier for the record or facility within system architecture.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.775Z",
    "updated_at": "2026-02-21T18:04:26.775Z"
  },
  {
    "variant_id": "Internal Risk Rating",
    "variant_name": "% Counterparties in High-Risk Categories",
    "parent_metric_id": "Internal Risk Rating",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count high risk / Total counterparties × 100",
    "executable_metric_id": "Internal Risk Rating",
    "detailed_description": "Bank-assigned internal credit rating reflecting modeled risk assessment and expert judgment. Used for credit segmentation and capital allocation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.775Z",
    "updated_at": "2026-02-21T18:04:26.775Z"
  },
  {
    "variant_id": "internal_rating_change",
    "variant_name": "% Counterparties with Internal Rating Downgrade",
    "parent_metric_id": "internal_rating_change",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Count downgraded / Total) × 100",
    "executable_metric_id": "internal_rating_change",
    "detailed_description": "Month-over-month movement in internal credit rating expressed in notches. Derived metric that quantifies credit quality migration and provides early warning insight into deterioration or improvement trends, supporting proactive risk management and watchlist monitoring.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.776Z",
    "updated_at": "2026-02-21T18:04:26.776Z"
  },
  {
    "variant_id": "isActive",
    "variant_name": "% Active Facilities",
    "parent_metric_id": "isActive",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count(active) / Total facilities × 100",
    "executable_metric_id": "isActive",
    "detailed_description": "Indicator that facility or exposure is active and not closed or matured. Portfolio KPI (% Active Facilities) measures ongoing credit exposure footprint.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.776Z",
    "updated_at": "2026-02-21T18:04:26.776Z"
  },
  {
    "variant_id": "isSyndicated",
    "variant_name": "% Syndicated Facilities",
    "parent_metric_id": "isSyndicated",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Count syndicated facilities / Total facilities) × 100",
    "executable_metric_id": "isSyndicated",
    "detailed_description": "Boolean indicator that facility is syndicated. Portfolio KPI (% Syndicated Facilities) provides insight into risk distribution across lenders.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.777Z",
    "updated_at": "2026-02-21T18:04:26.777Z"
  },
  {
    "variant_id": "L1 Department",
    "variant_name": "Exposure by L1 Department",
    "parent_metric_id": "L1 Department",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum Exposure by Department",
    "executable_metric_id": "L1 Department",
    "detailed_description": "Highest-level organizational unit responsible for the exposure. Enables enterprise-wide aggregation and top-down risk reporting.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.778Z",
    "updated_at": "2026-02-21T18:04:26.778Z"
  },
  {
    "variant_id": "L2 Portfolio",
    "variant_name": "Exposure by L2 Portfolio",
    "parent_metric_id": "L2 Portfolio",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum Exposure by Portfolio",
    "executable_metric_id": "L2 Portfolio",
    "detailed_description": "Mid-level portfolio classification used for risk segmentation, performance reporting, and concentration monitoring.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.778Z",
    "updated_at": "2026-02-21T18:04:26.778Z"
  },
  {
    "variant_id": "L3 Desk",
    "variant_name": "Exposure by L3 Desk",
    "parent_metric_id": "L3 Desk",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum Exposure by Desk",
    "executable_metric_id": "L3 Desk",
    "detailed_description": "Lowest-level trading or management desk responsible for the exposure. Supports operational ownership and accountability tracking.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.779Z",
    "updated_at": "2026-02-21T18:04:26.779Z"
  },
  {
    "variant_id": "legalEntity",
    "variant_name": "Exposure by Legal Entity",
    "parent_metric_id": "legalEntity",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum exposure by legal entity",
    "executable_metric_id": "legalEntity",
    "detailed_description": "Legal entity booking or owning the exposure. Critical for regulatory capital and entity-level reporting.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.779Z",
    "updated_at": "2026-02-21T18:04:26.779Z"
  },
  {
    "variant_id": "legalEntityId",
    "variant_name": "—",
    "parent_metric_id": "legalEntityId",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Identifier",
    "executable_metric_id": "legalEntityId",
    "detailed_description": "Unique identifier assigned to legal entity in enterprise systems.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.780Z",
    "updated_at": "2026-02-21T18:04:26.780Z"
  },
  {
    "variant_id": "LGD ($M)",
    "variant_name": "Total LGD ($M)",
    "parent_metric_id": "LGD ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Exposure × LGD)",
    "executable_metric_id": "LGD ($M)",
    "detailed_description": "Exposure × LGD expressed in dollar terms. Derived loss severity metric estimating expected recovery-adjusted loss magnitude.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.780Z",
    "updated_at": "2026-02-21T18:04:26.780Z"
  },
  {
    "variant_id": "Limit Status",
    "variant_name": "% Limits Breached (%)",
    "parent_metric_id": "Limit Status",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count breached / Total limits × 100",
    "executable_metric_id": "Limit Status",
    "detailed_description": "Status of credit limit (Active, Breached, Suspended). Used to monitor risk appetite breaches and exposure governance compliance.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.781Z",
    "updated_at": "2026-02-21T18:04:26.781Z"
  },
  {
    "variant_id": "lob",
    "variant_name": "Exposure by LOB",
    "parent_metric_id": "lob",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum exposure by business line",
    "executable_metric_id": "lob",
    "detailed_description": "Line of Business classification associated with exposure.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.782Z",
    "updated_at": "2026-02-21T18:04:26.782Z"
  },
  {
    "variant_id": "lobL1",
    "variant_name": "Exposure by LOB Level 1",
    "parent_metric_id": "lobL1",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum exposure by lobL1",
    "executable_metric_id": "lobL1",
    "detailed_description": "Level 1 Line of Business hierarchy. Enables top-level organizational risk aggregation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.782Z",
    "updated_at": "2026-02-21T18:04:26.782Z"
  },
  {
    "variant_id": "lobL2",
    "variant_name": "Exposure by LOB Level 2",
    "parent_metric_id": "lobL2",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum exposure by lobL2",
    "executable_metric_id": "lobL2",
    "detailed_description": "Level 2 Line of Business hierarchy for intermediate aggregation and reporting.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.783Z",
    "updated_at": "2026-02-21T18:04:26.783Z"
  },
  {
    "variant_id": "lobL3",
    "variant_name": "Exposure by LOB Level 3",
    "parent_metric_id": "lobL3",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum exposure by lobL3",
    "executable_metric_id": "lobL3",
    "detailed_description": "Level 3 Line of Business hierarchy for detailed business segmentation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.783Z",
    "updated_at": "2026-02-21T18:04:26.783Z"
  },
  {
    "variant_id": "loss_given_default_pct",
    "variant_name": "Weighted Average LGD (%)",
    "parent_metric_id": "loss_given_default_pct",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(LGD × Exposure) / Total Exposure",
    "executable_metric_id": "loss_given_default_pct",
    "detailed_description": "Estimated percentage of exposure expected to be lost in event of default. Key risk severity parameter informing capital allocation and recovery expectations.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.784Z",
    "updated_at": "2026-02-21T18:04:26.784Z"
  },
  {
    "variant_id": "LTV (%)",
    "variant_name": "Average LTV (%)",
    "parent_metric_id": "LTV (%)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Exposure / Collateral Value) × 100",
    "executable_metric_id": "LTV (%)",
    "detailed_description": "Exposure divided by Collateral Value. Calculated leverage KPI measuring collateral coverage strength and downside protection.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.785Z",
    "updated_at": "2026-02-21T18:04:26.785Z"
  },
  {
    "variant_id": "maturityDate",
    "variant_name": "Average Days to Maturity",
    "parent_metric_id": "maturityDate",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Average (Maturity Date - Reporting Date) across portfolio",
    "executable_metric_id": "maturityDate",
    "detailed_description": "Contractual date on which the facility or loan is scheduled to mature. Used to assess duration exposure, refinancing risk, and liquidity planning.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.785Z",
    "updated_at": "2026-02-21T18:04:26.785Z"
  },
  {
    "variant_id": "Net Income ($M)",
    "variant_name": "Net Income Margin (%)",
    "parent_metric_id": "Net Income ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Net Income / Revenue) × 100",
    "executable_metric_id": "Net Income ($M)",
    "detailed_description": "Profit after all expenses in millions USD. Indicator of borrower profitability and financial sustainability.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.786Z",
    "updated_at": "2026-02-21T18:04:26.786Z"
  },
  {
    "variant_id": "NIM (%)",
    "variant_name": "Portfolio Average NIM (%)",
    "parent_metric_id": "NIM (%)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Interest Income – Interest Expense) / Earning Assets × 100",
    "executable_metric_id": "NIM (%)",
    "detailed_description": "Net Interest Income divided by earning assets. Calculated margin KPI assessing pricing effectiveness and lending profitability.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.787Z",
    "updated_at": "2026-02-21T18:04:26.787Z"
  },
  {
    "variant_id": "Operating Cost ($M)",
    "variant_name": "Total Operating Cost ($$M)",
    "parent_metric_id": "Operating Cost ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum of operating costs",
    "executable_metric_id": "Operating Cost ($M)",
    "detailed_description": "Allocated operating or servicing cost associated with exposure.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.787Z",
    "updated_at": "2026-02-21T18:04:26.787Z"
  },
  {
    "variant_id": "Origination Date",
    "variant_name": "Average Age of Portfolio",
    "parent_metric_id": "Origination Date",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Average (Reporting Date - Origination Date)",
    "executable_metric_id": "Origination Date",
    "detailed_description": "Date on which loan or facility was originally booked.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.788Z",
    "updated_at": "2026-02-21T18:04:26.788Z"
  },
  {
    "variant_id": "outstandingExposure",
    "variant_name": "Total Outstanding Exposure ($M)",
    "parent_metric_id": "outstandingExposure",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum outstanding exposure",
    "executable_metric_id": "outstandingExposure",
    "detailed_description": "Current outstanding exposure balance in millions USD at reporting date.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.790Z",
    "updated_at": "2026-02-21T18:04:26.790Z"
  },
  {
    "variant_id": "participatingCounterpartyIds",
    "variant_name": "—",
    "parent_metric_id": "participatingCounterpartyIds",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Identifier(s)",
    "executable_metric_id": "participatingCounterpartyIds",
    "detailed_description": "Identifiers of counterparties participating in syndicated credit structures. Enables exposure attribution and concentration analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.791Z",
    "updated_at": "2026-02-21T18:04:26.791Z"
  },
  {
    "variant_id": "portfolio",
    "variant_name": "Exposure by Portfolio",
    "parent_metric_id": "portfolio",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum exposure by portfolio",
    "executable_metric_id": "portfolio",
    "detailed_description": "Portfolio grouping assignment used for risk aggregation and reporting.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.792Z",
    "updated_at": "2026-02-21T18:04:26.792Z"
  },
  {
    "variant_id": "Pricing Exception Status",
    "variant_name": "% Loans with Pricing Exceptions (%)",
    "parent_metric_id": "Pricing Exception Status",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count exceptions / Total loans × 100",
    "executable_metric_id": "Pricing Exception Status",
    "detailed_description": "Indicator identifying exposures priced outside standard policy guidelines. Supports governance discipline and pricing compliance monitoring.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.793Z",
    "updated_at": "2026-02-21T18:04:26.793Z"
  },
  {
    "variant_id": "Pricing_Tier",
    "variant_name": "Average Spread by Pricing Tier (%)",
    "parent_metric_id": "Pricing_Tier",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Average spread for given pricing tier",
    "executable_metric_id": "Pricing_Tier",
    "detailed_description": "Pricing classification tier assigned to facility. Supports structured pricing strategy and yield segmentation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.794Z",
    "updated_at": "2026-02-21T18:04:26.794Z"
  },
  {
    "variant_id": "prior_month_external_rating",
    "variant_name": "External Rating Migration Rate",
    "parent_metric_id": "prior_month_external_rating",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "% Counterparties with rating change month-over-month",
    "executable_metric_id": "prior_month_external_rating",
    "detailed_description": "External rating from prior reporting period used to assess rating migration trends and compare directional credit movement over time.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.795Z",
    "updated_at": "2026-02-21T18:04:26.795Z"
  },
  {
    "variant_id": "probability_of_default_pct",
    "variant_name": "Weighted Average PD (%)",
    "parent_metric_id": "probability_of_default_pct",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(PD × Exposure) / Total Exposure",
    "executable_metric_id": "probability_of_default_pct",
    "detailed_description": "Model-estimated probability of default within defined horizon. Core credit risk input supporting capital modeling, expected loss estimation, stress testing, and risk appetite alignment.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.795Z",
    "updated_at": "2026-02-21T18:04:26.795Z"
  },
  {
    "variant_id": "product",
    "variant_name": "Exposure by Product Type",
    "parent_metric_id": "product",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum exposure by product",
    "executable_metric_id": "product",
    "detailed_description": "Product classification assigned to facility. Supports product-level segmentation and performance analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.796Z",
    "updated_at": "2026-02-21T18:04:26.796Z"
  },
  {
    "variant_id": "Region",
    "variant_name": "Exposure by Region (%)",
    "parent_metric_id": "Region",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Exposure by region / Total exposure × 100",
    "executable_metric_id": "Region",
    "detailed_description": "Geographic region classification supporting portfolio segmentation and concentration monitoring.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.797Z",
    "updated_at": "2026-02-21T18:04:26.797Z"
  },
  {
    "variant_id": "reporting_date",
    "variant_name": "—",
    "parent_metric_id": "reporting_date",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Timestamp",
    "executable_metric_id": "reporting_date",
    "detailed_description": "Snapshot date of the dataset used for reporting and aggregation. Serves as the temporal reference point for all balances, risk metrics, and performance indicators.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.798Z",
    "updated_at": "2026-02-21T18:04:26.798Z"
  },
  {
    "variant_id": "Revenue ($M)",
    "variant_name": "Total Revenue ($$M)",
    "parent_metric_id": "Revenue ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ Revenue",
    "executable_metric_id": "Revenue ($M)",
    "detailed_description": "Total income generated by the borrower or attributed to the facility in millions USD. Used to assess scale and repayment capacity.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.799Z",
    "updated_at": "2026-02-21T18:04:26.799Z"
  },
  {
    "variant_id": "Risk Rating Status - External (e.g. Downgrade, Upgrade, Stable)",
    "variant_name": "External Rating Migration Counts",
    "parent_metric_id": "Risk Rating Status - External (e.g. Downgrade, Upgrade, Stable)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count external rating changes",
    "executable_metric_id": "Risk Rating Status - External (e.g. Downgrade, Upgrade, Stable)",
    "detailed_description": "Derived directional indicator reflecting movement in external credit agency rating between reporting periods. Supports benchmarking against market perception and helps validate internal risk assessment trends.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.800Z",
    "updated_at": "2026-02-21T18:04:26.800Z"
  },
  {
    "variant_id": "Risk Rating Status - External Change - Steps (e.g. AAA to A = -2 steps)",
    "variant_name": "Average Rating Change Steps",
    "parent_metric_id": "Risk Rating Status - External Change - Steps (e.g. AAA to A = -2 steps)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Mean rating change steps (positive or negative)",
    "executable_metric_id": "Risk Rating Status - External Change - Steps (e.g. AAA to A = -2 steps)",
    "detailed_description": "Numerical representation of external rating migration expressed in notch movement (positive or negative). Quantifies magnitude of credit change and enables portfolio-level migration analysis, stress testing sensitivity, and risk trend measurement.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.800Z",
    "updated_at": "2026-02-21T18:04:26.800Z"
  },
  {
    "variant_id": "Risk Rating Status - Internal (e.g. Downgrade, Upgrade, Stable)",
    "variant_name": "Internal Rating Migration Counts",
    "parent_metric_id": "Risk Rating Status - Internal (e.g. Downgrade, Upgrade, Stable)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count transitions by type",
    "executable_metric_id": "Risk Rating Status - Internal (e.g. Downgrade, Upgrade, Stable)",
    "detailed_description": "Derived directional classification indicating whether the internal credit rating has upgraded, downgraded, or remained stable compared to the prior reporting period. Provides migration trend insight and serves as an early warning indicator of credit quality movement to support proactive risk management and escalation decisions.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.801Z",
    "updated_at": "2026-02-21T18:04:26.801Z"
  },
  {
    "variant_id": "riskMitigantAmount",
    "variant_name": "Total Risk Mitigant Amount ($M)",
    "parent_metric_id": "riskMitigantAmount",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum of mitigant values",
    "executable_metric_id": "riskMitigantAmount",
    "detailed_description": "Monetary value of applied risk mitigant. Portfolio KPI (Exposure Covered by Risk Mitigants %) measures capital relief and loss protection strength.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.802Z",
    "updated_at": "2026-02-21T18:04:26.802Z"
  },
  {
    "variant_id": "riskMitigantSubType",
    "variant_name": "Exposure by Risk Mitigant SubType",
    "parent_metric_id": "riskMitigantSubType",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sum exposure covered by subtypes",
    "executable_metric_id": "riskMitigantSubType",
    "detailed_description": "Sub-classification of risk mitigant type for granular risk segmentation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.803Z",
    "updated_at": "2026-02-21T18:04:26.803Z"
  },
  {
    "variant_id": "riskMitigantType",
    "variant_name": "Exposure Covered by Risk Mitigants (%)",
    "parent_metric_id": "riskMitigantType",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Sum risk mitigant amount / Exposure) × 100",
    "executable_metric_id": "riskMitigantType",
    "detailed_description": "Type of risk mitigation (e.g., collateral, guarantee). Used to assess recovery support mechanisms.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.804Z",
    "updated_at": "2026-02-21T18:04:26.804Z"
  },
  {
    "variant_id": "ROA (%)",
    "variant_name": "Average ROA (%)",
    "parent_metric_id": "ROA (%)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Net Income / Assets) × 100",
    "executable_metric_id": "ROA (%)",
    "detailed_description": "Net Income divided by Total Assets. Calculated efficiency KPI measuring asset productivity and overall financial performance.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.805Z",
    "updated_at": "2026-02-21T18:04:26.805Z"
  },
  {
    "variant_id": "ROE (%)",
    "variant_name": "Average ROE (%)",
    "parent_metric_id": "ROE (%)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Net Income / Equity) × 100",
    "executable_metric_id": "ROE (%)",
    "detailed_description": "Net Income divided by Equity. Calculated profitability KPI measuring return generated on shareholder capital and supporting performance benchmarking.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.806Z",
    "updated_at": "2026-02-21T18:04:26.806Z"
  },
  {
    "variant_id": "Sector",
    "variant_name": "Exposure by Sector (%)",
    "parent_metric_id": "Sector",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Exposure by sector / Total exposure × 100",
    "executable_metric_id": "Sector",
    "detailed_description": "Industry sector classification enabling sector concentration risk assessment.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.806Z",
    "updated_at": "2026-02-21T18:04:26.806Z"
  },
  {
    "variant_id": "spread_pct",
    "variant_name": "Weighted Average Spread (%)",
    "parent_metric_id": "spread_pct",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Spread × Exposure) / Total Exposure",
    "executable_metric_id": "spread_pct",
    "detailed_description": "Credit spread over reference base rate charged on exposure, expressed as percentage. Represents risk premium embedded in pricing and supports yield analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.807Z",
    "updated_at": "2026-02-21T18:04:26.807Z"
  },
  {
    "variant_id": "Tenor (Years)",
    "variant_name": "Average Tenor (Years)",
    "parent_metric_id": "Tenor (Years)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(Tenor × Exposure) / Total Exposure",
    "executable_metric_id": "Tenor (Years)",
    "detailed_description": "Time remaining to contractual maturity expressed in years. Supports duration and rollover risk analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.808Z",
    "updated_at": "2026-02-21T18:04:26.808Z"
  },
  {
    "variant_id": "Total Debt Service ($M)",
    "variant_name": "Total Debt Service ($$M)",
    "parent_metric_id": "Total Debt Service ($M)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ Debt Service",
    "executable_metric_id": "Total Debt Service ($M)",
    "detailed_description": "Total principal and interest obligations due within reporting period in millions USD. Used in repayment capacity and covenant analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.809Z",
    "updated_at": "2026-02-21T18:04:26.809Z"
  },
  {
    "variant_id": "Utilization (%)",
    "variant_name": "Average Utilization (%)",
    "parent_metric_id": "Utilization (%)",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Average(Utilization %)",
    "executable_metric_id": "Utilization (%)",
    "detailed_description": "Exposure divided by Exposure Limit. Calculated KPI measuring the proportion of approved capacity currently drawn, providing insight into liquidity usage and limit pressure.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.810Z",
    "updated_at": "2026-02-21T18:04:26.810Z"
  },
  {
    "variant_id": "utilizedAmount",
    "variant_name": "Utilization (%)",
    "parent_metric_id": "utilizedAmount",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Utilized Amount / Committed Amount) × 100",
    "executable_metric_id": "utilizedAmount",
    "detailed_description": "Current drawn amount divided by committed amount. Supports utilization and liquidity risk monitoring.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.811Z",
    "updated_at": "2026-02-21T18:04:26.811Z"
  },
  {
    "variant_id": "WAvg_LGD",
    "variant_name": "Weighted Average LGD (%)",
    "parent_metric_id": "WAvg_LGD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(LGD × Exposure) / Total Exposure",
    "executable_metric_id": "WAvg_LGD",
    "detailed_description": "Weighted average loss given default across exposures. Derived severity KPI measuring expected recovery-adjusted portfolio loss sensitivity.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.812Z",
    "updated_at": "2026-02-21T18:04:26.812Z"
  },
  {
    "variant_id": "WAvg_PD",
    "variant_name": "Weighted Average PD (%)",
    "parent_metric_id": "WAvg_PD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Σ(PD × Exposure) / Total Exposure",
    "executable_metric_id": "WAvg_PD",
    "detailed_description": "Weighted average probability of default across exposures. Derived portfolio-level risk intensity KPI supporting concentration and stress scenario analysis.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.812Z",
    "updated_at": "2026-02-21T18:04:26.812Z"
  },
  {
    "variant_id": "C001",
    "variant_name": "impactedFacilityIds",
    "parent_metric_id": "C001",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "LISTAGG(DISTINCT facility_id)",
    "formula_specification": "SELECT LISTAGG(DISTINCT cefl.facility_id, ',') WITHIN GROUP (ORDER BY cefl.facility_id)\nFROM L2.credit_event_facility_link cefl\nJOIN L2.credit_event ce ON ce.credit_event_id = cefl.credit_event_id\nWHERE ce.event_status = 'open' AND ce.as_of_date = :as_of_date",
    "executable_metric_id": "C001",
    "detailed_description": "Comma-separated list of facility IDs impacted by in-scope credit events for a given counterparty and time period.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.814Z",
    "updated_at": "2026-02-21T18:04:26.814Z"
  },
  {
    "variant_id": "C002",
    "variant_name": "impactedFacilityCount",
    "parent_metric_id": "C002",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "COUNT(DISTINCT facility_id)",
    "formula_specification": "SELECT COUNT(DISTINCT cefl.facility_id)\nFROM L2.credit_event_facility_link cefl\nJOIN L2.credit_event ce ON ce.credit_event_id = cefl.credit_event_id\nWHERE ce.event_status = 'open' AND ce.as_of_date = :as_of_date",
    "executable_metric_id": "C002",
    "detailed_description": "Number of distinct facilities impacted by in-scope credit events. Represents relationship size of impacted exposures.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.814Z",
    "updated_at": "2026-02-21T18:04:26.814Z"
  },
  {
    "variant_id": "C003",
    "variant_name": "estimatedExposureImpact",
    "parent_metric_id": "C003",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(gross_exposure_usd) for impacted facilities",
    "formula_specification": "SELECT SUM(fes.gross_exposure_usd)\nFROM L2.credit_event_facility_link cefl\nJOIN L2.credit_event ce ON ce.credit_event_id = cefl.credit_event_id\nJOIN L2.facility_exposure_snapshot fes ON fes.facility_id = cefl.facility_id AND fes.as_of_date = ce.as_of_date\nJOIN L1.facility_master fm ON fm.facility_id = cefl.facility_id AND fm.facility_status = 'Active'\nWHERE ce.event_status = 'open' AND ce.as_of_date = :as_of_date",
    "executable_metric_id": "C003",
    "detailed_description": "Total gross exposure (USD) across facilities linked to in-scope credit events. Uses facility_exposure_snapshot for current exposure.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.816Z",
    "updated_at": "2026-02-21T18:04:26.816Z"
  },
  {
    "variant_id": "C004",
    "variant_name": "tier",
    "parent_metric_id": "C004",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "CASE WHEN utilization_pct < inner_threshold_pct THEN 'No Breach' WHEN utilization_pct < outer_threshold_pct THEN 'Warning' ELSE 'Breach' END",
    "formula_specification": "SELECT CASE\n  WHEN (lue.utilized_amount_usd / NULLIF(lr.limit_amount_usd,0))*100 < lt_warn.threshold_upper_pct THEN 'No Breach'\n  WHEN (lue.utilized_amount_usd / NULLIF(lr.limit_amount_usd,0))*100 < lt_breach.threshold_lower_pct THEN 'Warning'\n  ELSE 'Breach' END AS tier\nFROM L2.limit_utilization_event lue\nJOIN L1.limit_rule lr ON lr.limit_rule_id = lue.limit_rule_id\nJOIN L1.limit_threshold lt_warn ON lt_warn.limit_rule_id = lr.limit_rule_id AND lt_warn.threshold_type = 'WARNING' AND lt_warn.active_flag = 'Y'\nJOIN L1.limit_threshold lt_breach ON lt_breach.limit_rule_id = lr.limit_rule_id AND lt_breach.threshold_type = 'BREACH' AND lt_breach.active_flag = 'Y'\nWHERE lr.effective_to_date IS NULL AND lue.as_of_date = :as_of_date",
    "executable_metric_id": "C004",
    "detailed_description": "Limit breach tier: No Breach / Warning / Breach based on utilization vs threshold bands from limit_threshold.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.817Z",
    "updated_at": "2026-02-21T18:04:26.817Z"
  },
  {
    "variant_id": "C005",
    "variant_name": "limitAmount",
    "parent_metric_id": "C005",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(limit_amount_usd)",
    "formula_specification": "SELECT SUM(lr.limit_amount_usd)\nFROM L1.limit_rule lr\nWHERE lr.limit_amount_usd > 0 AND lr.effective_to_date IS NULL",
    "executable_metric_id": "C005",
    "detailed_description": "Total approved limit amount (USD) across active, non-waived limits.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.818Z",
    "updated_at": "2026-02-21T18:04:26.818Z"
  },
  {
    "variant_id": "C006",
    "variant_name": "utilizedExposure",
    "parent_metric_id": "C006",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(utilized_amount_usd)",
    "formula_specification": "SELECT SUM(lue.utilized_amount_usd)\nFROM L2.limit_utilization_event lue\nJOIN L1.limit_rule lr ON lr.limit_rule_id = lue.limit_rule_id\nWHERE lr.limit_amount_usd > 0 AND lr.effective_to_date IS NULL AND lue.as_of_date = :as_of_date",
    "executable_metric_id": "C006",
    "detailed_description": "Total utilized exposure (USD) against active limits.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.820Z",
    "updated_at": "2026-02-21T18:04:26.820Z"
  },
  {
    "variant_id": "C007",
    "variant_name": "headroom",
    "parent_metric_id": "C007",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(limit_amount_usd) - SUM(utilized_amount_usd)",
    "formula_specification": "SELECT SUM(lr.limit_amount_usd) - SUM(lue.utilized_amount_usd)\nFROM L2.limit_utilization_event lue\nJOIN L1.limit_rule lr ON lr.limit_rule_id = lue.limit_rule_id\nWHERE lr.limit_amount_usd > 0 AND lr.effective_to_date IS NULL AND lue.as_of_date = :as_of_date",
    "executable_metric_id": "C007",
    "detailed_description": "Available headroom: limit minus utilized. Positive = capacity remaining.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.821Z",
    "updated_at": "2026-02-21T18:04:26.821Z"
  },
  {
    "variant_id": "C008",
    "variant_name": "utilizationPct",
    "parent_metric_id": "C008",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(SUM(utilized_amount_usd) / SUM(limit_amount_usd)) * 100",
    "formula_specification": "SELECT (SUM(lue.utilized_amount_usd) / NULLIF(SUM(lr.limit_amount_usd), 0)) * 100\nFROM L2.limit_utilization_event lue\nJOIN L1.limit_rule lr ON lr.limit_rule_id = lue.limit_rule_id\nWHERE lr.limit_amount_usd > 0 AND lr.effective_to_date IS NULL AND lue.as_of_date = :as_of_date",
    "executable_metric_id": "C008",
    "detailed_description": "Limit utilization percentage.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.822Z",
    "updated_at": "2026-02-21T18:04:26.822Z"
  },
  {
    "variant_id": "C009",
    "variant_name": "priorMonthLimitStatus",
    "parent_metric_id": "C009",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "tier logic applied to prior month-end snapshot",
    "formula_specification": "SELECT CASE\n  WHEN (lue_prior.utilized_amount_usd / NULLIF(lr.limit_amount_usd,0))*100 < lt_warn.threshold_upper_pct THEN 'No Breach'\n  WHEN (lue_prior.utilized_amount_usd / NULLIF(lr.limit_amount_usd,0))*100 < lt_breach.threshold_lower_pct THEN 'Warning'\n  ELSE 'Breach' END\nFROM L2.limit_utilization_event lue_prior\nJOIN L1.limit_rule lr ON lr.limit_rule_id = lue_prior.limit_rule_id\nJOIN L1.limit_threshold lt_warn ON lt_warn.limit_rule_id = lr.limit_rule_id AND lt_warn.threshold_type = 'WARNING' AND lt_warn.active_flag = 'Y'\nJOIN L1.limit_threshold lt_breach ON lt_breach.limit_rule_id = lr.limit_rule_id AND lt_breach.threshold_type = 'BREACH' AND lt_breach.active_flag = 'Y'\nWHERE lue_prior.as_of_date = (SELECT MAX(dd.calendar_date) FROM L1.date_dim dd WHERE dd.calendar_date < :as_of_date AND dd.is_month_end = 'Y')",
    "executable_metric_id": "C009",
    "detailed_description": "Limit breach status as of prior month-end. For month-over-month comparison.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.823Z",
    "updated_at": "2026-02-21T18:04:26.823Z"
  },
  {
    "variant_id": "C010",
    "variant_name": "lastStatusChangeDate",
    "parent_metric_id": "C010",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "MAX(reporting_ts)",
    "formula_specification": "SELECT MAX(lue.reporting_ts) FROM L2.limit_utilization_event lue\nJOIN L1.limit_rule lr ON lr.limit_rule_id = lue.limit_rule_id\nWHERE lr.effective_to_date IS NULL AND lue.as_of_date = :as_of_date",
    "executable_metric_id": "C010",
    "detailed_description": "Most recent timestamp of limit utilization update.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.824Z",
    "updated_at": "2026-02-21T18:04:26.824Z"
  },
  {
    "variant_id": "C011",
    "variant_name": "stressExposure",
    "parent_metric_id": "C011",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(total_exposure_usd)",
    "formula_specification": "SELECT SUM(str.total_exposure_usd) FROM L2.stress_test_result str WHERE str.as_of_date = :as_of_date",
    "executable_metric_id": "C011",
    "detailed_description": "Total gross exposure (USD) under in-scope stress test scenarios.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.825Z",
    "updated_at": "2026-02-21T18:04:26.825Z"
  },
  {
    "variant_id": "C012",
    "variant_name": "expectedLoss",
    "parent_metric_id": "C012",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(expected_loss_usd)",
    "formula_specification": "SELECT SUM(str.expected_loss_usd) FROM L2.stress_test_result str WHERE str.as_of_date = :as_of_date",
    "executable_metric_id": "C012",
    "detailed_description": "Total expected loss (USD) under stress scenarios.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.826Z",
    "updated_at": "2026-02-21T18:04:26.826Z"
  },
  {
    "variant_id": "C013",
    "variant_name": "capitalImpact",
    "parent_metric_id": "C013",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "capital_impact_pct (pre-calculated)",
    "formula_specification": "SELECT str.capital_impact_pct FROM L2.stress_test_result str WHERE str.as_of_date = :as_of_date",
    "executable_metric_id": "C013",
    "detailed_description": "Capital impact as % of Tier 1 capital. Pre-calculated in stress_test_result by risk engine.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.827Z",
    "updated_at": "2026-02-21T18:04:26.827Z"
  },
  {
    "variant_id": "C014",
    "variant_name": "isParent",
    "parent_metric_id": "C014",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "is_parent_flag from counterparty",
    "formula_specification": "SELECT c.is_parent_flag FROM L1.counterparty c WHERE c.counterparty_id = :counterparty_id",
    "executable_metric_id": "C014",
    "detailed_description": "Flag: is the counterparty a parent entity in the hierarchy.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.828Z",
    "updated_at": "2026-02-21T18:04:26.828Z"
  },
  {
    "variant_id": "C015",
    "variant_name": "probabilityOfDefault",
    "parent_metric_id": "C015",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Counterparty-level: pd_annual; Aggregated: SUM(pd_estimate * EAD) / SUM(EAD)",
    "formula_specification": "-- Counterparty-level (single obligor):\nSELECT c.pd_annual FROM L1.counterparty c WHERE c.counterparty_id = :counterparty_id\n-- Portfolio/aggregated-level (exposure-weighted):\nSELECT SUM(CAST(p.pd_estimate AS DECIMAL) * fes.gross_exposure_usd) / NULLIF(SUM(fes.gross_exposure_usd), 0)\nFROM L2.position p\nJOIN L2.facility_exposure_snapshot fes ON fes.facility_id = p.facility_id AND fes.as_of_date = p.as_of_date\nWHERE p.pd_estimate IS NOT NULL AND fes.gross_exposure_usd > 0 AND p.as_of_date = :as_of_date",
    "executable_metric_id": "C015",
    "detailed_description": "Probability of default. Single counterparty: obligor-level pd_annual. Aggregated views: exposure-weighted PD per Basel IRB standard (Σ PD×EAD / Σ EAD).",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.829Z",
    "updated_at": "2026-02-21T18:04:26.829Z"
  },
  {
    "variant_id": "C016",
    "variant_name": "lossGivenDefault",
    "parent_metric_id": "C016",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Counterparty-level: lgd_unsecured; Aggregated: SUM(lgd_estimate * EAD) / SUM(EAD)",
    "formula_specification": "-- Counterparty-level:\nSELECT c.lgd_unsecured FROM L1.counterparty c WHERE c.counterparty_id = :counterparty_id\n-- Aggregated (exposure-weighted):\nSELECT SUM(CAST(p.lgd_estimate AS DECIMAL) * fes.gross_exposure_usd) / NULLIF(SUM(fes.gross_exposure_usd), 0)\nFROM L2.position p\nJOIN L2.facility_exposure_snapshot fes ON fes.facility_id = p.facility_id AND fes.as_of_date = p.as_of_date\nWHERE p.lgd_estimate IS NOT NULL AND fes.gross_exposure_usd > 0 AND p.as_of_date = :as_of_date",
    "executable_metric_id": "C016",
    "detailed_description": "Loss given default. Single counterparty: unsecured LGD. Aggregated: exposure-weighted per Basel IRB.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.830Z",
    "updated_at": "2026-02-21T18:04:26.830Z"
  },
  {
    "variant_id": "C017",
    "variant_name": "creditLimit",
    "parent_metric_id": "C017",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(limit_amount_usd) WHERE limit_scope = COUNTERPARTY",
    "formula_specification": "SELECT SUM(lr.limit_amount_usd)\nFROM L1.limit_rule lr\nWHERE lr.limit_scope = 'COUNTERPARTY' AND lr.counterparty_id = :counterparty_id\nAND lr.limit_amount_usd > 0 AND lr.effective_to_date IS NULL",
    "executable_metric_id": "C017",
    "detailed_description": "Total approved credit limit for a specific counterparty.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.832Z",
    "updated_at": "2026-02-21T18:04:26.832Z"
  },
  {
    "variant_id": "C018",
    "variant_name": "hasCrossEntityExposure",
    "parent_metric_id": "C018",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "cross_entity_flag (proposed new field) OR CASE WHEN COUNT(DISTINCT legal_entity_id) > 1 THEN 1 ELSE 0 END",
    "formula_specification": "-- Current derivation (until cross_entity_flag is added):\nSELECT CASE WHEN COUNT(DISTINCT fes.legal_entity_id) > 1 THEN 1 ELSE 0 END\nFROM L2.facility_exposure_snapshot fes\nWHERE fes.counterparty_id = :counterparty_id AND fes.gross_exposure_usd > 0 AND fes.as_of_date = :as_of_date",
    "executable_metric_id": "C018",
    "detailed_description": "Flag: does this counterparty have exposure booked across multiple legal entities. MODEL GAP: recommend adding cross_entity_flag to facility_exposure_snapshot.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.833Z",
    "updated_at": "2026-02-21T18:04:26.833Z"
  },
  {
    "variant_id": "C019",
    "variant_name": "crossEntityExposureAmount",
    "parent_metric_id": "C019",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(gross_exposure_usd) WHERE cross_entity_flag = Y",
    "formula_specification": "SELECT SUM(fes.gross_exposure_usd)\nFROM L2.facility_exposure_snapshot fes\nWHERE fes.counterparty_id = :counterparty_id AND fes.gross_exposure_usd > 0 AND fes.as_of_date = :as_of_date\nAND (SELECT COUNT(DISTINCT fes2.legal_entity_id) FROM L2.facility_exposure_snapshot fes2\n     WHERE fes2.counterparty_id = fes.counterparty_id AND fes2.as_of_date = fes.as_of_date) > 1",
    "executable_metric_id": "C019",
    "detailed_description": "Total exposure for counterparties with cross-entity presence. Filtered to cross_entity_flag = Y once added.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.834Z",
    "updated_at": "2026-02-21T18:04:26.834Z"
  },
  {
    "variant_id": "C020",
    "variant_name": "utilizationPct_cpty",
    "parent_metric_id": "C020",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(SUM(utilized_amount_usd) / SUM(limit_amount_usd)) * 100",
    "formula_specification": "SELECT (SUM(lue.utilized_amount_usd) / NULLIF(SUM(lr.limit_amount_usd), 0)) * 100\nFROM L2.limit_utilization_event lue\nJOIN L1.limit_rule lr ON lr.limit_rule_id = lue.limit_rule_id\nWHERE lr.counterparty_id = :counterparty_id AND lr.limit_amount_usd > 0\nAND lr.effective_to_date IS NULL AND lue.as_of_date = :as_of_date",
    "executable_metric_id": "C020",
    "detailed_description": "Limit utilization percentage at counterparty level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.835Z",
    "updated_at": "2026-02-21T18:04:26.835Z"
  },
  {
    "variant_id": "C021",
    "variant_name": "exposure_mom_change_pct",
    "parent_metric_id": "C021",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current - prior_month) / prior_month) * 100",
    "formula_specification": "SELECT ((curr.t - prior.t) / NULLIF(prior.t, 0)) * 100\nFROM (SELECT SUM(gross_exposure_usd) t FROM L2.facility_exposure_snapshot WHERE counterparty_id = :cpty AND as_of_date = :as_of_date) curr,\n(SELECT SUM(gross_exposure_usd) t FROM L2.facility_exposure_snapshot WHERE counterparty_id = :cpty\n AND as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_month_end = 'Y')) prior",
    "executable_metric_id": "C021",
    "detailed_description": "Month-over-month change in gross exposure at counterparty level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.836Z",
    "updated_at": "2026-02-21T18:04:26.836Z"
  },
  {
    "variant_id": "C022",
    "variant_name": "exposure_qoq_change_pct",
    "parent_metric_id": "C022",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current - prior_quarter) / prior_quarter) * 100",
    "formula_specification": "SELECT ((curr.t - prior.t) / NULLIF(prior.t, 0)) * 100\nFROM (SELECT SUM(gross_exposure_usd) t FROM L2.facility_exposure_snapshot WHERE counterparty_id = :cpty AND as_of_date = :as_of_date) curr,\n(SELECT SUM(gross_exposure_usd) t FROM L2.facility_exposure_snapshot WHERE counterparty_id = :cpty\n AND as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_quarter_end = 'Y')) prior",
    "executable_metric_id": "C022",
    "detailed_description": "Quarter-over-quarter change in gross exposure at counterparty level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.838Z",
    "updated_at": "2026-02-21T18:04:26.838Z"
  },
  {
    "variant_id": "C023",
    "variant_name": "exposure_yoy_change_pct",
    "parent_metric_id": "C023",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current - prior_year) / prior_year) * 100",
    "formula_specification": "SELECT ((curr.t - prior.t) / NULLIF(prior.t, 0)) * 100\nFROM (SELECT SUM(gross_exposure_usd) t FROM L2.facility_exposure_snapshot WHERE counterparty_id = :cpty AND as_of_date = :as_of_date) curr,\n(SELECT SUM(gross_exposure_usd) t FROM L2.facility_exposure_snapshot WHERE counterparty_id = :cpty\n AND as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_year_end = 'Y')) prior",
    "executable_metric_id": "C023",
    "detailed_description": "Year-over-year change in gross exposure at counterparty level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.839Z",
    "updated_at": "2026-02-21T18:04:26.839Z"
  },
  {
    "variant_id": "C024",
    "variant_name": "internal_rating_change",
    "parent_metric_id": "C024",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "rating_value - prior_rating_value",
    "formula_specification": "SELECT cro.rating_value - cro.prior_rating_value AS rating_change\nFROM L2.counterparty_rating_observation cro\nWHERE cro.counterparty_id = :counterparty_id AND cro.rating_type = 'INTERNAL' AND cro.as_of_date = :as_of_date",
    "executable_metric_id": "C024",
    "detailed_description": "Numeric change in internal rating. Positive = downgrade (higher notch = worse).",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.840Z",
    "updated_at": "2026-02-21T18:04:26.840Z"
  },
  {
    "variant_id": "C025",
    "variant_name": "avg_spread_pct",
    "parent_metric_id": "C025",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "AVG(spread_bps) / 100",
    "formula_specification": "SELECT AVG(fps.spread_bps) / 100.0\nFROM L2.facility_pricing_snapshot fps\nJOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nWHERE fm.counterparty_id = :counterparty_id AND fps.as_of_date = :as_of_date",
    "executable_metric_id": "C025",
    "detailed_description": "Average credit spread (%) across facilities. Converted from bps.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.841Z",
    "updated_at": "2026-02-21T18:04:26.841Z"
  },
  {
    "variant_id": "C026",
    "variant_name": "avg_base_rate_pct",
    "parent_metric_id": "C026",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "AVG(base_rate_pct)",
    "formula_specification": "SELECT AVG(fps.base_rate_pct)\nFROM L2.facility_pricing_snapshot fps\nJOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nWHERE fm.counterparty_id = :counterparty_id AND fps.as_of_date = :as_of_date",
    "executable_metric_id": "C026",
    "detailed_description": "Average base/reference rate (%) across facilities.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.842Z",
    "updated_at": "2026-02-21T18:04:26.842Z"
  },
  {
    "variant_id": "C027",
    "variant_name": "all_in_rate_pct",
    "parent_metric_id": "C027",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "AVG(base_rate_pct + spread_bps/100) OR all_in_rate_pct from facility_master",
    "formula_specification": "SELECT AVG(fps.base_rate_pct + fps.spread_bps / 100.0)\nFROM L2.facility_pricing_snapshot fps\nJOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nWHERE fm.counterparty_id = :counterparty_id AND fps.as_of_date = :as_of_date",
    "executable_metric_id": "C027",
    "detailed_description": "All-in rate: base + spread. Also pre-calculated as all_in_rate_pct on facility_master.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.843Z",
    "updated_at": "2026-02-21T18:04:26.843Z"
  },
  {
    "variant_id": "C028",
    "variant_name": "probability_of_default_pct",
    "parent_metric_id": "C028",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "metric_value from financial_metric_observation WHERE metric_code = PD",
    "formula_specification": "SELECT fmo.metric_value FROM L2.financial_metric_observation fmo\nWHERE fmo.metric_code = 'PD' AND fmo.counterparty_id = :counterparty_id AND fmo.as_of_date = :as_of_date",
    "executable_metric_id": "C028",
    "detailed_description": "PD from risk metric observation. Alternative to C015 — this reads the pre-calculated value from the metrics store.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.845Z",
    "updated_at": "2026-02-21T18:04:26.845Z"
  },
  {
    "variant_id": "C029",
    "variant_name": "loss_given_default_pct",
    "parent_metric_id": "C029",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "metric_value from financial_metric_observation WHERE metric_code = LGD",
    "formula_specification": "SELECT fmo.metric_value FROM L2.financial_metric_observation fmo\nWHERE fmo.metric_code = 'LGD' AND fmo.counterparty_id = :counterparty_id AND fmo.as_of_date = :as_of_date",
    "executable_metric_id": "C029",
    "detailed_description": "LGD from risk metric observation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.846Z",
    "updated_at": "2026-02-21T18:04:26.846Z"
  },
  {
    "variant_id": "C030",
    "variant_name": "expected_loss_m",
    "parent_metric_id": "C030",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "PD × LGD × Utilized Exposure",
    "formula_specification": "SELECT fmo.metric_value_usd FROM L2.financial_metric_observation fmo\nWHERE fmo.metric_code = 'EL' AND fmo.counterparty_id = :counterparty_id AND fmo.as_of_date = :as_of_date",
    "executable_metric_id": "C030",
    "detailed_description": "Expected loss: PD × LGD × EAD. Pre-calculated in financial_metric_observation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.847Z",
    "updated_at": "2026-02-21T18:04:26.847Z"
  },
  {
    "variant_id": "C031",
    "variant_name": "delinquent_amount_m",
    "parent_metric_id": "C031",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(overdue_principal_amt + overdue_interest_amt)",
    "formula_specification": "SELECT SUM(fds.overdue_principal_amt + fds.overdue_interest_amt)\nFROM L2.facility_delinquency_snapshot fds\nWHERE fds.counterparty_id = :counterparty_id AND fds.as_of_date = :as_of_date",
    "executable_metric_id": "C031",
    "detailed_description": "Total delinquent amount (principal + interest overdue) at counterparty level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.849Z",
    "updated_at": "2026-02-21T18:04:26.849Z"
  },
  {
    "variant_id": "C032",
    "variant_name": "days_overdue",
    "parent_metric_id": "C032",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "MAX(days_past_due)",
    "formula_specification": "SELECT MAX(fds.days_past_due_max)\nFROM L2.facility_delinquency_snapshot fds\nWHERE fds.counterparty_id = :counterparty_id AND fds.as_of_date = :as_of_date",
    "executable_metric_id": "C032",
    "detailed_description": "Maximum days past due across all facilities for a counterparty.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.850Z",
    "updated_at": "2026-02-21T18:04:26.850Z"
  },
  {
    "variant_id": "C033",
    "variant_name": "ROE_pct",
    "parent_metric_id": "C033",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((interest_income + fee_income - interest_expense) / allocated_equity) * 100",
    "formula_specification": "SELECT ((SUM(fps.interest_income_amt + fps.fee_income_amt - fps.interest_expense_amt)) / NULLIF(SUM(fps.allocated_equity_amt), 0)) * 100\nFROM L2.facility_profitability_snapshot fps\nJOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nWHERE fm.counterparty_id = :counterparty_id AND fps.as_of_date = :as_of_date",
    "executable_metric_id": "C033",
    "detailed_description": "Return on equity proxy. APPROXIMATION: uses profitability snapshot income/equity. MODEL GAP: true ROE needs provision_for_credit_losses, non_interest_expense, tax on facility_profitability_snapshot.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.851Z",
    "updated_at": "2026-02-21T18:04:26.851Z"
  },
  {
    "variant_id": "C034",
    "variant_name": "ROA_pct",
    "parent_metric_id": "C034",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((interest_income + fee_income - interest_expense) / avg_earning_assets) * 100",
    "formula_specification": "SELECT ((SUM(fps.interest_income_amt + fps.fee_income_amt - fps.interest_expense_amt)) / NULLIF(SUM(fps.avg_earning_assets_amt), 0)) * 100\nFROM L2.facility_profitability_snapshot fps\nJOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nWHERE fm.counterparty_id = :counterparty_id AND fps.as_of_date = :as_of_date",
    "executable_metric_id": "C034",
    "detailed_description": "Return on assets proxy. Same MODEL GAP as ROE.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.852Z",
    "updated_at": "2026-02-21T18:04:26.852Z"
  },
  {
    "variant_id": "C035",
    "variant_name": "NIM_pct",
    "parent_metric_id": "C035",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((interest_income - interest_expense) / avg_earning_assets) * 100",
    "formula_specification": "SELECT ((SUM(fps.interest_income_amt) - SUM(fps.interest_expense_amt)) / NULLIF(SUM(fps.avg_earning_assets_amt), 0)) * 100\nFROM L2.facility_profitability_snapshot fps\nJOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nWHERE fm.counterparty_id = :counterparty_id AND fps.as_of_date = :as_of_date",
    "executable_metric_id": "C035",
    "detailed_description": "Net interest margin. This metric uses existing fields and does not require MODEL GAP additions.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.854Z",
    "updated_at": "2026-02-21T18:04:26.854Z"
  },
  {
    "variant_id": "C036",
    "variant_name": "avg_tenor_years",
    "parent_metric_id": "C036",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "AVG(DATEDIFF(maturity_date, origination_date) / 365.25)",
    "formula_specification": "SELECT AVG(DATEDIFF(fm.maturity_date, fm.origination_date) / 365.25)\nFROM L1.facility_master fm WHERE fm.counterparty_id = :counterparty_id AND fm.facility_status = 'Active'",
    "executable_metric_id": "C036",
    "detailed_description": "Average tenor (years) across active facilities.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.855Z",
    "updated_at": "2026-02-21T18:04:26.855Z"
  },
  {
    "variant_id": "C037",
    "variant_name": "LTV_pct",
    "parent_metric_id": "C037",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(SUM(gross_exposure_usd) / SUM(current_valuation_usd)) * 100",
    "formula_specification": "SELECT (SUM(fes.gross_exposure_usd) / NULLIF(SUM(cs.current_valuation_usd), 0)) * 100\nFROM L2.facility_exposure_snapshot fes\nLEFT JOIN L2.collateral_snapshot cs ON cs.facility_id = fes.facility_id AND cs.as_of_date = fes.as_of_date\nWHERE fes.counterparty_id = :counterparty_id AND fes.as_of_date = :as_of_date",
    "executable_metric_id": "C037",
    "detailed_description": "Loan-to-value: exposure / collateral valuation.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.858Z",
    "updated_at": "2026-02-21T18:04:26.858Z"
  },
  {
    "variant_id": "C038",
    "variant_name": "risk_rating_status_internal",
    "parent_metric_id": "C038",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "CASE WHEN rating_value > prior_rating_value THEN 'Downgrade' WHEN < THEN 'Upgrade' ELSE 'Stable' END",
    "formula_specification": "SELECT CASE WHEN cro.rating_value > cro.prior_rating_value THEN 'Downgrade'\nWHEN cro.rating_value < cro.prior_rating_value THEN 'Upgrade' ELSE 'Stable' END\nFROM L2.counterparty_rating_observation cro\nWHERE cro.counterparty_id = :counterparty_id AND cro.rating_type = 'INTERNAL' AND cro.as_of_date = :as_of_date",
    "executable_metric_id": "C038",
    "detailed_description": "Internal rating direction: Downgrade / Upgrade / Stable.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.859Z",
    "updated_at": "2026-02-21T18:04:26.859Z"
  },
  {
    "variant_id": "C039",
    "variant_name": "risk_rating_status_external",
    "parent_metric_id": "C039",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "CASE WHEN rating_value > prior THEN 'Downgrade' WHEN < THEN 'Upgrade' ELSE 'Stable' END",
    "formula_specification": "SELECT CASE WHEN cro.rating_value > cro.prior_rating_value THEN 'Downgrade'\nWHEN cro.rating_value < cro.prior_rating_value THEN 'Upgrade' ELSE 'Stable' END\nFROM L2.counterparty_rating_observation cro\nWHERE cro.counterparty_id = :counterparty_id AND cro.rating_type = 'EXTERNAL' AND cro.as_of_date = :as_of_date",
    "executable_metric_id": "C039",
    "detailed_description": "External rating direction: Downgrade / Upgrade / Stable.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.860Z",
    "updated_at": "2026-02-21T18:04:26.860Z"
  },
  {
    "variant_id": "C040",
    "variant_name": "risk_rating_external_steps",
    "parent_metric_id": "C040",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "prior_rating_notch - current_rating_notch",
    "formula_specification": "SELECT rsd_prior.rating_notch - rsd_curr.rating_notch AS steps\nFROM L2.counterparty_rating_observation cro\nJOIN L1.rating_scale_dim rsd_curr ON rsd_curr.rating_grade_id = cro.rating_grade_id\nLEFT JOIN L1.rating_scale_dim rsd_prior ON rsd_prior.rating_value = cro.prior_rating_value AND rsd_prior.scale_type = rsd_curr.scale_type\nWHERE cro.counterparty_id = :counterparty_id AND cro.rating_type = 'EXTERNAL' AND cro.as_of_date = :as_of_date",
    "executable_metric_id": "C040",
    "detailed_description": "External rating change in notch steps (negative = downgrade, e.g. AAA → A = -2).",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.861Z",
    "updated_at": "2026-02-21T18:04:26.861Z"
  },
  {
    "variant_id": "C041",
    "variant_name": "riskMitigantAmount",
    "parent_metric_id": "C041",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(allocated_amount_usd)",
    "formula_specification": "SELECT SUM(cs.allocated_amount_usd)\nFROM L2.collateral_snapshot cs\nWHERE cs.facility_id = :facility_id AND cs.allocated_amount_usd IS NOT NULL AND cs.as_of_date = :as_of_date",
    "executable_metric_id": "C041",
    "detailed_description": "Total risk mitigant value allocated to a facility.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.863Z",
    "updated_at": "2026-02-21T18:04:26.863Z"
  },
  {
    "variant_id": "C042",
    "variant_name": "riskMitigantType",
    "parent_metric_id": "C042",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "ARGMAX(mitigant_subtype, SUM(allocated_amount_usd))",
    "formula_specification": "SELECT cs.mitigant_subtype FROM L2.collateral_snapshot cs\nWHERE cs.facility_id = :facility_id AND cs.as_of_date = :as_of_date\nGROUP BY cs.mitigant_subtype ORDER BY SUM(cs.allocated_amount_usd) DESC LIMIT 1",
    "executable_metric_id": "C042",
    "detailed_description": "Dominant risk mitigant type by value (Cash, Sovereign Debt, Guarantees, etc.).",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.864Z",
    "updated_at": "2026-02-21T18:04:26.864Z"
  },
  {
    "variant_id": "C043",
    "variant_name": "riskMitigantSubType",
    "parent_metric_id": "C043",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "ARGMAX(mitigant_group_code, SUM(allocated_amount_usd))",
    "formula_specification": "SELECT cs.mitigant_group_code FROM L2.collateral_snapshot cs\nWHERE cs.facility_id = :facility_id AND cs.as_of_date = :as_of_date\nGROUP BY cs.mitigant_group_code ORDER BY SUM(cs.allocated_amount_usd) DESC LIMIT 1",
    "executable_metric_id": "C043",
    "detailed_description": "Dominant mitigant group (M1 = Eligible Collateral, M2 = Other CRM) by value.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.866Z",
    "updated_at": "2026-02-21T18:04:26.866Z"
  },
  {
    "variant_id": "C044",
    "variant_name": "participatingCounterpartyIds",
    "parent_metric_id": "C044",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "LISTAGG(DISTINCT counterparty_id)",
    "formula_specification": "SELECT LISTAGG(DISTINCT fcp.counterparty_id, ',') WITHIN GROUP (ORDER BY fcp.counterparty_id)\nFROM L1.facility_counterparty_participation fcp WHERE fcp.facility_id = :facility_id",
    "executable_metric_id": "C044",
    "detailed_description": "List of counterparty IDs participating in a syndicated facility.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.868Z",
    "updated_at": "2026-02-21T18:04:26.868Z"
  },
  {
    "variant_id": "C045",
    "variant_name": "isSyndicated",
    "parent_metric_id": "C045",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "CASE WHEN COUNT(DISTINCT counterparty_id) > 1 THEN 1 ELSE 0 END",
    "formula_specification": "SELECT CASE WHEN COUNT(DISTINCT fcp.counterparty_id) > 1 THEN 1 ELSE 0 END\nFROM L1.facility_counterparty_participation fcp WHERE fcp.facility_id = :facility_id",
    "executable_metric_id": "C045",
    "detailed_description": "Syndication flag: >1 participating counterparty.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.869Z",
    "updated_at": "2026-02-21T18:04:26.869Z"
  },
  {
    "variant_id": "C046",
    "variant_name": "outstandingExposure",
    "parent_metric_id": "C046",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "gross_exposure_usd from facility_exposure_snapshot",
    "formula_specification": "SELECT fes.gross_exposure_usd\nFROM L2.facility_exposure_snapshot fes\nWHERE fes.facility_id = :facility_id AND fes.as_of_date = :as_of_date",
    "executable_metric_id": "C046",
    "detailed_description": "Outstanding gross exposure for the facility. Direct read from facility_exposure_snapshot.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.871Z",
    "updated_at": "2026-02-21T18:04:26.871Z"
  },
  {
    "variant_id": "C047",
    "variant_name": "isActive",
    "parent_metric_id": "C047",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "CASE WHEN facility_status = 'Active' THEN 1 ELSE 0 END",
    "formula_specification": "SELECT CASE WHEN fm.facility_status = 'Active' THEN 1 ELSE 0 END FROM L1.facility_master fm WHERE fm.facility_id = :facility_id",
    "executable_metric_id": "C047",
    "detailed_description": "Active facility flag.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.872Z",
    "updated_at": "2026-02-21T18:04:26.872Z"
  },
  {
    "variant_id": "C048",
    "variant_name": "hasAmendment",
    "parent_metric_id": "C048",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "CASE WHEN EXISTS amendment_event THEN 1 ELSE 0 END",
    "formula_specification": "SELECT CASE WHEN EXISTS (SELECT 1 FROM L2.amendment_event ae\nWHERE ae.facility_id = :facility_id AND ae.amendment_status NOT IN ('Rejected','Complete') AND ae.as_of_date = :as_of_date)\nTHEN 1 ELSE 0 END",
    "executable_metric_id": "C048",
    "detailed_description": "Flag: facility has an active/pending amendment.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.874Z",
    "updated_at": "2026-02-21T18:04:26.874Z"
  },
  {
    "variant_id": "C049",
    "variant_name": "spread_pct_fac",
    "parent_metric_id": "C049",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "spread_bps / 100",
    "formula_specification": "SELECT fps.spread_bps / 100.0 FROM L2.facility_pricing_snapshot fps\nWHERE fps.facility_id = :facility_id AND fps.as_of_date = :as_of_date",
    "executable_metric_id": "C049",
    "detailed_description": "Credit spread (%) for the facility.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.876Z",
    "updated_at": "2026-02-21T18:04:26.876Z"
  },
  {
    "variant_id": "C050",
    "variant_name": "base_rate_pct_fac",
    "parent_metric_id": "C050",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "base_rate_pct",
    "formula_specification": "SELECT fps.base_rate_pct FROM L2.facility_pricing_snapshot fps WHERE fps.facility_id = :facility_id AND fps.as_of_date = :as_of_date",
    "executable_metric_id": "C050",
    "detailed_description": "Base/reference rate (%) for the facility.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.878Z",
    "updated_at": "2026-02-21T18:04:26.878Z"
  },
  {
    "variant_id": "C051",
    "variant_name": "fee_rate_pct_fac",
    "parent_metric_id": "C051",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(fee_income_amt / avg_earning_assets_amt) * 100",
    "formula_specification": "SELECT (fps.fee_income_amt / NULLIF(fps.avg_earning_assets_amt, 0)) * 100\nFROM L2.facility_profitability_snapshot fps WHERE fps.facility_id = :facility_id AND fps.as_of_date = :as_of_date",
    "executable_metric_id": "C051",
    "detailed_description": "Fee rate as % of average earning assets.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.880Z",
    "updated_at": "2026-02-21T18:04:26.880Z"
  },
  {
    "variant_id": "C052",
    "variant_name": "tenor_years_fac",
    "parent_metric_id": "C052",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(maturity_date - origination_date) / 365.25",
    "formula_specification": "SELECT DATEDIFF(fm.maturity_date, fm.origination_date) / 365.25 FROM L1.facility_master fm WHERE fm.facility_id = :facility_id",
    "executable_metric_id": "C052",
    "detailed_description": "Tenor in years from origination to maturity.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.881Z",
    "updated_at": "2026-02-21T18:04:26.881Z"
  },
  {
    "variant_id": "C053",
    "variant_name": "days_until_maturity",
    "parent_metric_id": "C053",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "maturity_date - CURRENT_DATE",
    "formula_specification": "SELECT DATEDIFF(fm.maturity_date, CURRENT_DATE) FROM L1.facility_master fm WHERE fm.facility_id = :facility_id",
    "executable_metric_id": "C053",
    "detailed_description": "Days remaining until facility maturity.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.883Z",
    "updated_at": "2026-02-21T18:04:26.883Z"
  },
  {
    "variant_id": "C054",
    "variant_name": "num_loans",
    "parent_metric_id": "C054",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "COUNT(position_id)",
    "formula_specification": "SELECT COUNT(p.position_id) FROM L2.position p\nWHERE p.facility_id = :facility_id AND p.as_of_date = :as_of_date",
    "executable_metric_id": "C054",
    "detailed_description": "Count of loan positions under a facility.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.884Z",
    "updated_at": "2026-02-21T18:04:26.884Z"
  },
  {
    "variant_id": "C055",
    "variant_name": "exposure_utilized_fac",
    "parent_metric_id": "C055",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "contribution_amount_usd from limit_contribution_snapshot",
    "formula_specification": "SELECT SUM(lcs.contribution_amount_usd) FROM L2.limit_contribution_snapshot lcs\nWHERE lcs.facility_id = :facility_id AND lcs.as_of_date = :as_of_date",
    "executable_metric_id": "C055",
    "detailed_description": "Utilized exposure at facility level from limit contribution.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.887Z",
    "updated_at": "2026-02-21T18:04:26.887Z"
  },
  {
    "variant_id": "C058",
    "variant_name": "num_portfolios",
    "parent_metric_id": "C058",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "COUNT(DISTINCT portfolio_id)",
    "formula_specification": "SELECT COUNT(DISTINCT pd.portfolio_id) FROM L1.portfolio_dim pd\nWHERE pd.lob_segment_id = :lob_segment_id AND pd.active_flag = 'Y'",
    "executable_metric_id": "C058",
    "detailed_description": "Number of active portfolios in the department/LoB.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.888Z",
    "updated_at": "2026-02-21T18:04:26.888Z"
  },
  {
    "variant_id": "C059",
    "variant_name": "num_desks",
    "parent_metric_id": "C059",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "COUNT(DISTINCT org_unit_id) WHERE type = 'DESK'",
    "formula_specification": "SELECT COUNT(DISTINCT oud.org_unit_id) FROM L1.org_unit_dim oud\nWHERE oud.lob_segment_id = :lob_segment_id AND oud.org_unit_type = 'DESK' AND oud.is_current = 'Y'",
    "executable_metric_id": "C059",
    "detailed_description": "Number of desks in the department/LoB.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.889Z",
    "updated_at": "2026-02-21T18:04:26.889Z"
  },
  {
    "variant_id": "C060",
    "variant_name": "exposure_limit_m",
    "parent_metric_id": "C060",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(limit_amount_usd) WHERE limit_scope = LOB",
    "formula_specification": "SELECT SUM(lr.limit_amount_usd) FROM L1.limit_rule lr\nWHERE lr.limit_scope = 'LOB' AND lr.lob_segment_id = :lob_segment_id AND lr.effective_to_date IS NULL",
    "executable_metric_id": "C060",
    "detailed_description": "Total approved exposure limit for the department/LoB.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.891Z",
    "updated_at": "2026-02-21T18:04:26.891Z"
  },
  {
    "variant_id": "C061",
    "variant_name": "utilizationPct_portfolio",
    "parent_metric_id": "C061",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(SUM(utilized_exposure) / SUM(limit_amount)) * 100",
    "formula_specification": "SELECT (SUM(lue.utilized_amount_usd) / NULLIF(SUM(lr.limit_amount_usd), 0)) * 100\nFROM L2.limit_utilization_event lue\nJOIN L1.limit_rule lr ON lr.limit_rule_id = lue.limit_rule_id\nJOIN L1.facility_master fm ON fm.counterparty_id = lr.counterparty_id\nWHERE fm.portfolio_id = :portfolio_id AND lr.effective_to_date IS NULL AND lue.as_of_date = :as_of_date",
    "executable_metric_id": "C061",
    "detailed_description": "Utilization % at portfolio level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.893Z",
    "updated_at": "2026-02-21T18:04:26.893Z"
  },
  {
    "variant_id": "C062",
    "variant_name": "limit_status",
    "parent_metric_id": "C062",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Worst-case tier across counterparties in portfolio",
    "formula_specification": "SELECT CASE\n  WHEN MAX(CASE WHEN (lue.utilized_amount_usd / lr.limit_amount_usd)*100 >= lr.outer_threshold_pct THEN 1 ELSE 0 END) = 1 THEN 'Breach'\n  WHEN MAX(CASE WHEN (lue.utilized_amount_usd / lr.limit_amount_usd)*100 >= lr.inner_threshold_pct THEN 1 ELSE 0 END) = 1 THEN 'Warning'\n  ELSE 'No Breach' END\nFROM L2.limit_utilization_event lue\nJOIN L1.limit_rule lr ON lr.limit_rule_id = lue.limit_rule_id\nJOIN L1.facility_master fm ON fm.counterparty_id = lr.counterparty_id\nWHERE fm.portfolio_id = :portfolio_id AND lue.as_of_date = :as_of_date",
    "executable_metric_id": "C062",
    "detailed_description": "Worst-case limit status across all counterparties in the portfolio.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.894Z",
    "updated_at": "2026-02-21T18:04:26.894Z"
  },
  {
    "variant_id": "C063",
    "variant_name": "exposure_mom_change_pct_portfolio",
    "parent_metric_id": "C063",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current - prior_month) / prior_month) * 100",
    "formula_specification": "SELECT ((curr.t - prior.t) / NULLIF(prior.t, 0)) * 100\nFROM (SELECT SUM(fes.gross_exposure_usd) t FROM L2.facility_exposure_snapshot fes JOIN L1.facility_master fm ON fm.facility_id = fes.facility_id WHERE fm.portfolio_id = :pid AND fes.as_of_date = :as_of_date) curr,\n(SELECT SUM(fes.gross_exposure_usd) t FROM L2.facility_exposure_snapshot fes JOIN L1.facility_master fm ON fm.facility_id = fes.facility_id WHERE fm.portfolio_id = :pid AND fes.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_month_end = 'Y')) prior",
    "executable_metric_id": "C063",
    "detailed_description": "Month-over-month exposure change at portfolio level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.896Z",
    "updated_at": "2026-02-21T18:04:26.896Z"
  },
  {
    "variant_id": "C064",
    "variant_name": "exposure_qoq_change_pct_portfolio",
    "parent_metric_id": "C064",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current - prior_quarter) / prior_quarter) * 100",
    "formula_specification": "SELECT ((curr.t - prior.t) / NULLIF(prior.t, 0)) * 100\nFROM (SELECT SUM(fes.gross_exposure_usd) t FROM L2.facility_exposure_snapshot fes JOIN L1.facility_master fm ON fm.facility_id = fes.facility_id WHERE fm.portfolio_id = :pid AND fes.as_of_date = :as_of_date) curr,\n(SELECT SUM(fes.gross_exposure_usd) t FROM L2.facility_exposure_snapshot fes JOIN L1.facility_master fm ON fm.facility_id = fes.facility_id WHERE fm.portfolio_id = :pid AND fes.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_quarter_end = 'Y')) prior",
    "executable_metric_id": "C064",
    "detailed_description": "Quarter-over-quarter exposure change at portfolio level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.897Z",
    "updated_at": "2026-02-21T18:04:26.897Z"
  },
  {
    "variant_id": "C065",
    "variant_name": "exposure_yoy_change_pct_portfolio",
    "parent_metric_id": "C065",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current - prior_year) / prior_year) * 100",
    "formula_specification": "SELECT ((curr.t - prior.t) / NULLIF(prior.t, 0)) * 100\nFROM (SELECT SUM(fes.gross_exposure_usd) t FROM L2.facility_exposure_snapshot fes JOIN L1.facility_master fm ON fm.facility_id = fes.facility_id WHERE fm.portfolio_id = :pid AND fes.as_of_date = :as_of_date) curr,\n(SELECT SUM(fes.gross_exposure_usd) t FROM L2.facility_exposure_snapshot fes JOIN L1.facility_master fm ON fm.facility_id = fes.facility_id WHERE fm.portfolio_id = :pid AND fes.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_year_end = 'Y')) prior",
    "executable_metric_id": "C065",
    "detailed_description": "Year-over-year exposure change at portfolio level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.899Z",
    "updated_at": "2026-02-21T18:04:26.899Z"
  },
  {
    "variant_id": "C066",
    "variant_name": "spread_mom_change_pct",
    "parent_metric_id": "C066",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current_avg_spread - prior_avg_spread) / prior_avg_spread) * 100",
    "formula_specification": "SELECT ((curr.s - prior.s) / NULLIF(prior.s, 0)) * 100\nFROM (SELECT AVG(fps.spread_bps) s FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = :as_of_date) curr,\n(SELECT AVG(fps.spread_bps) s FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_month_end = 'Y')) prior",
    "executable_metric_id": "C066",
    "detailed_description": "Month-over-month spread change.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.900Z",
    "updated_at": "2026-02-21T18:04:26.900Z"
  },
  {
    "variant_id": "C067",
    "variant_name": "spread_qoq_change_pct",
    "parent_metric_id": "C067",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current_avg_spread - prior_avg_spread) / prior_avg_spread) * 100",
    "formula_specification": "SELECT ((curr.s - prior.s) / NULLIF(prior.s, 0)) * 100\nFROM (SELECT AVG(fps.spread_bps) s FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = :as_of_date) curr,\n(SELECT AVG(fps.spread_bps) s FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_quarter_end = 'Y')) prior",
    "executable_metric_id": "C067",
    "detailed_description": "Quarter-over-quarter spread change.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.902Z",
    "updated_at": "2026-02-21T18:04:26.902Z"
  },
  {
    "variant_id": "C068",
    "variant_name": "spread_yoy_change_pct",
    "parent_metric_id": "C068",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current_avg_spread - prior_avg_spread) / prior_avg_spread) * 100",
    "formula_specification": "SELECT ((curr.s - prior.s) / NULLIF(prior.s, 0)) * 100\nFROM (SELECT AVG(fps.spread_bps) s FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = :as_of_date) curr,\n(SELECT AVG(fps.spread_bps) s FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_year_end = 'Y')) prior",
    "executable_metric_id": "C068",
    "detailed_description": "Year-over-year spread change.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.905Z",
    "updated_at": "2026-02-21T18:04:26.905Z"
  },
  {
    "variant_id": "C069",
    "variant_name": "base_rate_mom_change_pct",
    "parent_metric_id": "C069",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current_avg_base - prior_avg_base) / prior_avg_base) * 100",
    "formula_specification": "SELECT ((curr.r - prior.r) / NULLIF(prior.r, 0)) * 100\nFROM (SELECT AVG(fps.base_rate_pct) r FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = :as_of_date) curr,\n(SELECT AVG(fps.base_rate_pct) r FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_month_end = 'Y')) prior",
    "executable_metric_id": "C069",
    "detailed_description": "Month-over-month base rate change.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.906Z",
    "updated_at": "2026-02-21T18:04:26.906Z"
  },
  {
    "variant_id": "C070",
    "variant_name": "base_rate_qoq_change_pct",
    "parent_metric_id": "C070",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current_avg_base - prior_avg_base) / prior_avg_base) * 100",
    "formula_specification": "SELECT ((curr.r - prior.r) / NULLIF(prior.r, 0)) * 100\nFROM (SELECT AVG(fps.base_rate_pct) r FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = :as_of_date) curr,\n(SELECT AVG(fps.base_rate_pct) r FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_quarter_end = 'Y')) prior",
    "executable_metric_id": "C070",
    "detailed_description": "Quarter-over-quarter base rate change.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.908Z",
    "updated_at": "2026-02-21T18:04:26.908Z"
  },
  {
    "variant_id": "C071",
    "variant_name": "base_rate_yoy_change_pct",
    "parent_metric_id": "C071",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current_avg_base - prior_avg_base) / prior_avg_base) * 100",
    "formula_specification": "SELECT ((curr.r - prior.r) / NULLIF(prior.r, 0)) * 100\nFROM (SELECT AVG(fps.base_rate_pct) r FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = :as_of_date) curr,\n(SELECT AVG(fps.base_rate_pct) r FROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id WHERE fm.portfolio_id = :pid AND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_year_end = 'Y')) prior",
    "executable_metric_id": "C071",
    "detailed_description": "Year-over-year base rate change.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.910Z",
    "updated_at": "2026-02-21T18:04:26.910Z"
  },
  {
    "variant_id": "C072",
    "variant_name": "delinquency_rate_pct",
    "parent_metric_id": "C072",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(delinquent_exposure) / SUM(total_exposure) * 100",
    "formula_specification": "SELECT (SUM(CASE WHEN fds.delinquency_status_code != 'CURRENT' THEN fes.gross_exposure_usd ELSE 0 END) / NULLIF(SUM(fes.gross_exposure_usd), 0)) * 100\nFROM L2.facility_exposure_snapshot fes\nJOIN L2.facility_delinquency_snapshot fds ON fds.facility_id = fes.facility_id AND fds.as_of_date = fes.as_of_date\nJOIN L1.facility_master fm ON fm.facility_id = fes.facility_id\nWHERE fm.portfolio_id = :portfolio_id AND fes.as_of_date = :as_of_date",
    "executable_metric_id": "C072",
    "detailed_description": "Delinquency rate: delinquent exposure / total exposure.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.912Z",
    "updated_at": "2026-02-21T18:04:26.912Z"
  },
  {
    "variant_id": "C073",
    "variant_name": "downgrades_mom_change_pct",
    "parent_metric_id": "C073",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "((current_downgrades - prior_month_downgrades) / prior_month_downgrades) * 100",
    "formula_specification": "SELECT ((curr.cnt - prior.cnt) / NULLIF(prior.cnt, 0)) * 100\nFROM (SELECT COUNT(*) cnt FROM L2.counterparty_rating_observation cro JOIN L1.facility_master fm ON fm.counterparty_id = cro.counterparty_id\nWHERE fm.portfolio_id = :pid AND cro.rating_type = 'INTERNAL' AND cro.rating_value > cro.prior_rating_value AND cro.as_of_date = :as_of_date) curr,\n(SELECT COUNT(*) cnt FROM L2.counterparty_rating_observation cro JOIN L1.facility_master fm ON fm.counterparty_id = cro.counterparty_id\nWHERE fm.portfolio_id = :pid AND cro.rating_type = 'INTERNAL' AND cro.rating_value > cro.prior_rating_value\nAND cro.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_month_end = 'Y')) prior",
    "executable_metric_id": "C073",
    "detailed_description": "MoM change in count of internal rating downgrades.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.914Z",
    "updated_at": "2026-02-21T18:04:26.914Z"
  },
  {
    "variant_id": "C074",
    "variant_name": "rwa_density_pct",
    "parent_metric_id": "C074",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(SUM(rwa_amount) / SUM(exposure)) * 100",
    "formula_specification": "SELECT (SUM(fmo.metric_value_usd) / NULLIF(SUM(fes.gross_exposure_usd), 0)) * 100\nFROM L2.financial_metric_observation fmo\nJOIN L2.facility_exposure_snapshot fes ON fes.counterparty_id = fmo.counterparty_id AND fes.as_of_date = fmo.as_of_date\nJOIN L1.facility_master fm ON fm.facility_id = fes.facility_id\nWHERE fmo.metric_code = 'RWA' AND fm.portfolio_id = :portfolio_id AND fmo.as_of_date = :as_of_date",
    "executable_metric_id": "C074",
    "detailed_description": "RWA density: risk-weighted assets / exposure. RWA is pre-calculated by risk engine and stored in financial_metric_observation (metric_code = RWA). MODEL GAP: for position-level drill-down, add risk_weight_pct and rwa_amount_usd to L2.position.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.916Z",
    "updated_at": "2026-02-21T18:04:26.916Z"
  },
  {
    "variant_id": "C075",
    "variant_name": "prior_month_rwa_density_pct",
    "parent_metric_id": "C075",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Prior month: (SUM(rwa) / SUM(exposure)) * 100",
    "formula_specification": "SELECT (SUM(fmo.metric_value_usd) / NULLIF(SUM(fes.gross_exposure_usd), 0)) * 100\nFROM L2.financial_metric_observation fmo\nJOIN L2.facility_exposure_snapshot fes ON fes.counterparty_id = fmo.counterparty_id AND fes.as_of_date = fmo.as_of_date\nJOIN L1.facility_master fm ON fm.facility_id = fes.facility_id\nWHERE fmo.metric_code = 'RWA' AND fm.portfolio_id = :portfolio_id\nAND fmo.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_month_end = 'Y')",
    "executable_metric_id": "C075",
    "detailed_description": "RWA density for prior month-end.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.918Z",
    "updated_at": "2026-02-21T18:04:26.918Z"
  },
  {
    "variant_id": "C076",
    "variant_name": "prior_month_spread_pct_desk",
    "parent_metric_id": "C076",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "AVG(spread_bps) / 100 for Prior Month",
    "formula_specification": "SELECT AVG(fps.spread_bps) / 100.0\nFROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nJOIN L1.org_unit_dim oud ON oud.lob_segment_id = fm.lob_segment_id AND oud.org_unit_type = 'DESK'\nWHERE oud.org_unit_id = :org_unit_id\nAND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_month_end = 'Y')",
    "executable_metric_id": "C076",
    "detailed_description": "Average spread at desk level for prior month.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.919Z",
    "updated_at": "2026-02-21T18:04:26.919Z"
  },
  {
    "variant_id": "C077",
    "variant_name": "prior_quarter_spread_pct_desk",
    "parent_metric_id": "C077",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "AVG(spread_bps) / 100 for Prior Quarter",
    "formula_specification": "SELECT AVG(fps.spread_bps) / 100.0\nFROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nJOIN L1.org_unit_dim oud ON oud.lob_segment_id = fm.lob_segment_id AND oud.org_unit_type = 'DESK'\nWHERE oud.org_unit_id = :org_unit_id\nAND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_quarter_end = 'Y')",
    "executable_metric_id": "C077",
    "detailed_description": "Average spread at desk level for prior quarter.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.921Z",
    "updated_at": "2026-02-21T18:04:26.921Z"
  },
  {
    "variant_id": "C078",
    "variant_name": "prior_year_spread_pct_desk",
    "parent_metric_id": "C078",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "AVG(spread_bps) / 100 for Prior Year",
    "formula_specification": "SELECT AVG(fps.spread_bps) / 100.0\nFROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nJOIN L1.org_unit_dim oud ON oud.lob_segment_id = fm.lob_segment_id AND oud.org_unit_type = 'DESK'\nWHERE oud.org_unit_id = :org_unit_id\nAND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_year_end = 'Y')",
    "executable_metric_id": "C078",
    "detailed_description": "Average spread at desk level for prior year.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.923Z",
    "updated_at": "2026-02-21T18:04:26.923Z"
  },
  {
    "variant_id": "C079",
    "variant_name": "prior_month_base_rate_pct_desk",
    "parent_metric_id": "C079",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "AVG(base_rate_pct) for Prior Month",
    "formula_specification": "SELECT AVG(fps.base_rate_pct)\nFROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nJOIN L1.org_unit_dim oud ON oud.lob_segment_id = fm.lob_segment_id AND oud.org_unit_type = 'DESK'\nWHERE oud.org_unit_id = :org_unit_id\nAND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_month_end = 'Y')",
    "executable_metric_id": "C079",
    "detailed_description": "Average base rate at desk level for prior month.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.925Z",
    "updated_at": "2026-02-21T18:04:26.925Z"
  },
  {
    "variant_id": "C080",
    "variant_name": "prior_quarter_base_rate_pct_desk",
    "parent_metric_id": "C080",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "AVG(base_rate_pct) for Prior Quarter",
    "formula_specification": "SELECT AVG(fps.base_rate_pct)\nFROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nJOIN L1.org_unit_dim oud ON oud.lob_segment_id = fm.lob_segment_id AND oud.org_unit_type = 'DESK'\nWHERE oud.org_unit_id = :org_unit_id\nAND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_quarter_end = 'Y')",
    "executable_metric_id": "C080",
    "detailed_description": "Average base rate at desk level for prior quarter.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.927Z",
    "updated_at": "2026-02-21T18:04:26.927Z"
  },
  {
    "variant_id": "C081",
    "variant_name": "prior_year_base_rate_pct_desk",
    "parent_metric_id": "C081",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "AVG(base_rate_pct) for Prior Year",
    "formula_specification": "SELECT AVG(fps.base_rate_pct)\nFROM L2.facility_pricing_snapshot fps JOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nJOIN L1.org_unit_dim oud ON oud.lob_segment_id = fm.lob_segment_id AND oud.org_unit_type = 'DESK'\nWHERE oud.org_unit_id = :org_unit_id\nAND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_year_end = 'Y')",
    "executable_metric_id": "C081",
    "detailed_description": "Average base rate at desk level for prior year.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.928Z",
    "updated_at": "2026-02-21T18:04:26.928Z"
  },
  {
    "variant_id": "C082",
    "variant_name": "assets_count_desk",
    "parent_metric_id": "C082",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "COUNT(DISTINCT collateral_asset_id)",
    "formula_specification": "SELECT COUNT(DISTINCT cs.collateral_asset_id)\nFROM L2.collateral_snapshot cs\nJOIN L1.facility_master fm ON fm.facility_id = cs.facility_id\nJOIN L1.org_unit_dim oud ON oud.lob_segment_id = fm.lob_segment_id AND oud.org_unit_type = 'DESK'\nWHERE oud.org_unit_id = :org_unit_id AND cs.as_of_date = :as_of_date",
    "executable_metric_id": "C082",
    "detailed_description": "Count of distinct collateral assets at desk level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.930Z",
    "updated_at": "2026-02-21T18:04:26.930Z"
  },
  {
    "variant_id": "C083",
    "variant_name": "prior_month_assets_count_desk",
    "parent_metric_id": "C083",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "COUNT(DISTINCT collateral_asset_id) for prior month",
    "formula_specification": "SELECT COUNT(DISTINCT cs.collateral_asset_id)\nFROM L2.collateral_snapshot cs\nJOIN L1.facility_master fm ON fm.facility_id = cs.facility_id\nJOIN L1.org_unit_dim oud ON oud.lob_segment_id = fm.lob_segment_id AND oud.org_unit_type = 'DESK'\nWHERE oud.org_unit_id = :org_unit_id\nAND cs.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_month_end = 'Y')",
    "executable_metric_id": "C083",
    "detailed_description": "Prior month collateral asset count at desk level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.932Z",
    "updated_at": "2026-02-21T18:04:26.932Z"
  },
  {
    "variant_id": "C084",
    "variant_name": "prior_month_net_income_m_desk",
    "parent_metric_id": "C084",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(interest_income + fee_income - interest_expense) for prior month",
    "formula_specification": "SELECT SUM(fps.interest_income_amt + fps.fee_income_amt - fps.interest_expense_amt)\nFROM L2.facility_profitability_snapshot fps\nJOIN L1.facility_master fm ON fm.facility_id = fps.facility_id\nJOIN L1.org_unit_dim oud ON oud.lob_segment_id = fm.lob_segment_id AND oud.org_unit_type = 'DESK'\nWHERE oud.org_unit_id = :org_unit_id\nAND fps.as_of_date = (SELECT MAX(calendar_date) FROM L1.date_dim WHERE calendar_date < :as_of_date AND is_month_end = 'Y')",
    "executable_metric_id": "C084",
    "detailed_description": "Prior month net income proxy at desk level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.934Z",
    "updated_at": "2026-02-21T18:04:26.934Z"
  },
  {
    "variant_id": "C085",
    "variant_name": "total_capital_m_desk",
    "parent_metric_id": "C085",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(metric_value_usd) WHERE metric_code = CAPITAL_REQ",
    "formula_specification": "SELECT SUM(fmo.metric_value_usd)\nFROM L2.financial_metric_observation fmo\nJOIN L1.facility_master fm ON fm.facility_id = fmo.facility_id\nJOIN L1.org_unit_dim oud ON oud.lob_segment_id = fm.lob_segment_id AND oud.org_unit_type = 'DESK'\nWHERE fmo.metric_code = 'CAPITAL_REQ' AND oud.org_unit_id = :org_unit_id AND fmo.as_of_date = :as_of_date",
    "executable_metric_id": "C085",
    "detailed_description": "Total capital requirement at desk level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.936Z",
    "updated_at": "2026-02-21T18:04:26.936Z"
  },
  {
    "variant_id": "C100",
    "variant_name": "Weighted Average Spread (%)",
    "parent_metric_id": "C100",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(spread_bps * drawn_amount) / SUM(drawn_amount) / 100",
    "executable_metric_id": "C100",
    "detailed_description": "Weighted average spread from facility pricing and exposure, calculated across hierarchy levels.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.938Z",
    "updated_at": "2026-02-21T18:04:26.938Z"
  },
  {
    "variant_id": "C101",
    "variant_name": "DSCR (Debt Service Coverage Ratio)",
    "parent_metric_id": "C101",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(dscr_value * outstanding_exposure) / SUM(outstanding_exposure)",
    "executable_metric_id": "C101",
    "detailed_description": "Exposure-weighted DSCR across hierarchy levels.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.940Z",
    "updated_at": "2026-02-21T18:04:26.940Z"
  },
  {
    "variant_id": "C102",
    "variant_name": "Outstanding Exposure ($)",
    "parent_metric_id": "C102",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(gross_exposure_usd)",
    "executable_metric_id": "C102",
    "detailed_description": "Total outstanding exposure aggregated at each hierarchy level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.943Z",
    "updated_at": "2026-02-21T18:04:26.943Z"
  },
  {
    "variant_id": "C103",
    "variant_name": "Utilized Exposure ($)",
    "parent_metric_id": "C103",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(drawn_amount)",
    "executable_metric_id": "C103",
    "detailed_description": "Total utilized/drawn exposure aggregated at each hierarchy level.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.945Z",
    "updated_at": "2026-02-21T18:04:26.945Z"
  },
  {
    "variant_id": "C104",
    "variant_name": "LTV (Loan-to-Value %)",
    "parent_metric_id": "C104",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(ltv_pct * outstanding_exposure) / SUM(outstanding_exposure)",
    "executable_metric_id": "C104",
    "detailed_description": "Exposure-weighted LTV across hierarchy levels.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.947Z",
    "updated_at": "2026-02-21T18:04:26.947Z"
  },
  {
    "variant_id": "C105",
    "variant_name": "Probability of Default (PD %)",
    "parent_metric_id": "C105",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(pd_pct * ead_amt) / NULLIF(SUM(ead_amt), 0)",
    "executable_metric_id": "C105",
    "detailed_description": "Exposure-weighted PD across hierarchy levels.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.949Z",
    "updated_at": "2026-02-21T18:04:26.949Z"
  },
  {
    "variant_id": "C106",
    "variant_name": "Loss Given Default (LGD %)",
    "parent_metric_id": "C106",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(lgd_pct * ead_amt) / NULLIF(SUM(ead_amt), 0)",
    "executable_metric_id": "C106",
    "detailed_description": "Exposure-weighted LGD across hierarchy levels.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.950Z",
    "updated_at": "2026-02-21T18:04:26.950Z"
  },
  {
    "variant_id": "C107",
    "variant_name": "Expected Loss ($)",
    "parent_metric_id": "C107",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM((pd_pct / 100) * (lgd_pct / 100) * ead_amt)",
    "executable_metric_id": "C107",
    "detailed_description": "Expected loss aggregated across hierarchy levels.",
    "rollup_logic": {
      "facility": "Calculated per facility (native grain).",
      "counterparty": "Aggregated from facility to counterparty.",
      "desk": "Rolled up to desk (e.g. weighted average or sum by L3 segment).",
      "portfolio": "Rolled up to portfolio (L2 segment).",
      "lob": "Rolled up to line of business (L1 segment)."
    },
    "created_at": "2026-02-21T18:04:26.952Z",
    "updated_at": "2026-02-21T18:04:26.952Z"
  }
]