[
  {
    "variant_id": "PD",
    "variant_name": "Probability of Default",
    "parent_metric_id": "PD",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "PD model output per obligor; inherited to facility; EAD-weighted average at aggregation levels",
    "detailed_description": "Point-in-time or through-the-cycle PD from internal rating model. Sourced at counterparty (obligor) level from Credit Risk Model Engine. Inherited to facility via counterparty_id join. Aggregated as EAD-weighted average at desk/portfolio/LOB.",
    "rollup_logic": {
      "facility": "INHERITED: facility.pd = counterparty.pd via JOIN on facility.counterparty_id = counterparty.counterparty_id. Override possible if facility-level PD model exists (rare).",
      "counterparty": "RAW SOURCE: pd_annual sourced directly from Credit Risk Model Engine per obligor. This is the atomic sourcing grain \u2014 one PD per counterparty_id per as_of_date.",
      "desk": "WEIGHTED AVG: desk_pd = \u03a3(facility_i.pd \u00d7 facility_i.ead) / \u03a3(facility_i.ead) FOR ALL facility_i WHERE facility_i.desk_id = desk.desk_id",
      "portfolio": "WEIGHTED AVG: portfolio_pd = \u03a3(facility_i.pd \u00d7 facility_i.ead) / \u03a3(facility_i.ead) FOR ALL facility_i WHERE facility_i.portfolio_id = portfolio.portfolio_id",
      "lob": "WEIGHTED AVG: lob_pd = \u03a3(facility_i.pd \u00d7 facility_i.ead) / \u03a3(facility_i.ead) FOR ALL facility_i WHERE facility_i.lob_id = lob.lob_id"
    },
    "weighting_basis": "BY_EAD",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Credit Risk Model Engine",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "Sourced directly from validated PD model at counterparty; T2 at facility (joined); T3 at desk/portfolio/LOB (derived aggregation)",
    "calculation_authority_components": "pd_annual, counterparty_id, ead (for weighting)",
    "calculation_authority_future_evolution": "Stable \u2014 facility-level T2\u2192T1 when facility PD override supported",
    "calculation_authority_migration_path": "T2\u2192T1 at facility level",
    "expected_gsib_data_source": "Credit Risk Model Engine",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Batch file",
    "source_endpoint_or_feed": "/feeds/pd_output",
    "source_variant_identifier": "obligor_pd",
    "source_payload_spec": [
      {
        "field_name": "counterparty_id",
        "required": true
      },
      {
        "field_name": "pd_annual",
        "required": true
      },
      {
        "field_name": "pd_model_version",
        "required": true
      },
      {
        "field_name": "as_of_date",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify model version matches approved; validate PD range [0,1]",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "counterparty",
      "facility"
    ],
    "sourcing_level_rationale": "PD assigned at obligor level per IRB requirements; inherited to facility for EAD-weighted rollups",
    "sourcing_category": "obligor",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "INHERIT: Credit Risk Model Engine \u2192 counterparty.pd_annual \u2192 JOIN(facility.counterparty_id) \u2192 facility.pd\nValidation: Confirm join integrity; flag orphan facilities without counterparty PD",
      "counterparty": "SOURCE: Credit Risk Model Engine \u2192 /feeds/pd_output \u2192 counterparty.pd_annual\nModel: Internal PD model (approved version)\nInputs: financial statements, behavioral data, macro factors\nValidation: model_version = approved_version; PD \u2208 [0.0001, 1.0]",
      "desk": "AGGREGATE: {facility.pd, facility.ead} \u2192 \u03a3(pd\u00d7ead)/\u03a3(ead) \u2192 desk.pd_weighted_avg\nFilter: facility.desk_id = target_desk_id\nDependencies: PD (this variant, facility level) + EAD (facility level)",
      "portfolio": "AGGREGATE: {facility.pd, facility.ead} \u2192 \u03a3(pd\u00d7ead)/\u03a3(ead) \u2192 portfolio.pd_weighted_avg\nFilter: facility.portfolio_id = target_portfolio_id\nDependencies: PD (facility) + EAD (facility)",
      "lob": "AGGREGATE: {facility.pd, facility.ead} \u2192 \u03a3(pd\u00d7ead)/\u03a3(ead) \u2192 lob.pd_weighted_avg\nFilter: facility.lob_id = target_lob_id\nDependencies: PD (facility) + EAD (facility)"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "LGD",
    "variant_name": "Loss Given Default",
    "parent_metric_id": "LGD",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "LGD model output per obligor; collateral-adjusted at facility; EAD-weighted average at aggregation levels",
    "detailed_description": "Unsecured LGD sourced at counterparty from Credit Risk Model Engine. Adjusted at facility level by incorporating facility-specific collateral (CRM). Aggregated as EAD-weighted average.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.lgd = f(counterparty.lgd_unsecured, facility.collateral_value, facility.exposure). Haircuts applied per Basel CRM rules. If no collateral: facility.lgd = counterparty.lgd_unsecured.",
      "counterparty": "RAW SOURCE: lgd_estimate sourced from Credit Risk Model Engine per obligor. Unsecured LGD before facility-level collateral adjustments.",
      "desk": "WEIGHTED AVG: desk_lgd = \u03a3(facility_i.lgd_adjusted \u00d7 facility_i.ead) / \u03a3(facility_i.ead) FOR ALL facility_i IN desk",
      "portfolio": "WEIGHTED AVG: portfolio_lgd = \u03a3(facility_i.lgd_adjusted \u00d7 facility_i.ead) / \u03a3(facility_i.ead) FOR ALL facility_i IN portfolio",
      "lob": "WEIGHTED AVG: lob_lgd = \u03a3(facility_i.lgd_adjusted \u00d7 facility_i.ead) / \u03a3(facility_i.ead) FOR ALL facility_i IN LOB"
    },
    "weighting_basis": "BY_EAD",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Credit Risk Model Engine + Collateral System",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at counterparty (sourced); T2 at facility (calculated from counterparty LGD + collateral); T3 at desk/portfolio/LOB (derived)",
    "calculation_authority_components": "lgd_estimate, collateral_value, exposure, Basel CRM haircuts",
    "calculation_authority_future_evolution": "Migrate facility T2\u2192T1 when model outputs collateral-adjusted LGD directly",
    "calculation_authority_migration_path": "T2\u2192T1 at facility",
    "expected_gsib_data_source": "Credit Risk Model Engine",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/lgd_output",
    "source_variant_identifier": "obligor_lgd",
    "source_payload_spec": [
      {
        "field_name": "counterparty_id",
        "required": true
      },
      {
        "field_name": "lgd_estimate",
        "required": true
      },
      {
        "field_name": "lgd_model_version",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify collateral adjustment haircuts applied correctly per Basel CRM framework",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "counterparty",
      "facility"
    ],
    "sourcing_level_rationale": "LGD assigned at obligor; adjusted at facility using collateral",
    "sourcing_category": "obligor",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "CALCULATE: counterparty.lgd_unsecured \u2192 ADJUST(facility.collateral_value, Basel_haircuts) \u2192 facility.lgd_secured\nFormula: lgd_adj = max(0, lgd_unsecured \u00d7 (1 - collateral_coverage \u00d7 (1-haircut)))\nDependencies: LGD (counterparty), COLLATERAL (facility), CRM haircut tables",
      "counterparty": "SOURCE: Credit Risk Model Engine \u2192 /feeds/lgd_output \u2192 counterparty.lgd_estimate\nModel: Internal LGD model (downturn calibration)\nInputs: collateral type, seniority, jurisdiction\nValidation: lgd \u2208 [0,1]; model_version approved",
      "desk": "AGGREGATE: {facility.lgd_adjusted, facility.ead} \u2192 \u03a3(lgd\u00d7ead)/\u03a3(ead) \u2192 desk.lgd_weighted_avg\nDependencies: LGD (facility adjusted) + EAD (facility)",
      "portfolio": "AGGREGATE: {facility.lgd_adjusted, facility.ead} \u2192 \u03a3(lgd\u00d7ead)/\u03a3(ead) \u2192 portfolio.lgd_weighted_avg\nDependencies: LGD (facility adjusted) + EAD (facility)",
      "lob": "AGGREGATE: {facility.lgd_adjusted, facility.ead} \u2192 \u03a3(lgd\u00d7ead)/\u03a3(ead) \u2192 lob.lgd_weighted_avg\nDependencies: LGD (facility adjusted) + EAD (facility)"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "EAD",
    "variant_name": "Exposure at Default",
    "parent_metric_id": "EAD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Outstanding + CCF \u00d7 Undrawn at facility; summed upward",
    "detailed_description": "Facility-level EAD combining drawn balance and credit conversion factor applied to undrawn commitment. Regulatory capital input reflecting forward-looking exposure position.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.ead = facility.outstanding + facility.ccf \u00d7 facility.undrawn\nWhere ccf = credit conversion factor per Basel III (regulatory or modeled)\nFor fully drawn facilities: ead = outstanding",
      "counterparty": "SUM: counterparty.ead = \u03a3(facility_i.ead) FOR ALL facility_i WHERE facility_i.counterparty_id = counterparty.counterparty_id",
      "desk": "SUM: desk.ead = \u03a3(facility_i.ead) FOR ALL facility_i WHERE facility_i.desk_id = desk.desk_id",
      "portfolio": "SUM: portfolio.ead = \u03a3(facility_i.ead) FOR ALL facility_i WHERE facility_i.portfolio_id = portfolio.portfolio_id",
      "lob": "SUM: lob.ead = \u03a3(facility_i.ead) FOR ALL facility_i WHERE facility_i.lob_id = lob.lob_id"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Exposure Management System",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1/T2 at facility (sourced components, calculated formula); T3 at all higher levels (sum)",
    "calculation_authority_components": "outstanding, undrawn, ccf, facility_id",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Exposure Management System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/facility_ead",
    "source_variant_identifier": "facility_ead",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "ead_amount",
        "required": true
      },
      {
        "field_name": "outstanding",
        "required": true
      },
      {
        "field_name": "undrawn",
        "required": true
      },
      {
        "field_name": "ccf",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify CCF aligns with Basel; reconcile EAD = outstanding + ccf\u00d7undrawn",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "EAD calculated at facility; summed additively at all higher levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "CALCULATE: Exposure Mgmt Sys \u2192 {outstanding, undrawn, ccf} \u2192 outstanding + ccf\u00d7undrawn \u2192 facility.ead\nDependencies: EXPOSURE (facility), UNDRAWN (facility), CCF table\nValidation: ead \u2265 outstanding; ccf \u2208 [0,1]",
      "counterparty": "SUM: \u03a3(facility.ead) WHERE counterparty_id = target \u2192 counterparty.ead\nDependencies: EAD (all facilities for counterparty)",
      "desk": "SUM: \u03a3(facility.ead) WHERE desk_id = target \u2192 desk.ead\nDependencies: EAD (all facilities for desk)",
      "portfolio": "SUM: \u03a3(facility.ead) WHERE portfolio_id = target \u2192 portfolio.ead\nDependencies: EAD (all facilities for portfolio)",
      "lob": "SUM: \u03a3(facility.ead) WHERE lob_id = target \u2192 lob.ead\nDependencies: EAD (all facilities for LOB)"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "EL",
    "variant_name": "Expected Loss",
    "parent_metric_id": "EL",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "PD \u00d7 LGD \u00d7 EAD at facility; summed upward",
    "detailed_description": "Calculated forward-looking credit loss estimate. Product of PD, LGD, and EAD at facility level. Summed additively at all higher organizational levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.el = facility.pd \u00d7 facility.lgd \u00d7 facility.ead\nAll three components must be populated; EL = 0 if any component missing",
      "counterparty": "SUM: counterparty.el = \u03a3(facility_i.el) FOR ALL facility_i WHERE facility_i.counterparty_id = counterparty.counterparty_id",
      "desk": "SUM: desk.el = \u03a3(facility_i.el) FOR ALL facility_i WHERE facility_i.desk_id = desk.desk_id",
      "portfolio": "SUM: portfolio.el = \u03a3(facility_i.el) FOR ALL facility_i WHERE facility_i.portfolio_id = portfolio.portfolio_id",
      "lob": "SUM: lob.el = \u03a3(facility_i.el) FOR ALL facility_i WHERE facility_i.lob_id = lob.lob_id"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from PD + LGD + EAD",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated from 3 sourced components); T3 at all higher levels (additive aggregation)",
    "calculation_authority_components": "PD (facility), LGD (facility adjusted), EAD (facility)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Risk Data Warehouse",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "EL calculated at facility from risk parameters; summed at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: {facility.pd, facility.lgd, facility.ead} \u2192 pd \u00d7 lgd \u00d7 ead \u2192 facility.el\nDependencies: PD (facility), LGD (facility), EAD (facility)\nValidation: el \u2265 0; el \u2264 ead",
      "counterparty": "SUM: \u03a3(facility.el) WHERE counterparty_id = target \u2192 counterparty.el",
      "desk": "SUM: \u03a3(facility.el) WHERE desk_id = target \u2192 desk.el",
      "portfolio": "SUM: \u03a3(facility.el) WHERE portfolio_id = target \u2192 portfolio.el",
      "lob": "SUM: \u03a3(facility.el) WHERE lob_id = target \u2192 lob.el"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "EL_RATE",
    "variant_name": "Expected Loss Rate",
    "parent_metric_id": "EL_RATE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "EL / Exposure \u00d7 100 \u2014 recalculated at each level (not averaged)",
    "detailed_description": "Loss intensity ratio. Recalculated at each aggregation level as sum of EL divided by sum of exposure, NOT as an average of lower-level rates.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.el_rate = (facility.el / facility.exposure) \u00d7 100\nIf exposure = 0: el_rate = NULL",
      "counterparty": "RECALCULATED: counterparty.el_rate = (\u03a3 facility.el / \u03a3 facility.exposure) \u00d7 100\nNOT avg of facility rates \u2014 must use component sums",
      "desk": "RECALCULATED: desk.el_rate = (\u03a3 facility.el / \u03a3 facility.exposure) \u00d7 100 FOR ALL facility IN desk\nNOT avg of counterparty rates",
      "portfolio": "RECALCULATED: portfolio.el_rate = (\u03a3 facility.el / \u03a3 facility.exposure) \u00d7 100 FOR ALL facility IN portfolio",
      "lob": "RECALCULATED: lob.el_rate = (\u03a3 facility.el / \u03a3 facility.exposure) \u00d7 100 FOR ALL facility IN LOB"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from EL + Exposure",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 at all levels \u2014 always derived from component metrics",
    "calculation_authority_components": "EL (at level), EXPOSURE (at level)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in analytics layer",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Ratio recalculated at every level using summed components",
    "sourcing_category": "flexible_level",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: facility.el / facility.exposure \u00d7 100 \u2192 facility.el_rate\nDependencies: EL (facility), EXPOSURE (facility)",
      "counterparty": "RECALCULATE: \u03a3(facility.el) / \u03a3(facility.exposure) \u00d7 100 \u2192 counterparty.el_rate\nCRITICAL: Do NOT average facility-level rates",
      "desk": "RECALCULATE: \u03a3(facility.el) / \u03a3(facility.exposure) \u00d7 100 \u2192 desk.el_rate\nDependencies: EL (all fac in desk), EXPOSURE (all fac in desk)",
      "portfolio": "RECALCULATE: \u03a3(facility.el) / \u03a3(facility.exposure) \u00d7 100 \u2192 portfolio.el_rate",
      "lob": "RECALCULATE: \u03a3(facility.el) / \u03a3(facility.exposure) \u00d7 100 \u2192 lob.el_rate"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "IRR",
    "variant_name": "Internal Risk Rating",
    "parent_metric_id": "IRR",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Rating model output at obligor; inherited to facility; weighted avg numeric AND distribution at higher levels",
    "detailed_description": "Bank-assigned internal credit risk rating. Sourced at counterparty. Inherited to facility. At desk/portfolio/LOB: (1) exposure-weighted average of numeric rating for single KPI, (2) distribution across rating buckets for segmentation analysis. Both aggregation methods available.",
    "rollup_logic": {
      "facility": "INHERITED: facility.irr = counterparty.irr via JOIN on counterparty_id\nFacility inherits parent obligor rating unless facility-level override exists",
      "counterparty": "RAW SOURCE: internal_risk_rating from Credit Risk Model Engine per obligor",
      "desk": "DUAL VIEW:\n(a) WEIGHTED AVG: desk.irr_wa = \u03a3(NUMERIC(facility.irr) \u00d7 facility.exposure) / \u03a3(facility.exposure)\n(b) DISTRIBUTION: desk.irr_dist = {rating_bucket: count, pct_of_total, pct_of_exposure} for each bucket",
      "portfolio": "DUAL VIEW:\n(a) WEIGHTED AVG: portfolio.irr_wa = \u03a3(NUMERIC(fac.irr) \u00d7 fac.exposure) / \u03a3(fac.exposure)\n(b) DISTRIBUTION: portfolio.irr_dist = {bucket: count, pct, exp_pct}",
      "lob": "DUAL VIEW:\n(a) WEIGHTED AVG: lob.irr_wa = \u03a3(NUMERIC(fac.irr) \u00d7 fac.exposure) / \u03a3(fac.exposure)\n(b) DISTRIBUTION: lob.irr_dist = {bucket: count, pct, exp_pct}"
    },
    "weighting_basis": "BY_EXPOSURE + DISTRIBUTION",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Credit Risk Model Engine",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at counterparty (sourced); T2 at facility (inherited); T3 at desk/portfolio/LOB (derived)",
    "calculation_authority_components": "internal_risk_rating, numeric_rating_map, exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Credit Risk Model Engine",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/ratings",
    "source_variant_identifier": "obligor_rating",
    "source_payload_spec": [
      {
        "field_name": "counterparty_id",
        "required": true
      },
      {
        "field_name": "internal_risk_rating",
        "required": true
      },
      {
        "field_name": "rating_date",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify rating within valid range; validate numeric mapping table",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "counterparty",
      "facility"
    ],
    "sourcing_level_rationale": "Rating at obligor level; inherited to facility",
    "sourcing_category": "obligor",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "INHERIT: Credit Risk Model Engine \u2192 counterparty.irr \u2192 JOIN(counterparty_id) \u2192 facility.irr\nNumeric map: AAA=1, AA+=2, ... CCC=16, D=17",
      "counterparty": "SOURCE: Credit Risk Model Engine \u2192 /feeds/ratings \u2192 counterparty.internal_risk_rating\nValidation: rating \u2208 approved_rating_scale",
      "desk": "DUAL:\n(a) WTD AVG: {fac.irr_numeric, fac.exposure} \u2192 \u03a3(irr_num\u00d7exp)/\u03a3(exp) \u2192 desk.irr_wa\n(b) DIST: GROUP BY irr \u2192 {bucket: count, %, exp%} \u2192 desk.irr_distribution",
      "portfolio": "DUAL:\n(a) WTD AVG \u2192 portfolio.irr_wa\n(b) DIST \u2192 portfolio.irr_distribution",
      "lob": "DUAL:\n(a) WTD AVG \u2192 lob.irr_wa\n(b) DIST \u2192 lob.irr_distribution"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "EXT_RATING",
    "variant_name": "External Rating",
    "parent_metric_id": "EXT_RATING",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Agency rating per counterparty; distribution at higher levels",
    "detailed_description": "Current external agency rating. Sourced at counterparty from Bloomberg/Refinitiv. Reported as distribution across rating buckets (IG/HY/NR) at aggregated levels.",
    "rollup_logic": {
      "facility": "INHERITED: facility.ext_rating = counterparty.ext_rating via counterparty_id join",
      "counterparty": "RAW SOURCE: counterparty.ext_rating from agency feed",
      "desk": "DISTRIBUTION: desk.ext_rating_dist = {bucket: COUNT(cpty WHERE ext_rating=bucket) / total, ...} OR exposure-weighted distribution",
      "portfolio": "DISTRIBUTION: portfolio.ext_rating_dist = distribution of ext_rating across portfolio",
      "lob": "DISTRIBUTION: lob.ext_rating_dist = distribution of ext_rating across LOB"
    },
    "weighting_basis": "DISTRIBUTION",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Bloomberg / Refinitiv",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at counterparty (sourced); T2 at facility (inherited); T3 at desk/portfolio/LOB (distribution aggregation)",
    "calculation_authority_components": "ext_rating, counterparty_id",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Bloomberg / Refinitiv",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/ext_ratings",
    "source_variant_identifier": "cpty_ext_rating",
    "source_payload_spec": [
      {
        "field_name": "counterparty_id",
        "required": true
      },
      {
        "field_name": "agency",
        "required": true
      },
      {
        "field_name": "rating",
        "required": true
      },
      {
        "field_name": "rating_date",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Map agency scales consistently",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Sourced at counterparty; distributed at aggregation levels",
    "sourcing_category": "obligor",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "INHERIT: External rating from agency via vendor \u2192 facility.ext_rating",
      "counterparty": "SOURCE: Bloomberg / Refinitiv \u2192 counterparty.ext_rating from agency feed \u2192 counterparty.ext_rating",
      "desk": "DISTRIBUTE: Group counterparties by ext_rating bucket \u2192 count/% per bucket \u2192 desk.ext_rating_distribution",
      "portfolio": "DISTRIBUTE: Group by ext_rating bucket \u2192 portfolio.ext_rating_distribution",
      "lob": "DISTRIBUTE: Group by ext_rating bucket \u2192 lob.ext_rating_distribution"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "DELINQ_RATE",
    "variant_name": "Delinquency Rate",
    "parent_metric_id": "DELINQ_RATE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count(Delinquent) / Total \u00d7 100 \u2014 recalculated at each level",
    "detailed_description": "Percentage of exposure that is delinquent. Recalculated at each aggregation level (not averaged from sub-levels).",
    "rollup_logic": {
      "facility": "CALCULATED: facility.delinq_flag = 1 WHERE days_delinquent > 0 (input to count)\nfacility.delinq_rate = N/A (binary at facility level)",
      "counterparty": "RECALCULATED: counterparty.delinq_rate = COUNT(facility WHERE delinq_flag=1) / COUNT(all facility) \u00d7 100 FOR counterparty",
      "desk": "RECALCULATED: desk.delinq_rate = COUNT(facility WHERE delinq_flag=1) / COUNT(all facility) \u00d7 100 FOR desk\nAlternative: \u03a3(delinquent_exposure) / \u03a3(total_exposure) \u00d7 100",
      "portfolio": "RECALCULATED: portfolio.delinq_rate = COUNT or EXP-weighted delinquent % FOR portfolio",
      "lob": "RECALCULATED: lob.delinq_rate = COUNT or EXP-weighted delinquent % FOR LOB"
    },
    "weighting_basis": "COUNT_BASED",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from delinquent flag",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 at all levels \u2014 derived from facility delinquent flag",
    "calculation_authority_components": "delinquent_flag, facility_count, exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Loan Servicing System (flag source)",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Delinquent flag at facility; rate recalculated at every level",
    "sourcing_category": "flexible_level",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "INPUT: Loan Servicing \u2192 days_delinquent \u2192 facility.delinq_flag (1 if >0)\nDependencies: DAYS_DELINQ (facility)",
      "counterparty": "CALCULATE: COUNT(fac WHERE delinq=1) / COUNT(all fac) \u00d7 100 \u2192 counterparty.delinq_rate",
      "desk": "CALCULATE: COUNT(fac WHERE delinq=1) / COUNT(all fac) \u00d7 100 \u2192 desk.delinq_rate",
      "portfolio": "CALCULATE: COUNT(fac WHERE delinq=1) / COUNT(all fac) \u00d7 100 \u2192 portfolio.delinq_rate",
      "lob": "CALCULATE: COUNT(fac WHERE delinq=1) / COUNT(all fac) \u00d7 100 \u2192 lob.delinq_rate"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "CRITICIZED",
    "variant_name": "Criticized Indicator",
    "parent_metric_id": "CRITICIZED",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "OCC classification flag; count/% at higher levels",
    "detailed_description": "Criticized classification per OCC guidelines. Sourced as binary flag at facility and counterparty levels.",
    "rollup_logic": {
      "facility": "RAW FLAG: facility.criticized = OCC classification flag (0/1)",
      "counterparty": "RAW FLAG or COUNT: counterparty.criticized sourced OR COUNT(flagged facilities) / total \u00d7 100",
      "desk": "PERCENTAGE: desk.criticized_pct = COUNT(facility WHERE criticized=1) / COUNT(all facility) \u00d7 100 IN desk\nAlternative: \u03a3(flagged_exposure) / \u03a3(total_exposure) \u00d7 100 for exposure-weighted",
      "portfolio": "PERCENTAGE: portfolio.criticized_pct = COUNT(facility WHERE criticized=1) / COUNT(all facility) \u00d7 100 IN portfolio",
      "lob": "PERCENTAGE: lob.criticized_pct = COUNT(facility WHERE criticized=1) / COUNT(all facility) \u00d7 100 IN LOB"
    },
    "weighting_basis": "COUNT_BASED",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Credit Review System",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility/counterparty (sourced flag); T3 at desk/portfolio/LOB (derived count/percentage)",
    "calculation_authority_components": "criticized_flag, count",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Credit Review System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/criticized",
    "source_variant_identifier": "fac_criticized",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "criticized_flag",
        "required": true
      },
      {
        "field_name": "classification_date",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Align with OCC SNC definitions",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Flag sourced at facility; count/percentage aggregated at higher levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Credit Review System \u2192 criticized_flag \u2192 facility.criticized\nValidation: Boolean (0/1)",
      "counterparty": "SOURCE or AGGREGATE: Sourced flag at counterparty OR count of flagged facilities",
      "desk": "AGGREGATE: COUNT(fac WHERE criticized=1) / COUNT(all fac) \u00d7 100 \u2192 desk.criticized_pct",
      "portfolio": "AGGREGATE: COUNT(fac WHERE criticized=1) / COUNT(all fac) \u00d7 100 \u2192 portfolio.criticized_pct",
      "lob": "AGGREGATE: COUNT(fac WHERE criticized=1) / COUNT(all fac) \u00d7 100 \u2192 lob.criticized_pct"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "DETERIORATED",
    "variant_name": "Deteriorated Indicator",
    "parent_metric_id": "DETERIORATED",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "CASE WHEN current_rating > prior_rating THEN 1 ELSE 0; count/% at higher levels",
    "detailed_description": "Derived indicator of internal rating worsening. Calculated from rating time series comparison.",
    "rollup_logic": {
      "facility": "RAW FLAG: facility.deteriorated = CASE WHEN current_numeric_rating > prior_numeric_rating THEN 1 ELSE 0",
      "counterparty": "RAW FLAG or COUNT: counterparty.deteriorated sourced OR COUNT(flagged facilities) / total \u00d7 100",
      "desk": "PERCENTAGE: desk.deteriorated_pct = COUNT(facility WHERE deteriorated=1) / COUNT(all facility) \u00d7 100 IN desk\nAlternative: \u03a3(flagged_exposure) / \u03a3(total_exposure) \u00d7 100 for exposure-weighted",
      "portfolio": "PERCENTAGE: portfolio.deteriorated_pct = COUNT(facility WHERE deteriorated=1) / COUNT(all facility) \u00d7 100 IN portfolio",
      "lob": "PERCENTAGE: lob.deteriorated_pct = COUNT(facility WHERE deteriorated=1) / COUNT(all facility) \u00d7 100 IN LOB"
    },
    "weighting_basis": "COUNT_BASED",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from rating time series",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility/counterparty (sourced flag); T3 at desk/portfolio/LOB (derived count/percentage)",
    "calculation_authority_components": "current_rating, prior_rating, count",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Flag sourced at counterparty; count/percentage aggregated at higher levels",
    "sourcing_category": "obligor",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Calculated from rating time series \u2192 current_rating, prior_rating \u2192 facility.deteriorated\nValidation: Boolean (0/1)",
      "counterparty": "SOURCE or AGGREGATE: Sourced flag at counterparty OR count of flagged facilities",
      "desk": "AGGREGATE: COUNT(fac WHERE deteriorated=1) / COUNT(all fac) \u00d7 100 \u2192 desk.deteriorated_pct",
      "portfolio": "AGGREGATE: COUNT(fac WHERE deteriorated=1) / COUNT(all fac) \u00d7 100 \u2192 portfolio.deteriorated_pct",
      "lob": "AGGREGATE: COUNT(fac WHERE deteriorated=1) / COUNT(all fac) \u00d7 100 \u2192 lob.deteriorated_pct"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "DAYS_OVERDUE",
    "variant_name": "Days Overdue",
    "parent_metric_id": "DAYS_OVERDUE",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Days past payment due date; max or weighted avg at higher levels",
    "detailed_description": "Calendar days payment is past due. Sourced at facility/counterparty. At higher levels: MAX for worst-case view, or EAD-weighted average for portfolio severity.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.days_overdue from Loan Servicing System (days past due date)\nCalculation: as_of_date - payment_due_date WHERE payment_due_date < as_of_date",
      "counterparty": "RAW SOURCE or MAX: counterparty.days_overdue = MAX(facility.days_overdue) for worst-case\nOR sourced directly at counterparty level from servicing",
      "desk": "DUAL VIEW:\n(a) MAX: desk.days_overdue_max = MAX(facility.days_overdue) FOR ALL facility IN desk\n(b) WEIGHTED AVG: desk.days_overdue_wa = \u03a3(fac.days_overdue \u00d7 fac.ead) / \u03a3(fac.ead)",
      "portfolio": "DUAL VIEW:\n(a) MAX: portfolio.days_overdue_max\n(b) WEIGHTED AVG: portfolio.days_overdue_wa",
      "lob": "DUAL VIEW:\n(a) MAX: lob.days_overdue_max\n(b) WEIGHTED AVG: lob.days_overdue_wa"
    },
    "weighting_basis": "MAX_OR_WA",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Loan Servicing System",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility/counterparty; T3 at desk/portfolio/LOB",
    "calculation_authority_components": "days_overdue, ead",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Loan Servicing System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/delinquency",
    "source_variant_identifier": "facility_days_overdue",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "days_overdue",
        "required": true
      },
      {
        "field_name": "payment_due_date",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify staging alignment (30/60/90+ buckets)",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty"
    ],
    "sourcing_level_rationale": "Days overdue at facility; max or wtd avg at higher levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Loan Servicing \u2192 payment_due_date, as_of_date \u2192 days_overdue \u2192 facility.days_overdue",
      "counterparty": "SOURCE/MAX: MAX(facility.days_overdue) or sourced at counterparty",
      "desk": "DUAL: (a) MAX(fac.days_overdue) \u2192 desk.max (b) \u03a3(days\u00d7ead)/\u03a3(ead) \u2192 desk.wa",
      "portfolio": "DUAL: (a) MAX \u2192 portfolio.max (b) WTD AVG \u2192 portfolio.wa",
      "lob": "DUAL: (a) MAX \u2192 lob.max (b) WTD AVG \u2192 lob.wa"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "EXPOSURE",
    "variant_name": "Exposure Outstanding",
    "parent_metric_id": "EXPOSURE",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Current funded credit exposure; summed at all levels",
    "detailed_description": "Current funded credit exposure in millions USD. Core balance sheet metric.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.exposure = outstanding balance from Core Banking",
      "counterparty": "SUM: counterparty.exposure = \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "SUM: desk.exposure = \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.exposure = \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "SUM: lob.exposure = \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Core Banking System",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "exposure_usd",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Core Banking System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/exposure",
    "source_variant_identifier": "facility_exposure",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "exposure_usd",
        "required": true
      },
      {
        "field_name": "as_of_date",
        "required": true
      },
      {
        "field_name": "currency",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile to GL daily",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Exposure Outstanding sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Core Banking System \u2192 facility.exposure = outstanding balance from Core Banking \u2192 facility.exposure\nDependencies: exposure_usd",
      "counterparty": "SUM: \u03a3(facility.exposure) WHERE counterparty_id = target \u2192 counterparty.exposure",
      "desk": "SUM: \u03a3(facility.exposure) WHERE desk_id = target \u2192 desk.exposure",
      "portfolio": "SUM: \u03a3(facility.exposure) WHERE portfolio_id = target \u2192 portfolio.exposure",
      "lob": "SUM: \u03a3(facility.exposure) WHERE lob_id = target \u2192 lob.exposure"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "COMMITTED",
    "variant_name": "Committed Amount",
    "parent_metric_id": "COMMITTED",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Total committed credit amount; summed at all levels",
    "detailed_description": "Total approved committed amount representing maximum contractual lending capacity.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.committed = total committed from Core Banking",
      "counterparty": "SUM: counterparty.committed = \u03a3(facility_i.committed) WHERE counterparty_id matches",
      "desk": "SUM: desk.committed = \u03a3(facility_i.committed) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.committed = \u03a3(facility_i.committed) WHERE portfolio_id matches",
      "lob": "SUM: lob.committed = \u03a3(facility_i.committed) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Core Banking System",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "committed_amt_usd",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Core Banking System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/committed",
    "source_variant_identifier": "committed_amt",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "committed_amt_usd",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile to booking system",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Committed Amount sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Core Banking System \u2192 facility.committed = total committed from Core Banking \u2192 facility.committed\nDependencies: committed_amt_usd",
      "counterparty": "SUM: \u03a3(facility.committed) WHERE counterparty_id = target \u2192 counterparty.committed",
      "desk": "SUM: \u03a3(facility.committed) WHERE desk_id = target \u2192 desk.committed",
      "portfolio": "SUM: \u03a3(facility.committed) WHERE portfolio_id = target \u2192 portfolio.committed",
      "lob": "SUM: \u03a3(facility.committed) WHERE lob_id = target \u2192 lob.committed"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "UNDRAWN",
    "variant_name": "Undrawn Exposure",
    "parent_metric_id": "UNDRAWN",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Committed - Utilized; summed at all levels",
    "detailed_description": "Committed minus utilized. Reflects contingent liquidity risk.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.undrawn = facility.committed - facility.utilized",
      "counterparty": "SUM: counterparty.undrawn = \u03a3(facility_i.undrawn) WHERE counterparty_id matches",
      "desk": "SUM: desk.undrawn = \u03a3(facility_i.undrawn) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.undrawn = \u03a3(facility_i.undrawn) WHERE portfolio_id matches",
      "lob": "SUM: lob.undrawn = \u03a3(facility_i.undrawn) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "committed (facility), utilized (facility)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Undrawn Exposure sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "CALCULATE: Calculated \u2192 facility.undrawn = facility.committed - facility.utilized \u2192 facility.undrawn\nDependencies: committed (facility), utilized (facility)",
      "counterparty": "SUM: \u03a3(facility.undrawn) WHERE counterparty_id = target \u2192 counterparty.undrawn",
      "desk": "SUM: \u03a3(facility.undrawn) WHERE desk_id = target \u2192 desk.undrawn",
      "portfolio": "SUM: \u03a3(facility.undrawn) WHERE portfolio_id = target \u2192 portfolio.undrawn",
      "lob": "SUM: \u03a3(facility.undrawn) WHERE lob_id = target \u2192 lob.undrawn"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "UTILIZED",
    "variant_name": "Utilized Exposure",
    "parent_metric_id": "UTILIZED",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Drawn amount; summed at all levels",
    "detailed_description": "Currently drawn portion of committed facility.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.utilized = drawn balance from Core Banking",
      "counterparty": "SUM: counterparty.utilized = \u03a3(facility_i.utilized) WHERE counterparty_id matches",
      "desk": "SUM: desk.utilized = \u03a3(facility_i.utilized) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.utilized = \u03a3(facility_i.utilized) WHERE portfolio_id matches",
      "lob": "SUM: lob.utilized = \u03a3(facility_i.utilized) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Core Banking System",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "utilized_amt_usd",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Core Banking System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/utilized",
    "source_variant_identifier": "facility_utilized",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "utilized_amt_usd",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile to GL",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Utilized Exposure sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Core Banking System \u2192 facility.utilized = drawn balance from Core Banking \u2192 facility.utilized\nDependencies: utilized_amt_usd",
      "counterparty": "SUM: \u03a3(facility.utilized) WHERE counterparty_id = target \u2192 counterparty.utilized",
      "desk": "SUM: \u03a3(facility.utilized) WHERE desk_id = target \u2192 desk.utilized",
      "portfolio": "SUM: \u03a3(facility.utilized) WHERE portfolio_id = target \u2192 portfolio.utilized",
      "lob": "SUM: \u03a3(facility.utilized) WHERE lob_id = target \u2192 lob.utilized"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "UTIL_PCT",
    "variant_name": "Utilization Rate",
    "parent_metric_id": "UTIL_PCT",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Exposure / Committed \u00d7 100 \u2014 recalculated at each level",
    "detailed_description": "Utilization rate recalculated at each level from summed components. NOT averaged from sub-levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.util_pct = (facility.exposure / facility.committed) \u00d7 100\nIf committed = 0: util_pct = NULL",
      "counterparty": "RECALCULATED: counterparty.util_pct = (\u03a3 facility.exposure / \u03a3 facility.committed) \u00d7 100\nNOT avg of facility-level rates \u2014 use component sums",
      "desk": "RECALCULATED: desk.util_pct = (\u03a3 facility.exposure / \u03a3 facility.committed) \u00d7 100 FOR ALL facility IN desk",
      "portfolio": "RECALCULATED: portfolio.util_pct = (\u03a3 facility.exposure / \u03a3 facility.committed) \u00d7 100 FOR ALL facility IN portfolio",
      "lob": "RECALCULATED: lob.util_pct = (\u03a3 facility.exposure / \u03a3 facility.committed) \u00d7 100 FOR ALL facility IN LOB"
    },
    "weighting_basis": "BY_COMMITTED",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from components",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 at all levels \u2014 always recalculated from component sums",
    "calculation_authority_components": "Exposure (at level), Committed Amount (at level)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in analytics layer",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Ratio recalculated at every level from summed Exposure and Committed Amount",
    "sourcing_category": "flexible_level",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: facility.exposure / facility.committed \u00d7 100 \u2192 facility.util_pct\nDependencies: Exposure (facility), Committed Amount (facility)",
      "counterparty": "RECALCULATE: \u03a3(facility.exposure) / \u03a3(facility.committed) \u00d7 100 \u2192 counterparty.util_pct\nCRITICAL: Use component sums, not avg of rates",
      "desk": "RECALCULATE: \u03a3(fac.exposure) / \u03a3(fac.committed) \u00d7 100 \u2192 desk.util_pct",
      "portfolio": "RECALCULATE: \u03a3(fac.exposure) / \u03a3(fac.committed) \u00d7 100 \u2192 portfolio.util_pct",
      "lob": "RECALCULATE: \u03a3(fac.exposure) / \u03a3(fac.committed) \u00d7 100 \u2192 lob.util_pct"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "LIMIT",
    "variant_name": "Exposure Limit",
    "parent_metric_id": "LIMIT",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Approved credit limit per counterparty; summed at higher levels",
    "detailed_description": "Maximum approved credit exposure for the counterparty.",
    "rollup_logic": {
      "facility": "RAW SOURCE: counterparty.limit = approved limit from Limit Management System",
      "counterparty": "SUM: counterparty.limit = \u03a3(facility_i.limit) WHERE counterparty_id matches",
      "desk": "SUM: desk.limit = \u03a3(facility_i.limit) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.limit = \u03a3(facility_i.limit) WHERE portfolio_id matches",
      "lob": "SUM: lob.limit = \u03a3(facility_i.limit) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Limit Management System",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "limit_amount_usd",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Limit Management System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/limits",
    "source_variant_identifier": "cpty_limit",
    "source_payload_spec": [
      {
        "field_name": "counterparty_id",
        "required": true
      },
      {
        "field_name": "limit_amount_usd",
        "required": true
      },
      {
        "field_name": "limit_type",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify limit currency and type",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Exposure Limit sourced at facility; summed additively at all levels",
    "sourcing_category": "obligor",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Limit Management System \u2192 counterparty.limit = approved limit from Limit Management System \u2192 facility.limit\nDependencies: limit_amount_usd",
      "counterparty": "SUM: \u03a3(facility.limit) WHERE counterparty_id = target \u2192 counterparty.limit",
      "desk": "SUM: \u03a3(facility.limit) WHERE desk_id = target \u2192 desk.limit",
      "portfolio": "SUM: \u03a3(facility.limit) WHERE portfolio_id = target \u2192 portfolio.limit",
      "lob": "SUM: \u03a3(facility.limit) WHERE lob_id = target \u2192 lob.limit"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "CROSS_ENTITY_EXP",
    "variant_name": "Cross-Entity Exposure",
    "parent_metric_id": "CROSS_ENTITY_EXP",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(exposure) WHERE cross_entity_flag = 1; summed at higher levels",
    "detailed_description": "Total exposure allocated across legal entities.",
    "rollup_logic": {
      "facility": "CALCULATED: counterparty.cross_entity_exp = SUM(exposure WHERE cross_entity_flag=1)",
      "counterparty": "SUM: counterparty.cross_entity_exp = \u03a3(facility_i.cross_entity_exp) WHERE counterparty_id matches",
      "desk": "SUM: desk.cross_entity_exp = \u03a3(facility_i.cross_entity_exp) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.cross_entity_exp = \u03a3(facility_i.cross_entity_exp) WHERE portfolio_id matches",
      "lob": "SUM: lob.cross_entity_exp = \u03a3(facility_i.cross_entity_exp) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "exposure, cross_entity_flag",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Cross-Entity Exposure sourced at facility; summed additively at all levels",
    "sourcing_category": "obligor",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "CALCULATE: Calculated \u2192 counterparty.cross_entity_exp = SUM(exposure WHERE cross_entity_flag=1) \u2192 facility.cross_entity_exp\nDependencies: exposure, cross_entity_flag",
      "counterparty": "SUM: \u03a3(facility.cross_entity_exp) WHERE counterparty_id = target \u2192 counterparty.cross_entity_exp",
      "desk": "SUM: \u03a3(facility.cross_entity_exp) WHERE desk_id = target \u2192 desk.cross_entity_exp",
      "portfolio": "SUM: \u03a3(facility.cross_entity_exp) WHERE portfolio_id = target \u2192 portfolio.cross_entity_exp",
      "lob": "SUM: \u03a3(facility.cross_entity_exp) WHERE lob_id = target \u2192 lob.cross_entity_exp"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "GROSS_EXP",
    "variant_name": "Gross Exposure",
    "parent_metric_id": "GROSS_EXP",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Total exposure before CRM; summed at all levels",
    "detailed_description": "Gross facility exposure before credit risk mitigation.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.gross_exp = pre-CRM exposure from Exposure System",
      "counterparty": "SUM: counterparty.gross_exp = \u03a3(facility_i.gross_exp) WHERE counterparty_id matches",
      "desk": "SUM: desk.gross_exp = \u03a3(facility_i.gross_exp) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.gross_exp = \u03a3(facility_i.gross_exp) WHERE portfolio_id matches",
      "lob": "SUM: lob.gross_exp = \u03a3(facility_i.gross_exp) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Exposure Management System",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "gross_exposure_usd",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Exposure Management System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/gross_exp",
    "source_variant_identifier": "gross_exp",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "gross_exposure_usd",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile to position system",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Gross Exposure sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Exposure Management System \u2192 facility.gross_exp = pre-CRM exposure from Exposure System \u2192 facility.gross_exp\nDependencies: gross_exposure_usd",
      "counterparty": "SUM: \u03a3(facility.gross_exp) WHERE counterparty_id = target \u2192 counterparty.gross_exp",
      "desk": "SUM: \u03a3(facility.gross_exp) WHERE desk_id = target \u2192 desk.gross_exp",
      "portfolio": "SUM: \u03a3(facility.gross_exp) WHERE portfolio_id = target \u2192 portfolio.gross_exp",
      "lob": "SUM: \u03a3(facility.gross_exp) WHERE lob_id = target \u2192 lob.gross_exp"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "NET_EXP",
    "variant_name": "Net Exposure",
    "parent_metric_id": "NET_EXP",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Gross Exposure - CRM Amount; summed at all levels",
    "detailed_description": "Net exposure after credit risk mitigation.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.net_exp = facility.gross_exp - facility.crm_amount",
      "counterparty": "SUM: counterparty.net_exp = \u03a3(facility_i.net_exp) WHERE counterparty_id matches",
      "desk": "SUM: desk.net_exp = \u03a3(facility_i.net_exp) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.net_exp = \u03a3(facility_i.net_exp) WHERE portfolio_id matches",
      "lob": "SUM: lob.net_exp = \u03a3(facility_i.net_exp) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "gross_exp (facility), crm_amount (facility)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Net Exposure sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "CALCULATE: Calculated \u2192 facility.net_exp = facility.gross_exp - facility.crm_amount \u2192 facility.net_exp\nDependencies: gross_exp (facility), crm_amount (facility)",
      "counterparty": "SUM: \u03a3(facility.net_exp) WHERE counterparty_id = target \u2192 counterparty.net_exp",
      "desk": "SUM: \u03a3(facility.net_exp) WHERE desk_id = target \u2192 desk.net_exp",
      "portfolio": "SUM: \u03a3(facility.net_exp) WHERE portfolio_id = target \u2192 portfolio.net_exp",
      "lob": "SUM: \u03a3(facility.net_exp) WHERE lob_id = target \u2192 lob.net_exp"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "DSCR",
    "variant_name": "DSCR",
    "parent_metric_id": "DSCR",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Cashflow / Total Debt Service at facility; exposure-weighted avg at higher levels",
    "detailed_description": "Measures borrower ability to service debt. Calculated at facility from spreading. Exposure-weighted average at aggregation levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.dscr = facility.cashflow / facility.total_debt_service",
      "counterparty": "WEIGHTED AVG: counterparty.dscr = \u03a3(facility_i.dscr \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.dscr = \u03a3(facility_i.dscr \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.dscr = \u03a3(facility_i.dscr \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.dscr = \u03a3(facility_i.dscr \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EAD",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Financial Spreading System",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "cashflow, total_debt_service",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Financial Spreading System",
    "source_integration_pattern": "PULL",
    "source_delivery_method": "API",
    "source_endpoint_or_feed": "/api/v1/dscr",
    "source_variant_identifier": "facility_dscr",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "cashflow",
        "required": true
      },
      {
        "field_name": "debt_service",
        "required": true
      },
      {
        "field_name": "dscr",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Confirm NOI and debt service alignment",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "DSCR calculated at facility; BY_EAD weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Financial Spreading System \u2192 {cashflow, tds} \u2192 cashflow/tds \u2192 facility.dscr\nDependencies: CASHFLOW (facility), TDS (facility)\nValidation: dscr > 0 unless no debt service",
      "counterparty": "AGGREGATE: {facility.dscr, facility.ead} \u2192 \u03a3(dscr\u00d7ead)/\u03a3(ead) \u2192 counterparty.dscr\nDependencies: DSCR (facility) + EAD (facility)",
      "desk": "AGGREGATE: {facility.dscr, facility.ead} \u2192 \u03a3(dscr\u00d7ead)/\u03a3(ead) \u2192 desk.dscr",
      "portfolio": "AGGREGATE: {facility.dscr, facility.ead} \u2192 \u03a3(dscr\u00d7ead)/\u03a3(ead) \u2192 portfolio.dscr",
      "lob": "AGGREGATE: {facility.dscr, facility.ead} \u2192 \u03a3(dscr\u00d7ead)/\u03a3(ead) \u2192 lob.dscr"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "DSCR_BELOW1_PCT",
    "variant_name": "DSCR % Below 1.0x (Portfolio KPI)",
    "parent_metric_id": "DSCR",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count(facility WHERE DSCR < 1.0) / Total_Count \u00d7 100",
    "detailed_description": "Portfolio-level KPI: percentage of facilities with insufficient debt service coverage. Risk appetite threshold metric. Only meaningful at desk/portfolio/LOB level.",
    "rollup_logic": {
      "facility": "INPUT: facility.dscr provides raw flag (dscr < 1.0 \u2192 breach = 1)",
      "counterparty": "INPUT: Counterparty provides context but KPI is portfolio-level",
      "desk": "CALCULATED: desk.dscr_below1_pct = COUNT(facility WHERE dscr < 1.0) / COUNT(all facility) \u00d7 100 IN desk\nAlternative: \u03a3(exposure WHERE dscr<1) / \u03a3(total exposure) \u00d7 100 for exposure-weighted",
      "portfolio": "CALCULATED: portfolio.dscr_below1_pct = COUNT(fac WHERE dscr<1) / COUNT(all fac) \u00d7 100 IN portfolio",
      "lob": "CALCULATED: lob.dscr_below1_pct = COUNT(fac WHERE dscr<1) / COUNT(all fac) \u00d7 100 IN LOB"
    },
    "weighting_basis": "COUNT_BASED",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from DSCR",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 portfolio KPI derived from facility DSCR",
    "calculation_authority_components": "DSCR (facility), facility_count, exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in analytics layer",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Portfolio KPI; only meaningful at aggregated levels",
    "sourcing_category": "flexible_level",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "INPUT: DSCR (facility) \u2192 flag: 1 if dscr < 1.0",
      "counterparty": "CONTEXT: Counterparty DSCR provides building block",
      "desk": "CALCULATE: COUNT(fac WHERE dscr<1) / COUNT(all fac) \u00d7 100 \u2192 desk.dscr_below1_pct\nDependencies: DSCR (all facilities in desk)",
      "portfolio": "CALCULATE: COUNT(fac WHERE dscr<1) / COUNT(all fac) \u00d7 100 \u2192 portfolio.dscr_below1_pct",
      "lob": "CALCULATE: COUNT(fac WHERE dscr<1) / COUNT(all fac) \u00d7 100 \u2192 lob.dscr_below1_pct"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "LTV",
    "variant_name": "LTV",
    "parent_metric_id": "LTV",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Exposure / Collateral Value \u00d7 100 at facility; exposure-weighted avg at higher levels",
    "detailed_description": "Loan-to-value ratio. Leverage KPI measuring collateral coverage.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.ltv = (facility.exposure / facility.collateral_value) \u00d7 100",
      "counterparty": "WEIGHTED AVG: counterparty.ltv = \u03a3(facility_i.ltv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.ltv = \u03a3(facility_i.ltv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.ltv = \u03a3(facility_i.ltv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.ltv = \u03a3(facility_i.ltv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated (Exposure + Collateral)",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "exposure, collateral_value",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "LTV calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: {exposure, collateral_value} \u2192 exposure/collateral \u00d7 100 \u2192 facility.ltv\nDependencies: EXPOSURE (facility), COLLATERAL (facility)\nValidation: ltv > 0; if no collateral, ltv = uncollateralized flag",
      "counterparty": "AGGREGATE: {facility.ltv, facility.exposure} \u2192 \u03a3(ltv\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.ltv\nDependencies: LTV (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.ltv, facility.exposure} \u2192 \u03a3(ltv\u00d7exposure)/\u03a3(exposure) \u2192 desk.ltv",
      "portfolio": "AGGREGATE: {facility.ltv, facility.exposure} \u2192 \u03a3(ltv\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.ltv",
      "lob": "AGGREGATE: {facility.ltv, facility.exposure} \u2192 \u03a3(ltv\u00d7exposure)/\u03a3(exposure) \u2192 lob.ltv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "ROE",
    "variant_name": "ROE",
    "parent_metric_id": "ROE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(facility.net_income / facility.equity) \u00d7 100 at facility; exposure-weighted avg at higher levels",
    "detailed_description": "ROE calculated at facility level. Exposure-weighted average at aggregation levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.roe = (facility.net_income / facility.equity) \u00d7 100",
      "counterparty": "WEIGHTED AVG: counterparty.roe = \u03a3(facility_i.roe \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.roe = \u03a3(facility_i.roe \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.roe = \u03a3(facility_i.roe \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.roe = \u03a3(facility_i.roe \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from components",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "net_income, equity",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "ROE calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Components \u2192 (facility.net_income / facility.equity) \u00d7 100 \u2192 facility.roe\nDependencies: net_income, equity",
      "counterparty": "AGGREGATE: {facility.roe, facility.exposure} \u2192 \u03a3(roe\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.roe\nDependencies: ROE (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.roe, facility.exposure} \u2192 \u03a3(roe\u00d7exposure)/\u03a3(exposure) \u2192 desk.roe",
      "portfolio": "AGGREGATE: {facility.roe, facility.exposure} \u2192 \u03a3(roe\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.roe",
      "lob": "AGGREGATE: {facility.roe, facility.exposure} \u2192 \u03a3(roe\u00d7exposure)/\u03a3(exposure) \u2192 lob.roe"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "ROA",
    "variant_name": "ROA",
    "parent_metric_id": "ROA",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(facility.net_income / facility.total_assets) \u00d7 100 at facility; exposure-weighted avg at higher levels",
    "detailed_description": "ROA calculated at facility level. Exposure-weighted average at aggregation levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.roa = (facility.net_income / facility.total_assets) \u00d7 100",
      "counterparty": "WEIGHTED AVG: counterparty.roa = \u03a3(facility_i.roa \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.roa = \u03a3(facility_i.roa \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.roa = \u03a3(facility_i.roa \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.roa = \u03a3(facility_i.roa \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from components",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "net_income, total_assets",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "ROA calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Components \u2192 (facility.net_income / facility.total_assets) \u00d7 100 \u2192 facility.roa\nDependencies: net_income, total_assets",
      "counterparty": "AGGREGATE: {facility.roa, facility.exposure} \u2192 \u03a3(roa\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.roa\nDependencies: ROA (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.roa, facility.exposure} \u2192 \u03a3(roa\u00d7exposure)/\u03a3(exposure) \u2192 desk.roa",
      "portfolio": "AGGREGATE: {facility.roa, facility.exposure} \u2192 \u03a3(roa\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.roa",
      "lob": "AGGREGATE: {facility.roa, facility.exposure} \u2192 \u03a3(roa\u00d7exposure)/\u03a3(exposure) \u2192 lob.roa"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "NIM",
    "variant_name": "NIM",
    "parent_metric_id": "NIM",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(facility.nii / facility.earning_assets) \u00d7 100 at facility; exposure-weighted avg at higher levels",
    "detailed_description": "NIM calculated at facility level. Exposure-weighted average at aggregation levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.nim = (facility.nii / facility.earning_assets) \u00d7 100",
      "counterparty": "WEIGHTED AVG: counterparty.nim = \u03a3(facility_i.nim \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.nim = \u03a3(facility_i.nim \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.nim = \u03a3(facility_i.nim \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.nim = \u03a3(facility_i.nim \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from components",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "nii, earning_assets",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "NIM calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Components \u2192 (facility.nii / facility.earning_assets) \u00d7 100 \u2192 facility.nim\nDependencies: nii, earning_assets",
      "counterparty": "AGGREGATE: {facility.nim, facility.exposure} \u2192 \u03a3(nim\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.nim\nDependencies: NIM (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.nim, facility.exposure} \u2192 \u03a3(nim\u00d7exposure)/\u03a3(exposure) \u2192 desk.nim",
      "portfolio": "AGGREGATE: {facility.nim, facility.exposure} \u2192 \u03a3(nim\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.nim",
      "lob": "AGGREGATE: {facility.nim, facility.exposure} \u2192 \u03a3(nim\u00d7exposure)/\u03a3(exposure) \u2192 lob.nim"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "ALL_IN_RATE",
    "variant_name": "All-in Rate",
    "parent_metric_id": "ALL_IN_RATE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "facility.base_rate + facility.spread at facility; exposure-weighted avg at higher levels",
    "detailed_description": "All-in Rate calculated at facility level. Exposure-weighted average at aggregation levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.all_in_rate = facility.base_rate + facility.spread",
      "counterparty": "WEIGHTED AVG: counterparty.all_in_rate = \u03a3(facility_i.all_in_rate \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.all_in_rate = \u03a3(facility_i.all_in_rate \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.all_in_rate = \u03a3(facility_i.all_in_rate \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.all_in_rate = \u03a3(facility_i.all_in_rate \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from components",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "base_rate, spread",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "All-in Rate calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Components \u2192 facility.base_rate + facility.spread \u2192 facility.all_in_rate\nDependencies: base_rate, spread",
      "counterparty": "AGGREGATE: {facility.all_in_rate, facility.exposure} \u2192 \u03a3(all_in_rate\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.all_in_rate\nDependencies: All-in Rate (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.all_in_rate, facility.exposure} \u2192 \u03a3(all_in_rate\u00d7exposure)/\u03a3(exposure) \u2192 desk.all_in_rate",
      "portfolio": "AGGREGATE: {facility.all_in_rate, facility.exposure} \u2192 \u03a3(all_in_rate\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.all_in_rate",
      "lob": "AGGREGATE: {facility.all_in_rate, facility.exposure} \u2192 \u03a3(all_in_rate\u00d7exposure)/\u03a3(exposure) \u2192 lob.all_in_rate"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "SPREAD",
    "variant_name": "Credit Spread",
    "parent_metric_id": "SPREAD",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sourced at facility; exposure-weighted average at higher levels",
    "detailed_description": "Facility-level credit spread sourced from booking system. Exposure-weighted average at aggregation levels.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.spread from Core Banking",
      "counterparty": "WEIGHTED AVG: counterparty.spread = \u03a3(facility_i.spread \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.spread = \u03a3(facility_i.spread \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.spread = same weighted average formula at portfolio",
      "lob": "WEIGHTED AVG: lob.spread = same weighted average formula at LOB"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Core Banking",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility (sourced); T3 at higher levels (weighted aggregation)",
    "calculation_authority_components": "spread, exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Core Banking",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/spread",
    "source_variant_identifier": "facility_spread",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "spread_pct",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify rate type and currency",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Credit Spread sourced at facility; weighted avg at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Core Banking \u2192 /feeds/spread \u2192 facility.spread",
      "counterparty": "AGGREGATE: \u03a3(spread\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.spread",
      "desk": "AGGREGATE: \u03a3(spread\u00d7exposure)/\u03a3(exposure) \u2192 desk.spread",
      "portfolio": "AGGREGATE: \u03a3(spread\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.spread",
      "lob": "AGGREGATE: \u03a3(spread\u00d7exposure)/\u03a3(exposure) \u2192 lob.spread"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "BASE_RATE",
    "variant_name": "Base Rate",
    "parent_metric_id": "BASE_RATE",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sourced at facility; exposure-weighted average at higher levels",
    "detailed_description": "Facility-level base rate sourced from booking system. Exposure-weighted average at aggregation levels.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.base_rate from Core Banking",
      "counterparty": "WEIGHTED AVG: counterparty.base_rate = \u03a3(facility_i.base_rate \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.base_rate = \u03a3(facility_i.base_rate \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.base_rate = same weighted average formula at portfolio",
      "lob": "WEIGHTED AVG: lob.base_rate = same weighted average formula at LOB"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Core Banking",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility (sourced); T3 at higher levels (weighted aggregation)",
    "calculation_authority_components": "base_rate, exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Core Banking",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/base_rate",
    "source_variant_identifier": "facility_base_rate",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "base_rate_pct",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify rate type and currency",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Base Rate sourced at facility; weighted avg at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Core Banking \u2192 /feeds/base_rate \u2192 facility.base_rate",
      "counterparty": "AGGREGATE: \u03a3(base_rate\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.base_rate",
      "desk": "AGGREGATE: \u03a3(base_rate\u00d7exposure)/\u03a3(exposure) \u2192 desk.base_rate",
      "portfolio": "AGGREGATE: \u03a3(base_rate\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.base_rate",
      "lob": "AGGREGATE: \u03a3(base_rate\u00d7exposure)/\u03a3(exposure) \u2192 lob.base_rate"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "FEE_RATE",
    "variant_name": "Fee Rate",
    "parent_metric_id": "FEE_RATE",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sourced at facility; committed-weighted average at higher levels",
    "detailed_description": "Facility-level fee rate sourced from booking system. Exposure-weighted average at aggregation levels.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.fee_rate from Core Banking",
      "counterparty": "WEIGHTED AVG: counterparty.fee_rate = \u03a3(facility_i.fee_rate \u00d7 facility_i.committed) / \u03a3(facility_i.committed) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.fee_rate = \u03a3(facility_i.fee_rate \u00d7 facility_i.committed) / \u03a3(facility_i.committed) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.fee_rate = same weighted average formula at portfolio",
      "lob": "WEIGHTED AVG: lob.fee_rate = same weighted average formula at LOB"
    },
    "weighting_basis": "BY_COMMITTED",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Core Banking",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility (sourced); T3 at higher levels (weighted aggregation)",
    "calculation_authority_components": "fee_rate, committed",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Core Banking",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/fee_rate",
    "source_variant_identifier": "facility_fee",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "fee_rate_pct",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify rate type and currency",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Fee Rate sourced at facility; weighted avg at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Core Banking \u2192 /feeds/fee_rate \u2192 facility.fee_rate",
      "counterparty": "AGGREGATE: \u03a3(fee_rate\u00d7committed)/\u03a3(committed) \u2192 counterparty.fee_rate",
      "desk": "AGGREGATE: \u03a3(fee_rate\u00d7committed)/\u03a3(committed) \u2192 desk.fee_rate",
      "portfolio": "AGGREGATE: \u03a3(fee_rate\u00d7committed)/\u03a3(committed) \u2192 portfolio.fee_rate",
      "lob": "AGGREGATE: \u03a3(fee_rate\u00d7committed)/\u03a3(committed) \u2192 lob.fee_rate"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "REVENUE",
    "variant_name": "Revenue",
    "parent_metric_id": "REVENUE",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sourced revenue at facility; summed at all levels",
    "detailed_description": "Facility-level revenue. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.revenue sourced from Financial Spreading / GL",
      "counterparty": "SUM: counterparty.revenue = \u03a3(facility_i.revenue) WHERE counterparty_id matches",
      "desk": "SUM: desk.revenue = \u03a3(facility_i.revenue) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.revenue = \u03a3(facility_i.revenue) WHERE portfolio_id matches",
      "lob": "SUM: lob.revenue = \u03a3(facility_i.revenue) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Financial Spreading / GL",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "revenue_amt",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Financial Spreading / GL",
    "source_integration_pattern": "PULL",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/revenue",
    "source_variant_identifier": "facility_revenue",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "revenue_amt",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile Revenue to source",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Revenue sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Financial Spreading / GL \u2192 facility.revenue sourced from Financial Spreading / GL \u2192 facility.revenue\nDependencies: revenue_amt",
      "counterparty": "SUM: \u03a3(facility.revenue) WHERE counterparty_id = target \u2192 counterparty.revenue",
      "desk": "SUM: \u03a3(facility.revenue) WHERE desk_id = target \u2192 desk.revenue",
      "portfolio": "SUM: \u03a3(facility.revenue) WHERE portfolio_id = target \u2192 portfolio.revenue",
      "lob": "SUM: \u03a3(facility.revenue) WHERE lob_id = target \u2192 lob.revenue"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "NET_INCOME",
    "variant_name": "Net Income",
    "parent_metric_id": "NET_INCOME",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sourced net income at facility; summed at all levels",
    "detailed_description": "Facility-level net income. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.net_income sourced from Financial Spreading / GL",
      "counterparty": "SUM: counterparty.net_income = \u03a3(facility_i.net_income) WHERE counterparty_id matches",
      "desk": "SUM: desk.net_income = \u03a3(facility_i.net_income) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.net_income = \u03a3(facility_i.net_income) WHERE portfolio_id matches",
      "lob": "SUM: lob.net_income = \u03a3(facility_i.net_income) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Financial Spreading / GL",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "net_income_amt",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Financial Spreading / GL",
    "source_integration_pattern": "PULL",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/net_income",
    "source_variant_identifier": "facility_net_income",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "net_income_amt",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile Net Income to source",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Net Income sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Financial Spreading / GL \u2192 facility.net_income sourced from Financial Spreading / GL \u2192 facility.net_income\nDependencies: net_income_amt",
      "counterparty": "SUM: \u03a3(facility.net_income) WHERE counterparty_id = target \u2192 counterparty.net_income",
      "desk": "SUM: \u03a3(facility.net_income) WHERE desk_id = target \u2192 desk.net_income",
      "portfolio": "SUM: \u03a3(facility.net_income) WHERE portfolio_id = target \u2192 portfolio.net_income",
      "lob": "SUM: \u03a3(facility.net_income) WHERE lob_id = target \u2192 lob.net_income"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "CASHFLOW",
    "variant_name": "Operating Cashflow",
    "parent_metric_id": "CASHFLOW",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sourced operating cashflow at facility; summed at all levels",
    "detailed_description": "Facility-level operating cashflow. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.cashflow sourced from Financial Spreading",
      "counterparty": "SUM: counterparty.cashflow = \u03a3(facility_i.cashflow) WHERE counterparty_id matches",
      "desk": "SUM: desk.cashflow = \u03a3(facility_i.cashflow) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.cashflow = \u03a3(facility_i.cashflow) WHERE portfolio_id matches",
      "lob": "SUM: lob.cashflow = \u03a3(facility_i.cashflow) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Financial Spreading",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "cashflow_amt",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Financial Spreading",
    "source_integration_pattern": "PULL",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/cashflow",
    "source_variant_identifier": "facility_cashflow",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "cashflow_amt",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile Operating Cashflow to source",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Operating Cashflow sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Financial Spreading \u2192 facility.cashflow sourced from Financial Spreading \u2192 facility.cashflow\nDependencies: cashflow_amt",
      "counterparty": "SUM: \u03a3(facility.cashflow) WHERE counterparty_id = target \u2192 counterparty.cashflow",
      "desk": "SUM: \u03a3(facility.cashflow) WHERE desk_id = target \u2192 desk.cashflow",
      "portfolio": "SUM: \u03a3(facility.cashflow) WHERE portfolio_id = target \u2192 portfolio.cashflow",
      "lob": "SUM: \u03a3(facility.cashflow) WHERE lob_id = target \u2192 lob.cashflow"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "TDS",
    "variant_name": "Total Debt Service",
    "parent_metric_id": "TDS",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sourced total debt service at facility; summed at all levels",
    "detailed_description": "Facility-level total debt service. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.tds sourced from Loan Servicing / Spreading",
      "counterparty": "SUM: counterparty.tds = \u03a3(facility_i.tds) WHERE counterparty_id matches",
      "desk": "SUM: desk.tds = \u03a3(facility_i.tds) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.tds = \u03a3(facility_i.tds) WHERE portfolio_id matches",
      "lob": "SUM: lob.tds = \u03a3(facility_i.tds) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Loan Servicing / Spreading",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "tds_amt",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Loan Servicing / Spreading",
    "source_integration_pattern": "PULL",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/tds",
    "source_variant_identifier": "facility_tds",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "tds_amt",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile Total Debt Service to source",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Total Debt Service sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Loan Servicing / Spreading \u2192 facility.tds sourced from Loan Servicing / Spreading \u2192 facility.tds\nDependencies: tds_amt",
      "counterparty": "SUM: \u03a3(facility.tds) WHERE counterparty_id = target \u2192 counterparty.tds",
      "desk": "SUM: \u03a3(facility.tds) WHERE desk_id = target \u2192 desk.tds",
      "portfolio": "SUM: \u03a3(facility.tds) WHERE portfolio_id = target \u2192 portfolio.tds",
      "lob": "SUM: \u03a3(facility.tds) WHERE lob_id = target \u2192 lob.tds"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "COST_OF_FUNDS",
    "variant_name": "Cost of Funds",
    "parent_metric_id": "COST_OF_FUNDS",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sourced cost of funds at facility; summed at all levels",
    "detailed_description": "Facility-level cost of funds. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.cost_of_funds sourced from FTP / Treasury",
      "counterparty": "SUM: counterparty.cost_of_funds = \u03a3(facility_i.cost_of_funds) WHERE counterparty_id matches",
      "desk": "SUM: desk.cost_of_funds = \u03a3(facility_i.cost_of_funds) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.cost_of_funds = \u03a3(facility_i.cost_of_funds) WHERE portfolio_id matches",
      "lob": "SUM: lob.cost_of_funds = \u03a3(facility_i.cost_of_funds) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "FTP / Treasury",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "cost_of_funds_amt",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "FTP / Treasury",
    "source_integration_pattern": "PULL",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/cost_of_funds",
    "source_variant_identifier": "facility_cost_of_funds",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "cost_of_funds_amt",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile Cost of Funds to source",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Cost of Funds sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: FTP / Treasury \u2192 facility.cost_of_funds sourced from FTP / Treasury \u2192 facility.cost_of_funds\nDependencies: cost_of_funds_amt",
      "counterparty": "SUM: \u03a3(facility.cost_of_funds) WHERE counterparty_id = target \u2192 counterparty.cost_of_funds",
      "desk": "SUM: \u03a3(facility.cost_of_funds) WHERE desk_id = target \u2192 desk.cost_of_funds",
      "portfolio": "SUM: \u03a3(facility.cost_of_funds) WHERE portfolio_id = target \u2192 portfolio.cost_of_funds",
      "lob": "SUM: \u03a3(facility.cost_of_funds) WHERE lob_id = target \u2192 lob.cost_of_funds"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "OP_COST",
    "variant_name": "Operating Cost",
    "parent_metric_id": "OP_COST",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Sourced operating cost at facility; summed at all levels",
    "detailed_description": "Facility-level operating cost. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.op_cost sourced from Cost Allocation System",
      "counterparty": "SUM: counterparty.op_cost = \u03a3(facility_i.op_cost) WHERE counterparty_id matches",
      "desk": "SUM: desk.op_cost = \u03a3(facility_i.op_cost) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.op_cost = \u03a3(facility_i.op_cost) WHERE portfolio_id matches",
      "lob": "SUM: lob.op_cost = \u03a3(facility_i.op_cost) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Cost Allocation System",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "op_cost_amt",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Cost Allocation System",
    "source_integration_pattern": "PULL",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/op_cost",
    "source_variant_identifier": "facility_op_cost",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "op_cost_amt",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile Operating Cost to source",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Operating Cost sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Cost Allocation System \u2192 facility.op_cost sourced from Cost Allocation System \u2192 facility.op_cost\nDependencies: op_cost_amt",
      "counterparty": "SUM: \u03a3(facility.op_cost) WHERE counterparty_id = target \u2192 counterparty.op_cost",
      "desk": "SUM: \u03a3(facility.op_cost) WHERE desk_id = target \u2192 desk.op_cost",
      "portfolio": "SUM: \u03a3(facility.op_cost) WHERE portfolio_id = target \u2192 portfolio.op_cost",
      "lob": "SUM: \u03a3(facility.op_cost) WHERE lob_id = target \u2192 lob.op_cost"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "CAP_ALLOC",
    "variant_name": "Capital Allocated",
    "parent_metric_id": "CAP_ALLOC",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "RWA \u00d7 Capital Ratio at facility; summed at all levels",
    "detailed_description": "Economic or regulatory capital assigned to exposure.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.cap_alloc = facility.rwa \u00d7 target_capital_ratio",
      "counterparty": "SUM: counterparty.cap_alloc = \u03a3(facility_i.cap_alloc) WHERE counterparty_id matches",
      "desk": "SUM: desk.cap_alloc = \u03a3(facility_i.cap_alloc) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.cap_alloc = \u03a3(facility_i.cap_alloc) WHERE portfolio_id matches",
      "lob": "SUM: lob.cap_alloc = \u03a3(facility_i.cap_alloc) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Capital Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "rwa (facility), target_capital_ratio",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Capital Management System",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Capital Allocated sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Capital Engine \u2192 facility.cap_alloc = facility.rwa \u00d7 target_capital_ratio \u2192 facility.cap_alloc\nDependencies: rwa (facility), target_capital_ratio",
      "counterparty": "SUM: \u03a3(facility.cap_alloc) WHERE counterparty_id = target \u2192 counterparty.cap_alloc",
      "desk": "SUM: \u03a3(facility.cap_alloc) WHERE desk_id = target \u2192 desk.cap_alloc",
      "portfolio": "SUM: \u03a3(facility.cap_alloc) WHERE portfolio_id = target \u2192 portfolio.cap_alloc",
      "lob": "SUM: \u03a3(facility.cap_alloc) WHERE lob_id = target \u2192 lob.cap_alloc"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "COLLATERAL",
    "variant_name": "Collateral Value",
    "parent_metric_id": "COLLATERAL",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Appraised/MtM collateral value; summed at all levels",
    "detailed_description": "Value of pledged collateral securing exposure.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.collateral = appraised or mark-to-market value",
      "counterparty": "SUM: counterparty.collateral = \u03a3(facility_i.collateral) WHERE counterparty_id matches",
      "desk": "SUM: desk.collateral = \u03a3(facility_i.collateral) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.collateral = \u03a3(facility_i.collateral) WHERE portfolio_id matches",
      "lob": "SUM: lob.collateral = \u03a3(facility_i.collateral) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Collateral Management System",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "collateral_value_usd",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Collateral Management System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/collateral",
    "source_variant_identifier": "facility_collateral",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "collateral_value_usd",
        "required": true
      },
      {
        "field_name": "valuation_date",
        "required": true
      },
      {
        "field_name": "collateral_type",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify appraisal date and currency",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Collateral Value sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Collateral Management System \u2192 facility.collateral = appraised or mark-to-market value \u2192 facility.collateral\nDependencies: collateral_value_usd",
      "counterparty": "SUM: \u03a3(facility.collateral) WHERE counterparty_id = target \u2192 counterparty.collateral",
      "desk": "SUM: \u03a3(facility.collateral) WHERE desk_id = target \u2192 desk.collateral",
      "portfolio": "SUM: \u03a3(facility.collateral) WHERE portfolio_id = target \u2192 portfolio.collateral",
      "lob": "SUM: \u03a3(facility.collateral) WHERE lob_id = target \u2192 lob.collateral"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "CRM_AMOUNT",
    "variant_name": "Risk Mitigant Amount",
    "parent_metric_id": "CRM_AMOUNT",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(eligible_mitigant_value) at facility; summed at all levels",
    "detailed_description": "Total eligible credit risk mitigation value.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.crm_amount = SUM(eligible_mitigant_value) per facility",
      "counterparty": "SUM: counterparty.crm_amount = \u03a3(facility_i.crm_amount) WHERE counterparty_id matches",
      "desk": "SUM: desk.crm_amount = \u03a3(facility_i.crm_amount) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.crm_amount = \u03a3(facility_i.crm_amount) WHERE portfolio_id matches",
      "lob": "SUM: lob.crm_amount = \u03a3(facility_i.crm_amount) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Collateral Management System",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "mitigant_value, mitigant_type, eligibility_flag",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Collateral Management System",
    "source_integration_pattern": "PULL",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/api/v1/crm",
    "source_variant_identifier": "facility_crm",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "mitigant_value",
        "required": true
      },
      {
        "field_name": "mitigant_type",
        "required": true
      },
      {
        "field_name": "eligible_flag",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify eligibility per Basel CRM",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Risk Mitigant Amount sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "CALCULATE: Collateral Management System \u2192 facility.crm_amount = SUM(eligible_mitigant_value) per facility \u2192 facility.crm_amount\nDependencies: mitigant_value, mitigant_type, eligibility_flag",
      "counterparty": "SUM: \u03a3(facility.crm_amount) WHERE counterparty_id = target \u2192 counterparty.crm_amount",
      "desk": "SUM: \u03a3(facility.crm_amount) WHERE desk_id = target \u2192 desk.crm_amount",
      "portfolio": "SUM: \u03a3(facility.crm_amount) WHERE portfolio_id = target \u2192 portfolio.crm_amount",
      "lob": "SUM: \u03a3(facility.crm_amount) WHERE lob_id = target \u2192 lob.crm_amount"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "CRM_TYPE",
    "variant_name": "Risk Mitigant Type",
    "parent_metric_id": "CRM_TYPE",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Dominant CRM type at facility; distribution at higher levels",
    "detailed_description": "Primary type of credit risk mitigation. Distribution of types (Financial Collateral, Real Estate, Guarantee, etc.) at aggregated levels.",
    "rollup_logic": {
      "facility": "RAW: facility.crm_type sourced at facility",
      "counterparty": "RAW SOURCE: facility.crm_type = ARGMAX(mitigant_type, mitigant_value)",
      "desk": "DISTRIBUTION: desk.crm_type_dist = {bucket: COUNT(cpty WHERE crm_type=bucket) / total, ...} OR exposure-weighted distribution",
      "portfolio": "DISTRIBUTION: portfolio.crm_type_dist = distribution of crm_type across portfolio",
      "lob": "DISTRIBUTION: lob.crm_type_dist = distribution of crm_type across LOB"
    },
    "weighting_basis": "DISTRIBUTION",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Collateral Management System",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility (sourced); T2 at facility (inherited); T3 at desk/portfolio/LOB (distribution aggregation)",
    "calculation_authority_components": "crm_type, counterparty_id",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Collateral Management System",
    "source_integration_pattern": "PULL",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/api/v1/crm_type",
    "source_variant_identifier": "facility_crm_type",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "mitigant_type",
        "required": true
      },
      {
        "field_name": "mitigant_subtype",
        "required": true
      },
      {
        "field_name": "mitigant_value",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Validate type taxonomy",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Sourced at facility; distributed at aggregation levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Collateral System \u2192 mitigant records \u2192 dominant type \u2192 facility.crm_type",
      "counterparty": "SOURCE: Collateral Management System \u2192 facility.crm_type = ARGMAX(mitigant_type, mitigant_value) \u2192 counterparty.crm_type",
      "desk": "DISTRIBUTE: Group counterparties by crm_type bucket \u2192 count/% per bucket \u2192 desk.crm_type_distribution",
      "portfolio": "DISTRIBUTE: Group by crm_type bucket \u2192 portfolio.crm_type_distribution",
      "lob": "DISTRIBUTE: Group by crm_type bucket \u2192 lob.crm_type_distribution"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "COLLATERAL_COV",
    "variant_name": "Collateral Coverage",
    "parent_metric_id": "COLLATERAL_COV",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Collateral / Exposure) \u00d7 100 \u2014 recalculated at each level",
    "detailed_description": "Collateral coverage ratio. Recalculated from summed components at every level.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.collateral_cov = (facility.collateral / facility.exposure) \u00d7 100\nIf exposure = 0: collateral_cov = NULL",
      "counterparty": "RECALCULATED: counterparty.collateral_cov = (\u03a3 facility.collateral / \u03a3 facility.exposure) \u00d7 100\nNOT avg of facility-level rates \u2014 use component sums",
      "desk": "RECALCULATED: desk.collateral_cov = (\u03a3 facility.collateral / \u03a3 facility.exposure) \u00d7 100 FOR ALL facility IN desk",
      "portfolio": "RECALCULATED: portfolio.collateral_cov = (\u03a3 facility.collateral / \u03a3 facility.exposure) \u00d7 100 FOR ALL facility IN portfolio",
      "lob": "RECALCULATED: lob.collateral_cov = (\u03a3 facility.collateral / \u03a3 facility.exposure) \u00d7 100 FOR ALL facility IN LOB"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from components",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 at all levels \u2014 always recalculated from component sums",
    "calculation_authority_components": "Collateral (at level), Exposure (at level)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in analytics layer",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Ratio recalculated at every level from summed Collateral and Exposure",
    "sourcing_category": "flexible_level",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: facility.collateral / facility.exposure \u00d7 100 \u2192 facility.collateral_cov\nDependencies: Collateral (facility), Exposure (facility)",
      "counterparty": "RECALCULATE: \u03a3(facility.collateral) / \u03a3(facility.exposure) \u00d7 100 \u2192 counterparty.collateral_cov\nCRITICAL: Use component sums, not avg of rates",
      "desk": "RECALCULATE: \u03a3(fac.collateral) / \u03a3(fac.exposure) \u00d7 100 \u2192 desk.collateral_cov",
      "portfolio": "RECALCULATE: \u03a3(fac.collateral) / \u03a3(fac.exposure) \u00d7 100 \u2192 portfolio.collateral_cov",
      "lob": "RECALCULATE: \u03a3(fac.collateral) / \u03a3(fac.exposure) \u00d7 100 \u2192 lob.collateral_cov"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "AVG_SPREAD",
    "variant_name": "Weighted Avg Spread",
    "parent_metric_id": "AVG_SPREAD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "\u03a3(spread \u00d7 exposure) / \u03a3(exposure) \u2014 calculated at all aggregation levels",
    "detailed_description": "Exposure-weighted average spread. Portfolio-level analytics metric.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.avg_spread = \u03a3(facility.spread \u00d7 facility.exposure) / \u03a3(facility.exposure)",
      "counterparty": "WEIGHTED AVG: counterparty.avg_spread = \u03a3(facility_i.avg_spread \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches\n(Meaningful starting at counterparty level)",
      "desk": "WEIGHTED AVG: desk.avg_spread = \u03a3(facility_i.avg_spread \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.avg_spread = \u03a3(facility_i.avg_spread \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.avg_spread = \u03a3(facility_i.avg_spread \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from components",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "spread, exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in analytics layer",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Weighted Avg Spread calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "flexible_level",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "CALCULATE: Facility-level SPREAD (facility) \u2192 weighted avg \u2192 avg_spread\nDependencies: SPREAD (facility), EXPOSURE (facility)",
      "counterparty": "AGGREGATE: {facility.avg_spread, facility.exposure} \u2192 \u03a3(avg_spread\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.avg_spread\nDependencies: Weighted Avg Spread (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.avg_spread, facility.exposure} \u2192 \u03a3(avg_spread\u00d7exposure)/\u03a3(exposure) \u2192 desk.avg_spread",
      "portfolio": "AGGREGATE: {facility.avg_spread, facility.exposure} \u2192 \u03a3(avg_spread\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.avg_spread",
      "lob": "AGGREGATE: {facility.avg_spread, facility.exposure} \u2192 \u03a3(avg_spread\u00d7exposure)/\u03a3(exposure) \u2192 lob.avg_spread"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "AVG_TENOR",
    "variant_name": "Weighted Avg Tenor",
    "parent_metric_id": "AVG_TENOR",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "\u03a3(days_to_mat \u00d7 exposure) / \u03a3(exposure) \u2014 calculated at all aggregation levels",
    "detailed_description": "Exposure-weighted average days_to_mat. Portfolio-level analytics metric.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.avg_tenor = \u03a3(facility.days_to_mat \u00d7 facility.exposure) / \u03a3(facility.exposure)",
      "counterparty": "WEIGHTED AVG: counterparty.avg_tenor = \u03a3(facility_i.avg_tenor \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches\n(Meaningful starting at counterparty level)",
      "desk": "WEIGHTED AVG: desk.avg_tenor = \u03a3(facility_i.avg_tenor \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.avg_tenor = \u03a3(facility_i.avg_tenor \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.avg_tenor = \u03a3(facility_i.avg_tenor \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from components",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "days_to_mat, exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in analytics layer",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Weighted Avg Tenor calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "flexible_level",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "CALCULATE: Facility-level DAYS_TO_MAT (facility) \u2192 weighted avg \u2192 avg_tenor\nDependencies: DAYS_TO_MAT (facility), EXPOSURE (facility)",
      "counterparty": "AGGREGATE: {facility.avg_tenor, facility.exposure} \u2192 \u03a3(avg_tenor\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.avg_tenor\nDependencies: Weighted Avg Tenor (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.avg_tenor, facility.exposure} \u2192 \u03a3(avg_tenor\u00d7exposure)/\u03a3(exposure) \u2192 desk.avg_tenor",
      "portfolio": "AGGREGATE: {facility.avg_tenor, facility.exposure} \u2192 \u03a3(avg_tenor\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.avg_tenor",
      "lob": "AGGREGATE: {facility.avg_tenor, facility.exposure} \u2192 \u03a3(avg_tenor\u00d7exposure)/\u03a3(exposure) \u2192 lob.avg_tenor"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "DAYS_DELINQ",
    "variant_name": "Days Delinquent",
    "parent_metric_id": "DAYS_DELINQ",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Days past due at facility; MAX or EAD-weighted avg at higher levels",
    "detailed_description": "Days contractual payment is past due. MAX for worst-case; EAD-weighted average for portfolio severity.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.days_delinq from Loan Servicing (days past due)",
      "counterparty": "SUM: counterparty.days_delinq = \u03a3(facility_i.days_delinq) WHERE counterparty_id matches",
      "desk": "SUM: desk.days_delinq = \u03a3(facility_i.days_delinq) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.days_delinq = \u03a3(facility_i.days_delinq) WHERE portfolio_id matches",
      "lob": "SUM: lob.days_delinq = \u03a3(facility_i.days_delinq) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Loan Servicing System",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "days_delinquent",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Loan Servicing System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/delinquency",
    "source_variant_identifier": "facility_delinq",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "days_delinquent",
        "required": true
      },
      {
        "field_name": "delinquent_flag",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify staging rules (30/60/90+)",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Days Delinquent sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "SOURCE: Loan Servicing System \u2192 facility.days_delinq from Loan Servicing (days past due) \u2192 facility.days_delinq\nDependencies: days_delinquent",
      "counterparty": "SUM: \u03a3(facility.days_delinq) WHERE counterparty_id = target \u2192 counterparty.days_delinq",
      "desk": "SUM: \u03a3(facility.days_delinq) WHERE desk_id = target \u2192 desk.days_delinq",
      "portfolio": "SUM: \u03a3(facility.days_delinq) WHERE portfolio_id = target \u2192 portfolio.days_delinq",
      "lob": "SUM: \u03a3(facility.days_delinq) WHERE lob_id = target \u2192 lob.days_delinq"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "DELINQ_AMT",
    "variant_name": "Delinquent Amount",
    "parent_metric_id": "DELINQ_AMT",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Past-due amount; summed at all levels",
    "detailed_description": "Total outstanding exposure contractually past due.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.delinq_amt = past-due amount",
      "counterparty": "SUM: counterparty.delinq_amt = \u03a3(facility_i.delinq_amt) WHERE counterparty_id matches",
      "desk": "SUM: desk.delinq_amt = \u03a3(facility_i.delinq_amt) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.delinq_amt = \u03a3(facility_i.delinq_amt) WHERE portfolio_id matches",
      "lob": "SUM: lob.delinq_amt = \u03a3(facility_i.delinq_amt) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Loan Servicing System",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "delinquent_amount_usd",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Loan Servicing System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/delinq_amt",
    "source_variant_identifier": "delinq_amt",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "delinquent_amount_usd",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Reconcile to aging report",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Delinquent Amount sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Loan Servicing System \u2192 facility.delinq_amt = past-due amount \u2192 facility.delinq_amt\nDependencies: delinquent_amount_usd",
      "counterparty": "SUM: \u03a3(facility.delinq_amt) WHERE counterparty_id = target \u2192 counterparty.delinq_amt",
      "desk": "SUM: \u03a3(facility.delinq_amt) WHERE desk_id = target \u2192 desk.delinq_amt",
      "portfolio": "SUM: \u03a3(facility.delinq_amt) WHERE portfolio_id = target \u2192 portfolio.delinq_amt",
      "lob": "SUM: \u03a3(facility.delinq_amt) WHERE lob_id = target \u2192 lob.delinq_amt"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "DAYS_TO_MAT",
    "variant_name": "Days Until Maturity",
    "parent_metric_id": "DAYS_TO_MAT",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Maturity Date - Reporting Date at facility; exposure-weighted avg at higher levels",
    "detailed_description": "Calendar days remaining until contractual maturity. Rollover risk and duration metric.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.days_to_mat = facility.maturity_date - reporting_date",
      "counterparty": "WEIGHTED AVG: counterparty.days_to_mat = \u03a3(facility_i.days_to_mat \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.days_to_mat = \u03a3(facility_i.days_to_mat \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.days_to_mat = \u03a3(facility_i.days_to_mat \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.days_to_mat = \u03a3(facility_i.days_to_mat \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from maturity date",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "maturity_date, as_of_date",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Days Until Maturity calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "CALCULATE: Loan System \u2192 maturity_date \u2192 (maturity_date - as_of_date) \u2192 facility.days_to_mat\nValidation: days_to_mat \u2265 0",
      "counterparty": "AGGREGATE: {facility.days_to_mat, facility.exposure} \u2192 \u03a3(days_to_mat\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.days_to_mat\nDependencies: Days Until Maturity (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.days_to_mat, facility.exposure} \u2192 \u03a3(days_to_mat\u00d7exposure)/\u03a3(exposure) \u2192 desk.days_to_mat",
      "portfolio": "AGGREGATE: {facility.days_to_mat, facility.exposure} \u2192 \u03a3(days_to_mat\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.days_to_mat",
      "lob": "AGGREGATE: {facility.days_to_mat, facility.exposure} \u2192 \u03a3(days_to_mat\u00d7exposure)/\u03a3(exposure) \u2192 lob.days_to_mat"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "CPTY_ALLOC",
    "variant_name": "Counterparty Concentration",
    "parent_metric_id": "CPTY_ALLOC",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Counterparty Exposure / Total Exposure) \u00d7 100 \u2014 calculated at desk/portfolio/LOB only",
    "detailed_description": "Concentration metric. Only meaningful at desk/portfolio/LOB level (not at facility or counterparty individually).",
    "rollup_logic": {
      "facility": "N/A \u2014 not applicable at facility level",
      "counterparty": "INPUT: counterparty.exposure provides the numerator for each counterparty",
      "desk": "CALCULATED: desk.cpty_alloc[c] = (counterparty_c.exposure_in_desk / desk.total_exposure) \u00d7 100\nfor each counterparty c in desk",
      "portfolio": "CALCULATED: portfolio.cpty_alloc[c] = (counterparty_c.exposure_in_portfolio / portfolio.total_exposure) \u00d7 100",
      "lob": "CALCULATED: lob.cpty_alloc[c] = (counterparty_c.exposure_in_lob / lob.total_exposure) \u00d7 100"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from exposure",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 at desk/portfolio/LOB only \u2014 derived from exposure totals",
    "calculation_authority_components": "counterparty exposure, total exposure at level",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in analytics layer",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Concentration metric; meaningful only at aggregated levels",
    "sourcing_category": "flexible_level",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "N/A at facility level",
      "counterparty": "INPUT: EXPOSURE (counterparty) provides numerator for each cpty",
      "desk": "CALCULATE: cpty_exp / desk_total_exp \u00d7 100 \u2192 desk.cpty_alloc per counterparty\nDependencies: EXPOSURE (each counterparty in desk), EXPOSURE (desk total)",
      "portfolio": "CALCULATE: cpty_exp / portfolio_total \u00d7 100 \u2192 portfolio.cpty_alloc per counterparty",
      "lob": "CALCULATE: cpty_exp / lob_total \u00d7 100 \u2192 lob.cpty_alloc per counterparty"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "RATING_MIG_INT",
    "variant_name": "Internal Rating Migration",
    "parent_metric_id": "RATING_MIG_INT",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Compare current vs prior period rating \u2192 Upgrade/Downgrade/Stable; distribution at higher levels",
    "detailed_description": "Directional indicator of internal rating movement between periods. Distribution (count of upgrades/downgrades/stable) at aggregated levels.",
    "rollup_logic": {
      "facility": "N/A \u2014 migration is an obligor-level concept",
      "counterparty": "CALCULATED: counterparty.rating_mig_int = CASE WHEN current_irr < prior_irr THEN 'Upgrade' WHEN current_irr > prior_irr THEN 'Downgrade' ELSE 'Stable'",
      "desk": "DISTRIBUTION: desk.rating_mig_int_dist = {Upgrade: count, Downgrade: count, Stable: count} + exposure-weighted %",
      "portfolio": "DISTRIBUTION: portfolio.rating_mig_int_dist = same distribution structure",
      "lob": "DISTRIBUTION: lob.rating_mig_int_dist = same distribution structure"
    },
    "weighting_basis": "DISTRIBUTION",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from rating history",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at counterparty (calculated from time series); T3 at desk/portfolio/LOB (distribution)",
    "calculation_authority_components": "current_irr, prior_irr",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Migration calculated at obligor; distributed at higher levels",
    "sourcing_category": "obligor",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "N/A \u2014 migration is counterparty-level concept",
      "counterparty": "CALCULATE: Compare current_irr vs prior_irr \u2192 Upgrade/Downgrade/Stable \u2192 counterparty.rating_mig_int\nDependencies: current rating, prior period rating",
      "desk": "DISTRIBUTE: GROUP BY migration_direction \u2192 count + exp% \u2192 desk.rating_mig_int_dist",
      "portfolio": "DISTRIBUTE: GROUP BY direction \u2192 portfolio.rating_mig_int_dist",
      "lob": "DISTRIBUTE: GROUP BY direction \u2192 lob.rating_mig_int_dist"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "RATING_MIG_EXT",
    "variant_name": "External Rating Migration",
    "parent_metric_id": "RATING_MIG_EXT",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Compare current vs prior period rating \u2192 Upgrade/Downgrade/Stable; distribution at higher levels",
    "detailed_description": "Directional indicator of external rating movement between periods. Distribution (count of upgrades/downgrades/stable) at aggregated levels.",
    "rollup_logic": {
      "facility": "N/A \u2014 migration is an obligor-level concept",
      "counterparty": "CALCULATED: counterparty.rating_mig_ext = CASE WHEN current_ext_rating < prior_ext_rating THEN 'Upgrade' WHEN current_ext_rating > prior_ext_rating THEN 'Downgrade' ELSE 'Stable'",
      "desk": "DISTRIBUTION: desk.rating_mig_ext_dist = {Upgrade: count, Downgrade: count, Stable: count} + exposure-weighted %",
      "portfolio": "DISTRIBUTION: portfolio.rating_mig_ext_dist = same distribution structure",
      "lob": "DISTRIBUTION: lob.rating_mig_ext_dist = same distribution structure"
    },
    "weighting_basis": "DISTRIBUTION",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from rating history",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at counterparty (calculated from time series); T3 at desk/portfolio/LOB (distribution)",
    "calculation_authority_components": "current_ext_rating, prior_ext_rating",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Migration calculated at obligor; distributed at higher levels",
    "sourcing_category": "obligor",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "N/A \u2014 migration is counterparty-level concept",
      "counterparty": "CALCULATE: Compare current_ext_rating vs prior_ext_rating \u2192 Upgrade/Downgrade/Stable \u2192 counterparty.rating_mig_ext\nDependencies: current rating, prior period rating",
      "desk": "DISTRIBUTE: GROUP BY migration_direction \u2192 count + exp% \u2192 desk.rating_mig_ext_dist",
      "portfolio": "DISTRIBUTE: GROUP BY direction \u2192 portfolio.rating_mig_ext_dist",
      "lob": "DISTRIBUTE: GROUP BY direction \u2192 lob.rating_mig_ext_dist"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "EXT_RATING_CHG_STEPS",
    "variant_name": "Ext Rating Change Steps",
    "parent_metric_id": "EXT_RATING_CHG_STEPS",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Current notch - Prior notch at counterparty; exposure-weighted avg at higher levels",
    "detailed_description": "Numerical notch change. Positive = downgrade, negative = upgrade. Exposure-weighted average at aggregation levels for severity assessment.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.ext_rating_chg_steps = counterparty.ext_rating_chg_steps = current_notch - prior_notch",
      "counterparty": "WEIGHTED AVG: counterparty.ext_rating_chg_steps = \u03a3(facility_i.ext_rating_chg_steps \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.ext_rating_chg_steps = \u03a3(facility_i.ext_rating_chg_steps \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.ext_rating_chg_steps = \u03a3(facility_i.ext_rating_chg_steps \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.ext_rating_chg_steps = \u03a3(facility_i.ext_rating_chg_steps \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from rating history",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "current_notch, prior_notch",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Ext Rating Change Steps calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "obligor",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "CALCULATE: Rating history \u2192 (current_notch - prior_notch) \u2192 counterparty.ext_rating_chg_steps\nDependencies: current rating numeric, prior rating numeric",
      "counterparty": "AGGREGATE: {facility.ext_rating_chg_steps, facility.exposure} \u2192 \u03a3(ext_rating_chg_steps\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.ext_rating_chg_steps\nDependencies: Ext Rating Change Steps (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.ext_rating_chg_steps, facility.exposure} \u2192 \u03a3(ext_rating_chg_steps\u00d7exposure)/\u03a3(exposure) \u2192 desk.ext_rating_chg_steps",
      "portfolio": "AGGREGATE: {facility.ext_rating_chg_steps, facility.exposure} \u2192 \u03a3(ext_rating_chg_steps\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.ext_rating_chg_steps",
      "lob": "AGGREGATE: {facility.ext_rating_chg_steps, facility.exposure} \u2192 \u03a3(ext_rating_chg_steps\u00d7exposure)/\u03a3(exposure) \u2192 lob.ext_rating_chg_steps"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "INT_RATING_CHG",
    "variant_name": "Internal Rating Change (Notches)",
    "parent_metric_id": "INT_RATING_CHG",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Current notch - Prior notch at counterparty; exposure-weighted avg at higher levels",
    "detailed_description": "Numerical notch change. Positive = downgrade, negative = upgrade. Exposure-weighted average at aggregation levels for severity assessment.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.int_rating_chg = counterparty.int_rating_chg = current_numeric - prior_numeric",
      "counterparty": "WEIGHTED AVG: counterparty.int_rating_chg = \u03a3(facility_i.int_rating_chg \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.int_rating_chg = \u03a3(facility_i.int_rating_chg \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.int_rating_chg = \u03a3(facility_i.int_rating_chg \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.int_rating_chg = \u03a3(facility_i.int_rating_chg \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from rating history",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "current_numeric, prior_numeric",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Internal Rating Change (Notches) calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "obligor",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "CALCULATE: Rating history \u2192 (current_numeric - prior_numeric) \u2192 counterparty.int_rating_chg\nDependencies: current rating numeric, prior rating numeric",
      "counterparty": "AGGREGATE: {facility.int_rating_chg, facility.exposure} \u2192 \u03a3(int_rating_chg\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.int_rating_chg\nDependencies: Internal Rating Change (Notches) (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.int_rating_chg, facility.exposure} \u2192 \u03a3(int_rating_chg\u00d7exposure)/\u03a3(exposure) \u2192 desk.int_rating_chg",
      "portfolio": "AGGREGATE: {facility.int_rating_chg, facility.exposure} \u2192 \u03a3(int_rating_chg\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.int_rating_chg",
      "lob": "AGGREGATE: {facility.int_rating_chg, facility.exposure} \u2192 \u03a3(int_rating_chg\u00d7exposure)/\u03a3(exposure) \u2192 lob.int_rating_chg"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "LOAN_COUNT",
    "variant_name": "Loan Count",
    "parent_metric_id": "LOAN_COUNT",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "COUNT(facility_id) \u2014 additive count at all levels",
    "detailed_description": "Count of individual facilities. Granularity and diversification metric.",
    "rollup_logic": {
      "facility": "CALCULATED: facility level = 1 (each facility counts as 1)",
      "counterparty": "COUNT: counterparty.loan_count = COUNT(facility_id WHERE counterparty_id = target)",
      "desk": "SUM: desk.loan_count = \u03a3(counterparty.loan_count) OR COUNT(facility WHERE desk_id = target)",
      "portfolio": "SUM: portfolio.loan_count = COUNT(facility WHERE portfolio_id = target)",
      "lob": "SUM: lob.loan_count = COUNT(facility WHERE lob_id = target)"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from facility list",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 simple count aggregation",
    "calculation_authority_components": "facility_id",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in analytics layer",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Count at all levels",
    "sourcing_category": "flexible_level",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "COUNT: Each facility = 1",
      "counterparty": "COUNT: COUNT(facility WHERE counterparty_id = target)",
      "desk": "SUM: \u03a3(cpty.loan_count) or direct COUNT(fac in desk)",
      "portfolio": "SUM: COUNT(facility WHERE portfolio_id = target)",
      "lob": "SUM: COUNT(facility WHERE lob_id = target)"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "PRICING_EXCEPTION",
    "variant_name": "Pricing Exception",
    "parent_metric_id": "PRICING_EXCEPTION",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Policy exception flag at facility; count/% at higher levels",
    "detailed_description": "Indicator identifying pricing outside standard policy.",
    "rollup_logic": {
      "facility": "RAW FLAG: facility.pricing_exception = policy exception flag from Credit Approval workflow",
      "counterparty": "RAW FLAG or COUNT: counterparty.pricing_exception sourced OR COUNT(flagged facilities) / total \u00d7 100",
      "desk": "PERCENTAGE: desk.pricing_exception_pct = COUNT(facility WHERE pricing_exception=1) / COUNT(all facility) \u00d7 100 IN desk\nAlternative: \u03a3(flagged_exposure) / \u03a3(total_exposure) \u00d7 100 for exposure-weighted",
      "portfolio": "PERCENTAGE: portfolio.pricing_exception_pct = COUNT(facility WHERE pricing_exception=1) / COUNT(all facility) \u00d7 100 IN portfolio",
      "lob": "PERCENTAGE: lob.pricing_exception_pct = COUNT(facility WHERE pricing_exception=1) / COUNT(all facility) \u00d7 100 IN LOB"
    },
    "weighting_basis": "COUNT_BASED",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Credit Approval System",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility/counterparty (sourced flag); T3 at desk/portfolio/LOB (derived count/percentage)",
    "calculation_authority_components": "pricing_exception_status, count",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Credit Approval System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Batch",
    "source_endpoint_or_feed": "/feeds/exceptions",
    "source_variant_identifier": "fac_exception",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "exception_status",
        "required": true
      },
      {
        "field_name": "exception_type",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Validate against pricing policy",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Flag sourced at facility; count/percentage aggregated at higher levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Credit Approval System \u2192 pricing_exception_status \u2192 facility.pricing_exception\nValidation: Boolean (0/1)",
      "counterparty": "SOURCE or AGGREGATE: Sourced flag at counterparty OR count of flagged facilities",
      "desk": "AGGREGATE: COUNT(fac WHERE pricing_exception=1) / COUNT(all fac) \u00d7 100 \u2192 desk.pricing_exception_pct",
      "portfolio": "AGGREGATE: COUNT(fac WHERE pricing_exception=1) / COUNT(all fac) \u00d7 100 \u2192 portfolio.pricing_exception_pct",
      "lob": "AGGREGATE: COUNT(fac WHERE pricing_exception=1) / COUNT(all fac) \u00d7 100 \u2192 lob.pricing_exception_pct"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "LIMIT_STATUS",
    "variant_name": "Limit Status",
    "parent_metric_id": "LIMIT_STATUS",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Limit breach status at counterparty; distribution at higher levels",
    "detailed_description": "Status of credit limit (Active/Breached/Suspended/Warning). Distribution of statuses at desk/portfolio/LOB.",
    "rollup_logic": {
      "facility": "N/A \u2014 limits are counterparty-level",
      "counterparty": "RAW SOURCE: counterparty.limit_status from Limit Management System\nValues: Active, Warning (>80%), Breached, Suspended",
      "desk": "DISTRIBUTION: desk.limit_status_dist = {Active: count/%, Warning: count/%, Breached: count/%}\nPlus: desk.breach_count, desk.breach_exposure_pct",
      "portfolio": "DISTRIBUTION: portfolio.limit_status_dist = same structure",
      "lob": "DISTRIBUTION: lob.limit_status_dist = same structure"
    },
    "weighting_basis": "DISTRIBUTION",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Limit Management System",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at counterparty (sourced); T3 at desk/portfolio/LOB (distribution)",
    "calculation_authority_components": "limit_status, limit_amount, exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Limit Management System",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Real-time",
    "source_endpoint_or_feed": "/feeds/limits",
    "source_variant_identifier": "cpty_limit_status",
    "source_payload_spec": [
      {
        "field_name": "counterparty_id",
        "required": true
      },
      {
        "field_name": "limit_status",
        "required": true
      },
      {
        "field_name": "breach_flag",
        "required": true
      },
      {
        "field_name": "breach_amount",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify breach thresholds match policy",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Limits at counterparty; status distributed at higher levels",
    "sourcing_category": "obligor",
    "data_format": "JSON",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "N/A \u2014 limits are counterparty-level",
      "counterparty": "SOURCE: Limit Mgmt Sys \u2192 limit_status \u2192 counterparty.limit_status\nValidation: status \u2208 {Active, Warning, Breached, Suspended}",
      "desk": "DISTRIBUTE: GROUP BY limit_status \u2192 {status: count, %, exp%} \u2192 desk.limit_status_dist",
      "portfolio": "DISTRIBUTE: GROUP BY limit_status \u2192 portfolio.limit_status_dist",
      "lob": "DISTRIBUTE: GROUP BY limit_status \u2192 lob.limit_status_dist"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "EXCEPTION_RATE",
    "variant_name": "Exception Rate",
    "parent_metric_id": "EXCEPTION_RATE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Count(Exceptions) / Total \u00d7 100 \u2014 calculated at desk/portfolio/LOB",
    "detailed_description": "Governance KPI measuring policy compliance. Only meaningful at aggregated levels.",
    "rollup_logic": {
      "facility": "INPUT: facility.pricing_exception flag provides the count input",
      "counterparty": "INPUT: Counterparty exception status provides building block",
      "desk": "CALCULATED: desk.exception_rate = COUNT(fac WHERE exception=1) / COUNT(all fac) \u00d7 100 IN desk",
      "portfolio": "CALCULATED: portfolio.exception_rate = COUNT(fac WHERE exception=1) / COUNT(all fac) \u00d7 100",
      "lob": "CALCULATED: lob.exception_rate = COUNT(fac WHERE exception=1) / COUNT(all fac) \u00d7 100"
    },
    "weighting_basis": "COUNT_BASED",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from exception flags",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 portfolio KPI derived from facility flags",
    "calculation_authority_components": "PRICING_EXCEPTION (facility), facility_count",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in analytics layer",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "KPI at aggregated levels only",
    "sourcing_category": "flexible_level",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "INPUT: PRICING_EXCEPTION (facility) provides flag",
      "counterparty": "CONTEXT: Counterparty exception status",
      "desk": "CALCULATE: COUNT(fac WHERE exception=1) / COUNT(all) \u00d7 100 \u2192 desk.exception_rate",
      "portfolio": "CALCULATE: same formula \u2192 portfolio.exception_rate",
      "lob": "CALCULATE: same formula \u2192 lob.exception_rate"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "FAC_UTIL_STATUS",
    "variant_name": "Facility Utilization Status",
    "parent_metric_id": "FAC_UTIL_STATUS",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Categorical classification; distribution at higher levels",
    "detailed_description": "Sufficient (<75%) / Approaching (75-90%) / Fully Utilized (>90%). Distribution at aggregated levels.",
    "rollup_logic": {
      "facility": "CALCULATED: CASE WHEN util_pct < 75 THEN 'Sufficient' WHEN util_pct < 90 THEN 'Approaching' ELSE 'Fully Utilized'\nDependency: UTIL_PCT (facility)",
      "counterparty": "DISTRIBUTION: counterparty.util_status_dist = {Sufficient: n, Approaching: n, Fully: n} across facilities",
      "desk": "DISTRIBUTION: desk.util_status_dist = distribution of facility utilization categories in desk",
      "portfolio": "DISTRIBUTION: portfolio.util_status_dist = same",
      "lob": "DISTRIBUTION: lob.util_status_dist = same"
    },
    "weighting_basis": "DISTRIBUTION",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from UTIL_PCT",
    "refresh_frequency": "DAILY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (derived from utilization); T3 at higher levels (distribution)",
    "calculation_authority_components": "UTIL_PCT (facility)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Risk DW",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Categorical at facility; distributed at higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+0",
    "lineage_by_level": {
      "facility": "CALCULATE: UTIL_PCT (facility) \u2192 CASE statement \u2192 facility.util_status\nDependencies: UTIL_PCT",
      "counterparty": "DISTRIBUTE: GROUP BY util_status \u2192 counterparty.util_status_dist",
      "desk": "DISTRIBUTE: GROUP BY util_status \u2192 desk.util_status_dist",
      "portfolio": "DISTRIBUTE: GROUP BY util_status \u2192 portfolio.util_status_dist",
      "lob": "DISTRIBUTE: GROUP BY util_status \u2192 lob.util_status_dist"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_PD_BASE",
    "variant_name": "Stressed PD \u2013 Baseline",
    "parent_metric_id": "STRESSED_PD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "PD under Baseline macro scenario; EAD-weighted avg at higher levels",
    "detailed_description": "Stressed PD under Federal Reserve baseline scenario. Derived from PD model with stressed macroeconomic inputs or multiplier approach.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_pd_base = PD_Baseline \u00d7 Baseline_Multiplier OR PD_Model(stressed_macro_BASE)",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_pd_base = \u03a3(facility_i.stressed_pd_base \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_pd_base = \u03a3(facility_i.stressed_pd_base \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_pd_base = \u03a3(facility_i.stressed_pd_base \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_pd_base = \u03a3(facility_i.stressed_pd_base \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EAD",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "PD (facility), Baseline scenario parameters",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed PD \u2013 Baseline calculated at facility; BY_EAD weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Engine \u2192 {PD_baseline, Baseline_macro} \u2192 stressed PD \u2192 facility.stressed_pd_base\nDependencies: PD (facility), Macro scenario Baseline",
      "counterparty": "AGGREGATE: {facility.stressed_pd_base, facility.ead} \u2192 \u03a3(stressed_pd_base\u00d7ead)/\u03a3(ead) \u2192 counterparty.stressed_pd_base\nDependencies: Stressed PD \u2013 Baseline (facility) + EAD (facility)",
      "desk": "AGGREGATE: {facility.stressed_pd_base, facility.ead} \u2192 \u03a3(stressed_pd_base\u00d7ead)/\u03a3(ead) \u2192 desk.stressed_pd_base",
      "portfolio": "AGGREGATE: {facility.stressed_pd_base, facility.ead} \u2192 \u03a3(stressed_pd_base\u00d7ead)/\u03a3(ead) \u2192 portfolio.stressed_pd_base",
      "lob": "AGGREGATE: {facility.stressed_pd_base, facility.ead} \u2192 \u03a3(stressed_pd_base\u00d7ead)/\u03a3(ead) \u2192 lob.stressed_pd_base"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_LGD_BASE",
    "variant_name": "Stressed LGD \u2013 Baseline",
    "parent_metric_id": "STRESSED_LGD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "LGD under Baseline; stressed collateral values; EAD-weighted avg at higher levels",
    "detailed_description": "Stressed LGD under Federal Reserve baseline scenario. Incorporates stressed collateral values and recovery assumptions.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_lgd_base = LGD_Baseline \u00d7 Baseline_Stress_Factor OR LGD_Model(stressed_collateral_BASE)",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_lgd_base = \u03a3(facility_i.stressed_lgd_base \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_lgd_base = \u03a3(facility_i.stressed_lgd_base \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_lgd_base = \u03a3(facility_i.stressed_lgd_base \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_lgd_base = \u03a3(facility_i.stressed_lgd_base \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EAD",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "LGD (facility), COLLATERAL (stressed), Baseline params",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed LGD \u2013 Baseline calculated at facility; BY_EAD weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Engine \u2192 {LGD_baseline, stressed_collateral} \u2192 stressed LGD \u2192 facility.stressed_lgd_base\nDependencies: LGD (facility), COLLATERAL stressed, Baseline assumptions",
      "counterparty": "AGGREGATE: {facility.stressed_lgd_base, facility.ead} \u2192 \u03a3(stressed_lgd_base\u00d7ead)/\u03a3(ead) \u2192 counterparty.stressed_lgd_base\nDependencies: Stressed LGD \u2013 Baseline (facility) + EAD (facility)",
      "desk": "AGGREGATE: {facility.stressed_lgd_base, facility.ead} \u2192 \u03a3(stressed_lgd_base\u00d7ead)/\u03a3(ead) \u2192 desk.stressed_lgd_base",
      "portfolio": "AGGREGATE: {facility.stressed_lgd_base, facility.ead} \u2192 \u03a3(stressed_lgd_base\u00d7ead)/\u03a3(ead) \u2192 portfolio.stressed_lgd_base",
      "lob": "AGGREGATE: {facility.stressed_lgd_base, facility.ead} \u2192 \u03a3(stressed_lgd_base\u00d7ead)/\u03a3(ead) \u2192 lob.stressed_lgd_base"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_EL_BASE",
    "variant_name": "Stressed EL \u2013 Baseline",
    "parent_metric_id": "STRESSED_EL",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed_PD \u00d7 Stressed_LGD \u00d7 Stressed_EAD under Baseline; summed at all levels",
    "detailed_description": "Stressed expected loss under Federal Reserve baseline scenario. Primary CCAR/DFAST loss projection.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_el_base = stressed_pd \u00d7 stressed_lgd \u00d7 stressed_ead",
      "counterparty": "SUM: counterparty.stressed_el_base = \u03a3(facility_i.stressed_el_base) WHERE counterparty_id matches",
      "desk": "SUM: desk.stressed_el_base = \u03a3(facility_i.stressed_el_base) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.stressed_el_base = \u03a3(facility_i.stressed_el_base) WHERE portfolio_id matches",
      "lob": "SUM: lob.stressed_el_base = \u03a3(facility_i.stressed_el_base) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "STRESSED_PD_BASE, STRESSED_LGD_BASE, EAD (stressed)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed EL \u2013 Baseline sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Testing Engine \u2192 facility.stressed_el_base = stressed_pd \u00d7 stressed_lgd \u00d7 stressed_ead \u2192 facility.stressed_el_base\nDependencies: STRESSED_PD_BASE, STRESSED_LGD_BASE, EAD (stressed)",
      "counterparty": "SUM: \u03a3(facility.stressed_el_base) WHERE counterparty_id = target \u2192 counterparty.stressed_el_base",
      "desk": "SUM: \u03a3(facility.stressed_el_base) WHERE desk_id = target \u2192 desk.stressed_el_base",
      "portfolio": "SUM: \u03a3(facility.stressed_el_base) WHERE portfolio_id = target \u2192 portfolio.stressed_el_base",
      "lob": "SUM: \u03a3(facility.stressed_el_base) WHERE lob_id = target \u2192 lob.stressed_el_base"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_EL_RATE_BASE",
    "variant_name": "Stressed EL Rate \u2013 Baseline",
    "parent_metric_id": "STRESSED_EL_RATE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed_EL / Stressed_Exposure \u00d7 100 [Baseline] \u2014 recalculated at each level",
    "detailed_description": "Loss rate under Federal Reserve baseline scenario. Recalculated from summed components at each level.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = stressed_el / stressed_exposure \u00d7 100",
      "counterparty": "RECALCULATED: \u03a3(stressed_el) / \u03a3(stressed_exposure) \u00d7 100 at counterparty",
      "desk": "RECALCULATED: same formula at desk level",
      "portfolio": "RECALCULATED: same formula at portfolio level",
      "lob": "RECALCULATED: same formula at LOB level"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 always derived",
    "calculation_authority_components": "Stressed EL, Stressed Exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "all levels"
    ],
    "sourcing_level_rationale": "Ratio recalculated at every level",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: stressed_el / stressed_exp \u00d7 100 \u2192 facility [Baseline]",
      "counterparty": "RECALCULATE: \u03a3(s_el)/\u03a3(s_exp)\u00d7100 \u2192 cpty [Baseline]",
      "desk": "RECALCULATE: same \u2192 desk [Baseline]",
      "portfolio": "RECALCULATE: same \u2192 portfolio [Baseline]",
      "lob": "RECALCULATE: same \u2192 lob [Baseline]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESS_CAP_IMPACT_BASE",
    "variant_name": "Stress Capital Impact \u2013 Baseline",
    "parent_metric_id": "STRESS_CAP_IMPACT",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Stressed_EL - Baseline_EL) / Capital \u00d7 100 [Baseline]",
    "detailed_description": "Change in required capital under Federal Reserve baseline scenario vs baseline.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = (stressed_el_base - baseline_el) / capital_allocated \u00d7 100",
      "counterparty": "RECALCULATED: (\u03a3 stressed_el - \u03a3 baseline_el) / \u03a3 capital \u00d7 100 at counterparty",
      "desk": "RECALCULATED: same at desk",
      "portfolio": "RECALCULATED: same at portfolio",
      "lob": "RECALCULATED: same at LOB"
    },
    "weighting_basis": "BY_CAPITAL",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Engine + Capital",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 derived from stressed and baseline EL + capital",
    "calculation_authority_components": "STRESSED_EL_BASE, EL (baseline), CAP_ALLOC",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "all levels"
    ],
    "sourcing_level_rationale": "Recalculated at every level",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: (s_el - b_el) / capital \u00d7 100 \u2192 facility [Baseline]",
      "counterparty": "RECALCULATE: (\u03a3 s_el - \u03a3 b_el) / \u03a3 capital \u00d7 100 \u2192 cpty [Baseline]",
      "desk": "RECALCULATE: same \u2192 desk [Baseline]",
      "portfolio": "RECALCULATE: same \u2192 portfolio [Baseline]",
      "lob": "RECALCULATE: same \u2192 lob [Baseline]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESS_LOSS_DELTA_BASE",
    "variant_name": "Stress Loss Delta \u2013 Baseline",
    "parent_metric_id": "STRESS_LOSS_DELTA",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed_EL - Baseline_EL [Baseline]; summed at all levels",
    "detailed_description": "Incremental expected loss under Federal Reserve baseline scenario vs baseline.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = stressed_el_base - baseline_el",
      "counterparty": "SUM: counterparty.stress_loss_delta_base = \u03a3(facility_i.stress_loss_delta_base) WHERE counterparty_id matches",
      "desk": "SUM: desk.stress_loss_delta_base = \u03a3(facility_i.stress_loss_delta_base) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.stress_loss_delta_base = \u03a3(facility_i.stress_loss_delta_base) WHERE portfolio_id matches",
      "lob": "SUM: lob.stress_loss_delta_base = \u03a3(facility_i.stress_loss_delta_base) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "STRESSED_EL_BASE, EL (baseline)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stress Loss Delta \u2013 Baseline sourced at facility; summed additively at all levels",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Calculated \u2192 facility = stressed_el_base - baseline_el \u2192 facility.stress_loss_delta_base\nDependencies: STRESSED_EL_BASE, EL (baseline)",
      "counterparty": "SUM: \u03a3(facility.stress_loss_delta_base) WHERE counterparty_id = target \u2192 counterparty.stress_loss_delta_base",
      "desk": "SUM: \u03a3(facility.stress_loss_delta_base) WHERE desk_id = target \u2192 desk.stress_loss_delta_base",
      "portfolio": "SUM: \u03a3(facility.stress_loss_delta_base) WHERE portfolio_id = target \u2192 portfolio.stress_loss_delta_base",
      "lob": "SUM: \u03a3(facility.stress_loss_delta_base) WHERE lob_id = target \u2192 lob.stress_loss_delta_base"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_DSCR_BASE",
    "variant_name": "Stressed DSCR \u2013 Baseline",
    "parent_metric_id": "STRESSED_DSCR",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed CF / Stressed TDS [Baseline]; exposure-weighted avg at higher levels",
    "detailed_description": "DSCR under Federal Reserve baseline scenario. Covenant breach risk under adverse conditions.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_dscr_base = stressed_cashflow_base / stressed_tds_base",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_dscr_base = \u03a3(facility_i.stressed_dscr_base \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_dscr_base = \u03a3(facility_i.stressed_dscr_base \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_dscr_base = \u03a3(facility_i.stressed_dscr_base \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_dscr_base = \u03a3(facility_i.stressed_dscr_base \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "Stressed CF, Stressed TDS [Baseline]",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed DSCR \u2013 Baseline calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Engine \u2192 stressed CF and TDS \u2192 ratio \u2192 facility.stressed_dscr_base",
      "counterparty": "AGGREGATE: {facility.stressed_dscr_base, facility.exposure} \u2192 \u03a3(stressed_dscr_base\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.stressed_dscr_base\nDependencies: Stressed DSCR \u2013 Baseline (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.stressed_dscr_base, facility.exposure} \u2192 \u03a3(stressed_dscr_base\u00d7exposure)/\u03a3(exposure) \u2192 desk.stressed_dscr_base",
      "portfolio": "AGGREGATE: {facility.stressed_dscr_base, facility.exposure} \u2192 \u03a3(stressed_dscr_base\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.stressed_dscr_base",
      "lob": "AGGREGATE: {facility.stressed_dscr_base, facility.exposure} \u2192 \u03a3(stressed_dscr_base\u00d7exposure)/\u03a3(exposure) \u2192 lob.stressed_dscr_base"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_LTV_BASE",
    "variant_name": "Stressed LTV \u2013 Baseline",
    "parent_metric_id": "STRESSED_LTV",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Exposure / Stressed Collateral \u00d7 100 [Baseline]; exposure-weighted avg at higher levels",
    "detailed_description": "LTV under Federal Reserve baseline scenario. Downside collateral coverage.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_ltv_base = facility.exposure / stressed_collateral_value_base \u00d7 100",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_ltv_base = \u03a3(facility_i.stressed_ltv_base \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_ltv_base = \u03a3(facility_i.stressed_ltv_base \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_ltv_base = \u03a3(facility_i.stressed_ltv_base \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_ltv_base = \u03a3(facility_i.stressed_ltv_base \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "Exposure, Stressed Collateral [Baseline]",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed LTV \u2013 Baseline calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: {exposure, stressed_collateral} \u2192 exp/coll\u00d7100 \u2192 facility.stressed_ltv_base",
      "counterparty": "AGGREGATE: {facility.stressed_ltv_base, facility.exposure} \u2192 \u03a3(stressed_ltv_base\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.stressed_ltv_base\nDependencies: Stressed LTV \u2013 Baseline (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.stressed_ltv_base, facility.exposure} \u2192 \u03a3(stressed_ltv_base\u00d7exposure)/\u03a3(exposure) \u2192 desk.stressed_ltv_base",
      "portfolio": "AGGREGATE: {facility.stressed_ltv_base, facility.exposure} \u2192 \u03a3(stressed_ltv_base\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.stressed_ltv_base",
      "lob": "AGGREGATE: {facility.stressed_ltv_base, facility.exposure} \u2192 \u03a3(stressed_ltv_base\u00d7exposure)/\u03a3(exposure) \u2192 lob.stressed_ltv_base"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "PROVISION_RATE_BASE",
    "variant_name": "Provision Rate \u2013 Baseline",
    "parent_metric_id": "PROVISION_RATE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Provision / Exposure \u00d7 100 [Baseline] \u2014 recalculated at each level",
    "detailed_description": "Provision expense rate under Federal Reserve baseline scenario.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = provision_base / exposure \u00d7 100",
      "counterparty": "RECALCULATED: \u03a3(provision) / \u03a3(exposure) \u00d7 100 at counterparty",
      "desk": "RECALCULATED: same at desk",
      "portfolio": "RECALCULATED: same at portfolio",
      "lob": "RECALCULATED: same at LOB"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 always derived",
    "calculation_authority_components": "Provision, Exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "all levels"
    ],
    "sourcing_level_rationale": "Ratio recalculated at each level",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: provision / exposure \u00d7 100 \u2192 facility [Baseline]",
      "counterparty": "RECALCULATE: \u03a3(prov)/\u03a3(exp)\u00d7100 \u2192 cpty [Baseline]",
      "desk": "RECALCULATE: same \u2192 desk [Baseline]",
      "portfolio": "RECALCULATE: same \u2192 portfolio [Baseline]",
      "lob": "RECALCULATE: same \u2192 lob [Baseline]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "PPNR_BASE",
    "variant_name": "PPNR \u2013 Baseline",
    "parent_metric_id": "PPNR",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "NII + Non-II Income - Non-II Expense [Baseline]; summed at aggregation levels",
    "detailed_description": "Pre-provision net revenue under Federal Reserve baseline scenario. Key CCAR revenue projection.",
    "rollup_logic": {
      "facility": "N/A \u2014 PPNR is an aggregated revenue metric, not facility-level",
      "counterparty": "N/A \u2014 PPNR is typically calculated at portfolio/LOB level",
      "desk": "CALCULATED: desk.ppnr_base = desk.nii + desk.nonii_income - desk.nonii_expense [Baseline]",
      "portfolio": "CALCULATED: portfolio.ppnr_base = same structure at portfolio",
      "lob": "SUM: lob.ppnr_base = \u03a3(portfolio.ppnr) OR direct calculation at LOB"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Capital Planning Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 \u2014 calculated from revenue model components",
    "calculation_authority_components": "NII, Non-II Income, Non-II Expense [Baseline]",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Capital Planning / CCAR Engine",
    "reconciliation_anchor_levels": [
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "PPNR is portfolio/LOB-level metric",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "N/A \u2014 not a facility-level metric",
      "counterparty": "N/A \u2014 not counterparty-level",
      "desk": "CALCULATE: NII + NonII_Inc - NonII_Exp \u2192 desk.ppnr [Baseline]",
      "portfolio": "CALCULATE: same \u2192 portfolio.ppnr [Baseline]",
      "lob": "SUM or CALCULATE: \u03a3(portfolio.ppnr) \u2192 lob.ppnr [Baseline]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_PD_ADV",
    "variant_name": "Stressed PD \u2013 Adverse",
    "parent_metric_id": "STRESSED_PD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "PD under Adverse macro scenario; EAD-weighted avg at higher levels",
    "detailed_description": "Stressed PD under Federal Reserve adverse scenario. Derived from PD model with stressed macroeconomic inputs or multiplier approach.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_pd_adv = PD_Baseline \u00d7 Adverse_Multiplier OR PD_Model(stressed_macro_ADV)",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_pd_adv = \u03a3(facility_i.stressed_pd_adv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_pd_adv = \u03a3(facility_i.stressed_pd_adv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_pd_adv = \u03a3(facility_i.stressed_pd_adv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_pd_adv = \u03a3(facility_i.stressed_pd_adv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EAD",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "PD (facility), Adverse scenario parameters",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed PD \u2013 Adverse calculated at facility; BY_EAD weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Engine \u2192 {PD_baseline, Adverse_macro} \u2192 stressed PD \u2192 facility.stressed_pd_adv\nDependencies: PD (facility), Macro scenario Adverse",
      "counterparty": "AGGREGATE: {facility.stressed_pd_adv, facility.ead} \u2192 \u03a3(stressed_pd_adv\u00d7ead)/\u03a3(ead) \u2192 counterparty.stressed_pd_adv\nDependencies: Stressed PD \u2013 Adverse (facility) + EAD (facility)",
      "desk": "AGGREGATE: {facility.stressed_pd_adv, facility.ead} \u2192 \u03a3(stressed_pd_adv\u00d7ead)/\u03a3(ead) \u2192 desk.stressed_pd_adv",
      "portfolio": "AGGREGATE: {facility.stressed_pd_adv, facility.ead} \u2192 \u03a3(stressed_pd_adv\u00d7ead)/\u03a3(ead) \u2192 portfolio.stressed_pd_adv",
      "lob": "AGGREGATE: {facility.stressed_pd_adv, facility.ead} \u2192 \u03a3(stressed_pd_adv\u00d7ead)/\u03a3(ead) \u2192 lob.stressed_pd_adv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_LGD_ADV",
    "variant_name": "Stressed LGD \u2013 Adverse",
    "parent_metric_id": "STRESSED_LGD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "LGD under Adverse; stressed collateral values; EAD-weighted avg at higher levels",
    "detailed_description": "Stressed LGD under Federal Reserve adverse scenario. Incorporates stressed collateral values and recovery assumptions.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_lgd_adv = LGD_Baseline \u00d7 Adverse_Stress_Factor OR LGD_Model(stressed_collateral_ADV)",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_lgd_adv = \u03a3(facility_i.stressed_lgd_adv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_lgd_adv = \u03a3(facility_i.stressed_lgd_adv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_lgd_adv = \u03a3(facility_i.stressed_lgd_adv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_lgd_adv = \u03a3(facility_i.stressed_lgd_adv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EAD",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "LGD (facility), COLLATERAL (stressed), Adverse params",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed LGD \u2013 Adverse calculated at facility; BY_EAD weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Engine \u2192 {LGD_baseline, stressed_collateral} \u2192 stressed LGD \u2192 facility.stressed_lgd_adv\nDependencies: LGD (facility), COLLATERAL stressed, Adverse assumptions",
      "counterparty": "AGGREGATE: {facility.stressed_lgd_adv, facility.ead} \u2192 \u03a3(stressed_lgd_adv\u00d7ead)/\u03a3(ead) \u2192 counterparty.stressed_lgd_adv\nDependencies: Stressed LGD \u2013 Adverse (facility) + EAD (facility)",
      "desk": "AGGREGATE: {facility.stressed_lgd_adv, facility.ead} \u2192 \u03a3(stressed_lgd_adv\u00d7ead)/\u03a3(ead) \u2192 desk.stressed_lgd_adv",
      "portfolio": "AGGREGATE: {facility.stressed_lgd_adv, facility.ead} \u2192 \u03a3(stressed_lgd_adv\u00d7ead)/\u03a3(ead) \u2192 portfolio.stressed_lgd_adv",
      "lob": "AGGREGATE: {facility.stressed_lgd_adv, facility.ead} \u2192 \u03a3(stressed_lgd_adv\u00d7ead)/\u03a3(ead) \u2192 lob.stressed_lgd_adv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_EL_ADV",
    "variant_name": "Stressed EL \u2013 Adverse",
    "parent_metric_id": "STRESSED_EL",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed_PD \u00d7 Stressed_LGD \u00d7 Stressed_EAD under Adverse; summed at all levels",
    "detailed_description": "Stressed expected loss under Federal Reserve adverse scenario. Primary CCAR/DFAST loss projection.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_el_adv = stressed_pd \u00d7 stressed_lgd \u00d7 stressed_ead",
      "counterparty": "SUM: counterparty.stressed_el_adv = \u03a3(facility_i.stressed_el_adv) WHERE counterparty_id matches",
      "desk": "SUM: desk.stressed_el_adv = \u03a3(facility_i.stressed_el_adv) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.stressed_el_adv = \u03a3(facility_i.stressed_el_adv) WHERE portfolio_id matches",
      "lob": "SUM: lob.stressed_el_adv = \u03a3(facility_i.stressed_el_adv) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "STRESSED_PD_ADV, STRESSED_LGD_ADV, EAD (stressed)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed EL \u2013 Adverse sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Testing Engine \u2192 facility.stressed_el_adv = stressed_pd \u00d7 stressed_lgd \u00d7 stressed_ead \u2192 facility.stressed_el_adv\nDependencies: STRESSED_PD_ADV, STRESSED_LGD_ADV, EAD (stressed)",
      "counterparty": "SUM: \u03a3(facility.stressed_el_adv) WHERE counterparty_id = target \u2192 counterparty.stressed_el_adv",
      "desk": "SUM: \u03a3(facility.stressed_el_adv) WHERE desk_id = target \u2192 desk.stressed_el_adv",
      "portfolio": "SUM: \u03a3(facility.stressed_el_adv) WHERE portfolio_id = target \u2192 portfolio.stressed_el_adv",
      "lob": "SUM: \u03a3(facility.stressed_el_adv) WHERE lob_id = target \u2192 lob.stressed_el_adv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_EL_RATE_ADV",
    "variant_name": "Stressed EL Rate \u2013 Adverse",
    "parent_metric_id": "STRESSED_EL_RATE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed_EL / Stressed_Exposure \u00d7 100 [Adverse] \u2014 recalculated at each level",
    "detailed_description": "Loss rate under Federal Reserve adverse scenario. Recalculated from summed components at each level.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = stressed_el / stressed_exposure \u00d7 100",
      "counterparty": "RECALCULATED: \u03a3(stressed_el) / \u03a3(stressed_exposure) \u00d7 100 at counterparty",
      "desk": "RECALCULATED: same formula at desk level",
      "portfolio": "RECALCULATED: same formula at portfolio level",
      "lob": "RECALCULATED: same formula at LOB level"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 always derived",
    "calculation_authority_components": "Stressed EL, Stressed Exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "all levels"
    ],
    "sourcing_level_rationale": "Ratio recalculated at every level",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: stressed_el / stressed_exp \u00d7 100 \u2192 facility [Adverse]",
      "counterparty": "RECALCULATE: \u03a3(s_el)/\u03a3(s_exp)\u00d7100 \u2192 cpty [Adverse]",
      "desk": "RECALCULATE: same \u2192 desk [Adverse]",
      "portfolio": "RECALCULATE: same \u2192 portfolio [Adverse]",
      "lob": "RECALCULATE: same \u2192 lob [Adverse]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESS_CAP_IMPACT_ADV",
    "variant_name": "Stress Capital Impact \u2013 Adverse",
    "parent_metric_id": "STRESS_CAP_IMPACT",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Stressed_EL - Baseline_EL) / Capital \u00d7 100 [Adverse]",
    "detailed_description": "Change in required capital under Federal Reserve adverse scenario vs baseline.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = (stressed_el_adv - baseline_el) / capital_allocated \u00d7 100",
      "counterparty": "RECALCULATED: (\u03a3 stressed_el - \u03a3 baseline_el) / \u03a3 capital \u00d7 100 at counterparty",
      "desk": "RECALCULATED: same at desk",
      "portfolio": "RECALCULATED: same at portfolio",
      "lob": "RECALCULATED: same at LOB"
    },
    "weighting_basis": "BY_CAPITAL",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Engine + Capital",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 derived from stressed and baseline EL + capital",
    "calculation_authority_components": "STRESSED_EL_ADV, EL (baseline), CAP_ALLOC",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "all levels"
    ],
    "sourcing_level_rationale": "Recalculated at every level",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: (s_el - b_el) / capital \u00d7 100 \u2192 facility [Adverse]",
      "counterparty": "RECALCULATE: (\u03a3 s_el - \u03a3 b_el) / \u03a3 capital \u00d7 100 \u2192 cpty [Adverse]",
      "desk": "RECALCULATE: same \u2192 desk [Adverse]",
      "portfolio": "RECALCULATE: same \u2192 portfolio [Adverse]",
      "lob": "RECALCULATE: same \u2192 lob [Adverse]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESS_LOSS_DELTA_ADV",
    "variant_name": "Stress Loss Delta \u2013 Adverse",
    "parent_metric_id": "STRESS_LOSS_DELTA",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed_EL - Baseline_EL [Adverse]; summed at all levels",
    "detailed_description": "Incremental expected loss under Federal Reserve adverse scenario vs baseline.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = stressed_el_adv - baseline_el",
      "counterparty": "SUM: counterparty.stress_loss_delta_adv = \u03a3(facility_i.stress_loss_delta_adv) WHERE counterparty_id matches",
      "desk": "SUM: desk.stress_loss_delta_adv = \u03a3(facility_i.stress_loss_delta_adv) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.stress_loss_delta_adv = \u03a3(facility_i.stress_loss_delta_adv) WHERE portfolio_id matches",
      "lob": "SUM: lob.stress_loss_delta_adv = \u03a3(facility_i.stress_loss_delta_adv) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "STRESSED_EL_ADV, EL (baseline)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stress Loss Delta \u2013 Adverse sourced at facility; summed additively at all levels",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Calculated \u2192 facility = stressed_el_adv - baseline_el \u2192 facility.stress_loss_delta_adv\nDependencies: STRESSED_EL_ADV, EL (baseline)",
      "counterparty": "SUM: \u03a3(facility.stress_loss_delta_adv) WHERE counterparty_id = target \u2192 counterparty.stress_loss_delta_adv",
      "desk": "SUM: \u03a3(facility.stress_loss_delta_adv) WHERE desk_id = target \u2192 desk.stress_loss_delta_adv",
      "portfolio": "SUM: \u03a3(facility.stress_loss_delta_adv) WHERE portfolio_id = target \u2192 portfolio.stress_loss_delta_adv",
      "lob": "SUM: \u03a3(facility.stress_loss_delta_adv) WHERE lob_id = target \u2192 lob.stress_loss_delta_adv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_DSCR_ADV",
    "variant_name": "Stressed DSCR \u2013 Adverse",
    "parent_metric_id": "STRESSED_DSCR",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed CF / Stressed TDS [Adverse]; exposure-weighted avg at higher levels",
    "detailed_description": "DSCR under Federal Reserve adverse scenario. Covenant breach risk under adverse conditions.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_dscr_adv = stressed_cashflow_adv / stressed_tds_adv",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_dscr_adv = \u03a3(facility_i.stressed_dscr_adv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_dscr_adv = \u03a3(facility_i.stressed_dscr_adv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_dscr_adv = \u03a3(facility_i.stressed_dscr_adv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_dscr_adv = \u03a3(facility_i.stressed_dscr_adv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "Stressed CF, Stressed TDS [Adverse]",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed DSCR \u2013 Adverse calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Engine \u2192 stressed CF and TDS \u2192 ratio \u2192 facility.stressed_dscr_adv",
      "counterparty": "AGGREGATE: {facility.stressed_dscr_adv, facility.exposure} \u2192 \u03a3(stressed_dscr_adv\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.stressed_dscr_adv\nDependencies: Stressed DSCR \u2013 Adverse (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.stressed_dscr_adv, facility.exposure} \u2192 \u03a3(stressed_dscr_adv\u00d7exposure)/\u03a3(exposure) \u2192 desk.stressed_dscr_adv",
      "portfolio": "AGGREGATE: {facility.stressed_dscr_adv, facility.exposure} \u2192 \u03a3(stressed_dscr_adv\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.stressed_dscr_adv",
      "lob": "AGGREGATE: {facility.stressed_dscr_adv, facility.exposure} \u2192 \u03a3(stressed_dscr_adv\u00d7exposure)/\u03a3(exposure) \u2192 lob.stressed_dscr_adv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_LTV_ADV",
    "variant_name": "Stressed LTV \u2013 Adverse",
    "parent_metric_id": "STRESSED_LTV",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Exposure / Stressed Collateral \u00d7 100 [Adverse]; exposure-weighted avg at higher levels",
    "detailed_description": "LTV under Federal Reserve adverse scenario. Downside collateral coverage.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_ltv_adv = facility.exposure / stressed_collateral_value_adv \u00d7 100",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_ltv_adv = \u03a3(facility_i.stressed_ltv_adv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_ltv_adv = \u03a3(facility_i.stressed_ltv_adv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_ltv_adv = \u03a3(facility_i.stressed_ltv_adv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_ltv_adv = \u03a3(facility_i.stressed_ltv_adv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "Exposure, Stressed Collateral [Adverse]",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed LTV \u2013 Adverse calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: {exposure, stressed_collateral} \u2192 exp/coll\u00d7100 \u2192 facility.stressed_ltv_adv",
      "counterparty": "AGGREGATE: {facility.stressed_ltv_adv, facility.exposure} \u2192 \u03a3(stressed_ltv_adv\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.stressed_ltv_adv\nDependencies: Stressed LTV \u2013 Adverse (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.stressed_ltv_adv, facility.exposure} \u2192 \u03a3(stressed_ltv_adv\u00d7exposure)/\u03a3(exposure) \u2192 desk.stressed_ltv_adv",
      "portfolio": "AGGREGATE: {facility.stressed_ltv_adv, facility.exposure} \u2192 \u03a3(stressed_ltv_adv\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.stressed_ltv_adv",
      "lob": "AGGREGATE: {facility.stressed_ltv_adv, facility.exposure} \u2192 \u03a3(stressed_ltv_adv\u00d7exposure)/\u03a3(exposure) \u2192 lob.stressed_ltv_adv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "PROVISION_RATE_ADV",
    "variant_name": "Provision Rate \u2013 Adverse",
    "parent_metric_id": "PROVISION_RATE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Provision / Exposure \u00d7 100 [Adverse] \u2014 recalculated at each level",
    "detailed_description": "Provision expense rate under Federal Reserve adverse scenario.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = provision_adv / exposure \u00d7 100",
      "counterparty": "RECALCULATED: \u03a3(provision) / \u03a3(exposure) \u00d7 100 at counterparty",
      "desk": "RECALCULATED: same at desk",
      "portfolio": "RECALCULATED: same at portfolio",
      "lob": "RECALCULATED: same at LOB"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 always derived",
    "calculation_authority_components": "Provision, Exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "all levels"
    ],
    "sourcing_level_rationale": "Ratio recalculated at each level",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: provision / exposure \u00d7 100 \u2192 facility [Adverse]",
      "counterparty": "RECALCULATE: \u03a3(prov)/\u03a3(exp)\u00d7100 \u2192 cpty [Adverse]",
      "desk": "RECALCULATE: same \u2192 desk [Adverse]",
      "portfolio": "RECALCULATE: same \u2192 portfolio [Adverse]",
      "lob": "RECALCULATE: same \u2192 lob [Adverse]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "PPNR_ADV",
    "variant_name": "PPNR \u2013 Adverse",
    "parent_metric_id": "PPNR",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "NII + Non-II Income - Non-II Expense [Adverse]; summed at aggregation levels",
    "detailed_description": "Pre-provision net revenue under Federal Reserve adverse scenario. Key CCAR revenue projection.",
    "rollup_logic": {
      "facility": "N/A \u2014 PPNR is an aggregated revenue metric, not facility-level",
      "counterparty": "N/A \u2014 PPNR is typically calculated at portfolio/LOB level",
      "desk": "CALCULATED: desk.ppnr_adv = desk.nii + desk.nonii_income - desk.nonii_expense [Adverse]",
      "portfolio": "CALCULATED: portfolio.ppnr_adv = same structure at portfolio",
      "lob": "SUM: lob.ppnr_adv = \u03a3(portfolio.ppnr) OR direct calculation at LOB"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Capital Planning Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 \u2014 calculated from revenue model components",
    "calculation_authority_components": "NII, Non-II Income, Non-II Expense [Adverse]",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Capital Planning / CCAR Engine",
    "reconciliation_anchor_levels": [
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "PPNR is portfolio/LOB-level metric",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "N/A \u2014 not a facility-level metric",
      "counterparty": "N/A \u2014 not counterparty-level",
      "desk": "CALCULATE: NII + NonII_Inc - NonII_Exp \u2192 desk.ppnr [Adverse]",
      "portfolio": "CALCULATE: same \u2192 portfolio.ppnr [Adverse]",
      "lob": "SUM or CALCULATE: \u03a3(portfolio.ppnr) \u2192 lob.ppnr [Adverse]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_PD_SADV",
    "variant_name": "Stressed PD \u2013 Severely Adverse",
    "parent_metric_id": "STRESSED_PD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "PD under Severely Adverse macro scenario; EAD-weighted avg at higher levels",
    "detailed_description": "Stressed PD under Federal Reserve severely adverse scenario. Derived from PD model with stressed macroeconomic inputs or multiplier approach.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_pd_sadv = PD_Baseline \u00d7 Severely Adverse_Multiplier OR PD_Model(stressed_macro_SADV)",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_pd_sadv = \u03a3(facility_i.stressed_pd_sadv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_pd_sadv = \u03a3(facility_i.stressed_pd_sadv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_pd_sadv = \u03a3(facility_i.stressed_pd_sadv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_pd_sadv = \u03a3(facility_i.stressed_pd_sadv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EAD",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "PD (facility), Severely Adverse scenario parameters",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed PD \u2013 Severely Adverse calculated at facility; BY_EAD weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Engine \u2192 {PD_baseline, Severely Adverse_macro} \u2192 stressed PD \u2192 facility.stressed_pd_sadv\nDependencies: PD (facility), Macro scenario Severely Adverse",
      "counterparty": "AGGREGATE: {facility.stressed_pd_sadv, facility.ead} \u2192 \u03a3(stressed_pd_sadv\u00d7ead)/\u03a3(ead) \u2192 counterparty.stressed_pd_sadv\nDependencies: Stressed PD \u2013 Severely Adverse (facility) + EAD (facility)",
      "desk": "AGGREGATE: {facility.stressed_pd_sadv, facility.ead} \u2192 \u03a3(stressed_pd_sadv\u00d7ead)/\u03a3(ead) \u2192 desk.stressed_pd_sadv",
      "portfolio": "AGGREGATE: {facility.stressed_pd_sadv, facility.ead} \u2192 \u03a3(stressed_pd_sadv\u00d7ead)/\u03a3(ead) \u2192 portfolio.stressed_pd_sadv",
      "lob": "AGGREGATE: {facility.stressed_pd_sadv, facility.ead} \u2192 \u03a3(stressed_pd_sadv\u00d7ead)/\u03a3(ead) \u2192 lob.stressed_pd_sadv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_LGD_SADV",
    "variant_name": "Stressed LGD \u2013 Severely Adverse",
    "parent_metric_id": "STRESSED_LGD",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "LGD under Severely Adverse; stressed collateral values; EAD-weighted avg at higher levels",
    "detailed_description": "Stressed LGD under Federal Reserve severely adverse scenario. Incorporates stressed collateral values and recovery assumptions.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_lgd_sadv = LGD_Baseline \u00d7 Severely Adverse_Stress_Factor OR LGD_Model(stressed_collateral_SADV)",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_lgd_sadv = \u03a3(facility_i.stressed_lgd_sadv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_lgd_sadv = \u03a3(facility_i.stressed_lgd_sadv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_lgd_sadv = \u03a3(facility_i.stressed_lgd_sadv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_lgd_sadv = \u03a3(facility_i.stressed_lgd_sadv \u00d7 facility_i.ead) / \u03a3(facility_i.ead) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EAD",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "LGD (facility), COLLATERAL (stressed), Severely Adverse params",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed LGD \u2013 Severely Adverse calculated at facility; BY_EAD weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Engine \u2192 {LGD_baseline, stressed_collateral} \u2192 stressed LGD \u2192 facility.stressed_lgd_sadv\nDependencies: LGD (facility), COLLATERAL stressed, Severely Adverse assumptions",
      "counterparty": "AGGREGATE: {facility.stressed_lgd_sadv, facility.ead} \u2192 \u03a3(stressed_lgd_sadv\u00d7ead)/\u03a3(ead) \u2192 counterparty.stressed_lgd_sadv\nDependencies: Stressed LGD \u2013 Severely Adverse (facility) + EAD (facility)",
      "desk": "AGGREGATE: {facility.stressed_lgd_sadv, facility.ead} \u2192 \u03a3(stressed_lgd_sadv\u00d7ead)/\u03a3(ead) \u2192 desk.stressed_lgd_sadv",
      "portfolio": "AGGREGATE: {facility.stressed_lgd_sadv, facility.ead} \u2192 \u03a3(stressed_lgd_sadv\u00d7ead)/\u03a3(ead) \u2192 portfolio.stressed_lgd_sadv",
      "lob": "AGGREGATE: {facility.stressed_lgd_sadv, facility.ead} \u2192 \u03a3(stressed_lgd_sadv\u00d7ead)/\u03a3(ead) \u2192 lob.stressed_lgd_sadv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_EL_SADV",
    "variant_name": "Stressed EL \u2013 Severely Adverse",
    "parent_metric_id": "STRESSED_EL",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed_PD \u00d7 Stressed_LGD \u00d7 Stressed_EAD under Severely Adverse; summed at all levels",
    "detailed_description": "Stressed expected loss under Federal Reserve severely adverse scenario. Primary CCAR/DFAST loss projection.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_el_sadv = stressed_pd \u00d7 stressed_lgd \u00d7 stressed_ead",
      "counterparty": "SUM: counterparty.stressed_el_sadv = \u03a3(facility_i.stressed_el_sadv) WHERE counterparty_id matches",
      "desk": "SUM: desk.stressed_el_sadv = \u03a3(facility_i.stressed_el_sadv) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.stressed_el_sadv = \u03a3(facility_i.stressed_el_sadv) WHERE portfolio_id matches",
      "lob": "SUM: lob.stressed_el_sadv = \u03a3(facility_i.stressed_el_sadv) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "STRESSED_PD_SADV, STRESSED_LGD_SADV, EAD (stressed)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed EL \u2013 Severely Adverse sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Testing Engine \u2192 facility.stressed_el_sadv = stressed_pd \u00d7 stressed_lgd \u00d7 stressed_ead \u2192 facility.stressed_el_sadv\nDependencies: STRESSED_PD_SADV, STRESSED_LGD_SADV, EAD (stressed)",
      "counterparty": "SUM: \u03a3(facility.stressed_el_sadv) WHERE counterparty_id = target \u2192 counterparty.stressed_el_sadv",
      "desk": "SUM: \u03a3(facility.stressed_el_sadv) WHERE desk_id = target \u2192 desk.stressed_el_sadv",
      "portfolio": "SUM: \u03a3(facility.stressed_el_sadv) WHERE portfolio_id = target \u2192 portfolio.stressed_el_sadv",
      "lob": "SUM: \u03a3(facility.stressed_el_sadv) WHERE lob_id = target \u2192 lob.stressed_el_sadv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_EL_RATE_SADV",
    "variant_name": "Stressed EL Rate \u2013 Severely Adverse",
    "parent_metric_id": "STRESSED_EL_RATE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed_EL / Stressed_Exposure \u00d7 100 [Severely Adverse] \u2014 recalculated at each level",
    "detailed_description": "Loss rate under Federal Reserve severely adverse scenario. Recalculated from summed components at each level.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = stressed_el / stressed_exposure \u00d7 100",
      "counterparty": "RECALCULATED: \u03a3(stressed_el) / \u03a3(stressed_exposure) \u00d7 100 at counterparty",
      "desk": "RECALCULATED: same formula at desk level",
      "portfolio": "RECALCULATED: same formula at portfolio level",
      "lob": "RECALCULATED: same formula at LOB level"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 always derived",
    "calculation_authority_components": "Stressed EL, Stressed Exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "all levels"
    ],
    "sourcing_level_rationale": "Ratio recalculated at every level",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: stressed_el / stressed_exp \u00d7 100 \u2192 facility [Severely Adverse]",
      "counterparty": "RECALCULATE: \u03a3(s_el)/\u03a3(s_exp)\u00d7100 \u2192 cpty [Severely Adverse]",
      "desk": "RECALCULATE: same \u2192 desk [Severely Adverse]",
      "portfolio": "RECALCULATE: same \u2192 portfolio [Severely Adverse]",
      "lob": "RECALCULATE: same \u2192 lob [Severely Adverse]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESS_CAP_IMPACT_SADV",
    "variant_name": "Stress Capital Impact \u2013 Severely Adverse",
    "parent_metric_id": "STRESS_CAP_IMPACT",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Stressed_EL - Baseline_EL) / Capital \u00d7 100 [Severely Adverse]",
    "detailed_description": "Change in required capital under Federal Reserve severely adverse scenario vs baseline.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = (stressed_el_sadv - baseline_el) / capital_allocated \u00d7 100",
      "counterparty": "RECALCULATED: (\u03a3 stressed_el - \u03a3 baseline_el) / \u03a3 capital \u00d7 100 at counterparty",
      "desk": "RECALCULATED: same at desk",
      "portfolio": "RECALCULATED: same at portfolio",
      "lob": "RECALCULATED: same at LOB"
    },
    "weighting_basis": "BY_CAPITAL",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Engine + Capital",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 derived from stressed and baseline EL + capital",
    "calculation_authority_components": "STRESSED_EL_SADV, EL (baseline), CAP_ALLOC",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "all levels"
    ],
    "sourcing_level_rationale": "Recalculated at every level",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: (s_el - b_el) / capital \u00d7 100 \u2192 facility [Severely Adverse]",
      "counterparty": "RECALCULATE: (\u03a3 s_el - \u03a3 b_el) / \u03a3 capital \u00d7 100 \u2192 cpty [Severely Adverse]",
      "desk": "RECALCULATE: same \u2192 desk [Severely Adverse]",
      "portfolio": "RECALCULATE: same \u2192 portfolio [Severely Adverse]",
      "lob": "RECALCULATE: same \u2192 lob [Severely Adverse]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESS_LOSS_DELTA_SADV",
    "variant_name": "Stress Loss Delta \u2013 Severely Adverse",
    "parent_metric_id": "STRESS_LOSS_DELTA",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed_EL - Baseline_EL [Severely Adverse]; summed at all levels",
    "detailed_description": "Incremental expected loss under Federal Reserve severely adverse scenario vs baseline.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = stressed_el_sadv - baseline_el",
      "counterparty": "SUM: counterparty.stress_loss_delta_sadv = \u03a3(facility_i.stress_loss_delta_sadv) WHERE counterparty_id matches",
      "desk": "SUM: desk.stress_loss_delta_sadv = \u03a3(facility_i.stress_loss_delta_sadv) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.stress_loss_delta_sadv = \u03a3(facility_i.stress_loss_delta_sadv) WHERE portfolio_id matches",
      "lob": "SUM: lob.stress_loss_delta_sadv = \u03a3(facility_i.stress_loss_delta_sadv) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "STRESSED_EL_SADV, EL (baseline)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stress Loss Delta \u2013 Severely Adverse sourced at facility; summed additively at all levels",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Calculated \u2192 facility = stressed_el_sadv - baseline_el \u2192 facility.stress_loss_delta_sadv\nDependencies: STRESSED_EL_SADV, EL (baseline)",
      "counterparty": "SUM: \u03a3(facility.stress_loss_delta_sadv) WHERE counterparty_id = target \u2192 counterparty.stress_loss_delta_sadv",
      "desk": "SUM: \u03a3(facility.stress_loss_delta_sadv) WHERE desk_id = target \u2192 desk.stress_loss_delta_sadv",
      "portfolio": "SUM: \u03a3(facility.stress_loss_delta_sadv) WHERE portfolio_id = target \u2192 portfolio.stress_loss_delta_sadv",
      "lob": "SUM: \u03a3(facility.stress_loss_delta_sadv) WHERE lob_id = target \u2192 lob.stress_loss_delta_sadv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_DSCR_SADV",
    "variant_name": "Stressed DSCR \u2013 Severely Adverse",
    "parent_metric_id": "STRESSED_DSCR",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Stressed CF / Stressed TDS [Severely Adverse]; exposure-weighted avg at higher levels",
    "detailed_description": "DSCR under Federal Reserve severely adverse scenario. Covenant breach risk under adverse conditions.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_dscr_sadv = stressed_cashflow_sadv / stressed_tds_sadv",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_dscr_sadv = \u03a3(facility_i.stressed_dscr_sadv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_dscr_sadv = \u03a3(facility_i.stressed_dscr_sadv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_dscr_sadv = \u03a3(facility_i.stressed_dscr_sadv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_dscr_sadv = \u03a3(facility_i.stressed_dscr_sadv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "Stressed CF, Stressed TDS [Severely Adverse]",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed DSCR \u2013 Severely Adverse calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Stress Engine \u2192 stressed CF and TDS \u2192 ratio \u2192 facility.stressed_dscr_sadv",
      "counterparty": "AGGREGATE: {facility.stressed_dscr_sadv, facility.exposure} \u2192 \u03a3(stressed_dscr_sadv\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.stressed_dscr_sadv\nDependencies: Stressed DSCR \u2013 Severely Adverse (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.stressed_dscr_sadv, facility.exposure} \u2192 \u03a3(stressed_dscr_sadv\u00d7exposure)/\u03a3(exposure) \u2192 desk.stressed_dscr_sadv",
      "portfolio": "AGGREGATE: {facility.stressed_dscr_sadv, facility.exposure} \u2192 \u03a3(stressed_dscr_sadv\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.stressed_dscr_sadv",
      "lob": "AGGREGATE: {facility.stressed_dscr_sadv, facility.exposure} \u2192 \u03a3(stressed_dscr_sadv\u00d7exposure)/\u03a3(exposure) \u2192 lob.stressed_dscr_sadv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "STRESSED_LTV_SADV",
    "variant_name": "Stressed LTV \u2013 Severely Adverse",
    "parent_metric_id": "STRESSED_LTV",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Exposure / Stressed Collateral \u00d7 100 [Severely Adverse]; exposure-weighted avg at higher levels",
    "detailed_description": "LTV under Federal Reserve severely adverse scenario. Downside collateral coverage.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.stressed_ltv_sadv = facility.exposure / stressed_collateral_value_sadv \u00d7 100",
      "counterparty": "WEIGHTED AVG: counterparty.stressed_ltv_sadv = \u03a3(facility_i.stressed_ltv_sadv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.stressed_ltv_sadv = \u03a3(facility_i.stressed_ltv_sadv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.stressed_ltv_sadv = \u03a3(facility_i.stressed_ltv_sadv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.stressed_ltv_sadv = \u03a3(facility_i.stressed_ltv_sadv \u00d7 facility_i.exposure) / \u03a3(facility_i.exposure) WHERE lob_id matches"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "Exposure, Stressed Collateral [Severely Adverse]",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Stress Testing Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Stressed LTV \u2013 Severely Adverse calculated at facility; BY_EXPOSURE weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: {exposure, stressed_collateral} \u2192 exp/coll\u00d7100 \u2192 facility.stressed_ltv_sadv",
      "counterparty": "AGGREGATE: {facility.stressed_ltv_sadv, facility.exposure} \u2192 \u03a3(stressed_ltv_sadv\u00d7exposure)/\u03a3(exposure) \u2192 counterparty.stressed_ltv_sadv\nDependencies: Stressed LTV \u2013 Severely Adverse (facility) + EXPOSURE (facility)",
      "desk": "AGGREGATE: {facility.stressed_ltv_sadv, facility.exposure} \u2192 \u03a3(stressed_ltv_sadv\u00d7exposure)/\u03a3(exposure) \u2192 desk.stressed_ltv_sadv",
      "portfolio": "AGGREGATE: {facility.stressed_ltv_sadv, facility.exposure} \u2192 \u03a3(stressed_ltv_sadv\u00d7exposure)/\u03a3(exposure) \u2192 portfolio.stressed_ltv_sadv",
      "lob": "AGGREGATE: {facility.stressed_ltv_sadv, facility.exposure} \u2192 \u03a3(stressed_ltv_sadv\u00d7exposure)/\u03a3(exposure) \u2192 lob.stressed_ltv_sadv"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "PROVISION_RATE_SADV",
    "variant_name": "Provision Rate \u2013 Severely Adverse",
    "parent_metric_id": "PROVISION_RATE",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Provision / Exposure \u00d7 100 [Severely Adverse] \u2014 recalculated at each level",
    "detailed_description": "Provision expense rate under Federal Reserve severely adverse scenario.",
    "rollup_logic": {
      "facility": "CALCULATED: facility = provision_sadv / exposure \u00d7 100",
      "counterparty": "RECALCULATED: \u03a3(provision) / \u03a3(exposure) \u00d7 100 at counterparty",
      "desk": "RECALCULATED: same at desk",
      "portfolio": "RECALCULATED: same at portfolio",
      "lob": "RECALCULATED: same at LOB"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Stress Testing Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 \u2014 always derived",
    "calculation_authority_components": "Provision, Exposure",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "all levels"
    ],
    "sourcing_level_rationale": "Ratio recalculated at each level",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: provision / exposure \u00d7 100 \u2192 facility [Severely Adverse]",
      "counterparty": "RECALCULATE: \u03a3(prov)/\u03a3(exp)\u00d7100 \u2192 cpty [Severely Adverse]",
      "desk": "RECALCULATE: same \u2192 desk [Severely Adverse]",
      "portfolio": "RECALCULATE: same \u2192 portfolio [Severely Adverse]",
      "lob": "RECALCULATE: same \u2192 lob [Severely Adverse]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "PPNR_SADV",
    "variant_name": "PPNR \u2013 Severely Adverse",
    "parent_metric_id": "PPNR",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "NII + Non-II Income - Non-II Expense [Severely Adverse]; summed at aggregation levels",
    "detailed_description": "Pre-provision net revenue under Federal Reserve severely adverse scenario. Key CCAR revenue projection.",
    "rollup_logic": {
      "facility": "N/A \u2014 PPNR is an aggregated revenue metric, not facility-level",
      "counterparty": "N/A \u2014 PPNR is typically calculated at portfolio/LOB level",
      "desk": "CALCULATED: desk.ppnr_sadv = desk.nii + desk.nonii_income - desk.nonii_expense [Severely Adverse]",
      "portfolio": "CALCULATED: portfolio.ppnr_sadv = same structure at portfolio",
      "lob": "SUM: lob.ppnr_sadv = \u03a3(portfolio.ppnr) OR direct calculation at LOB"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Capital Planning Engine",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 \u2014 calculated from revenue model components",
    "calculation_authority_components": "NII, Non-II Income, Non-II Expense [Severely Adverse]",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Capital Planning / CCAR Engine",
    "reconciliation_anchor_levels": [
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "PPNR is portfolio/LOB-level metric",
    "sourcing_category": "flexible_level",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "N/A \u2014 not a facility-level metric",
      "counterparty": "N/A \u2014 not counterparty-level",
      "desk": "CALCULATE: NII + NonII_Inc - NonII_Exp \u2192 desk.ppnr [Severely Adverse]",
      "portfolio": "CALCULATE: same \u2192 portfolio.ppnr [Severely Adverse]",
      "lob": "SUM or CALCULATE: \u03a3(portfolio.ppnr) \u2192 lob.ppnr [Severely Adverse]"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "RWA",
    "variant_name": "RWA",
    "parent_metric_id": "RWA",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "EAD \u00d7 Risk_Weight at facility; summed at all levels",
    "detailed_description": "RWA calculated at facility. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.rwa = EAD \u00d7 Risk_Weight",
      "counterparty": "SUM: counterparty.rwa = \u03a3(facility_i.rwa) WHERE counterparty_id matches",
      "desk": "SUM: desk.rwa = \u03a3(facility_i.rwa) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.rwa = \u03a3(facility_i.rwa) WHERE portfolio_id matches",
      "lob": "SUM: lob.rwa = \u03a3(facility_i.rwa) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Capital Engine",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "EAD, risk_weight",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Capital Management System",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "RWA sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Capital Engine \u2192 facility.rwa = EAD \u00d7 Risk_Weight \u2192 facility.rwa\nDependencies: EAD, risk_weight",
      "counterparty": "SUM: \u03a3(facility.rwa) WHERE counterparty_id = target \u2192 counterparty.rwa",
      "desk": "SUM: \u03a3(facility.rwa) WHERE desk_id = target \u2192 desk.rwa",
      "portfolio": "SUM: \u03a3(facility.rwa) WHERE portfolio_id = target \u2192 portfolio.rwa",
      "lob": "SUM: \u03a3(facility.rwa) WHERE lob_id = target \u2192 lob.rwa"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "SA_RWA",
    "variant_name": "Standardized RWA",
    "parent_metric_id": "SA_RWA",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "EAD \u00d7 SA_Risk_Weight at facility; summed at all levels",
    "detailed_description": "Standardized RWA calculated at facility. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.sa_rwa = EAD \u00d7 SA_Risk_Weight",
      "counterparty": "SUM: counterparty.sa_rwa = \u03a3(facility_i.sa_rwa) WHERE counterparty_id matches",
      "desk": "SUM: desk.sa_rwa = \u03a3(facility_i.sa_rwa) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.sa_rwa = \u03a3(facility_i.sa_rwa) WHERE portfolio_id matches",
      "lob": "SUM: lob.sa_rwa = \u03a3(facility_i.sa_rwa) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Capital Engine",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "EAD, SA_risk_weight",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Capital Management System",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Standardized RWA sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Capital Engine \u2192 facility.sa_rwa = EAD \u00d7 SA_Risk_Weight \u2192 facility.sa_rwa\nDependencies: EAD, SA_risk_weight",
      "counterparty": "SUM: \u03a3(facility.sa_rwa) WHERE counterparty_id = target \u2192 counterparty.sa_rwa",
      "desk": "SUM: \u03a3(facility.sa_rwa) WHERE desk_id = target \u2192 desk.sa_rwa",
      "portfolio": "SUM: \u03a3(facility.sa_rwa) WHERE portfolio_id = target \u2192 portfolio.sa_rwa",
      "lob": "SUM: \u03a3(facility.sa_rwa) WHERE lob_id = target \u2192 lob.sa_rwa"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "IRB_RWA",
    "variant_name": "IRB RWA",
    "parent_metric_id": "IRB_RWA",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "EAD \u00d7 IRB_Weight(PD,LGD,M) at facility; summed at all levels",
    "detailed_description": "IRB RWA calculated at facility. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.irb_rwa = EAD \u00d7 IRB_Weight(PD,LGD,M)",
      "counterparty": "SUM: counterparty.irb_rwa = \u03a3(facility_i.irb_rwa) WHERE counterparty_id matches",
      "desk": "SUM: desk.irb_rwa = \u03a3(facility_i.irb_rwa) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.irb_rwa = \u03a3(facility_i.irb_rwa) WHERE portfolio_id matches",
      "lob": "SUM: lob.irb_rwa = \u03a3(facility_i.irb_rwa) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Capital Engine",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "EAD, PD, LGD, maturity",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Capital Management System",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "IRB RWA sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Capital Engine \u2192 facility.irb_rwa = EAD \u00d7 IRB_Weight(PD,LGD,M) \u2192 facility.irb_rwa\nDependencies: EAD, PD, LGD, maturity",
      "counterparty": "SUM: \u03a3(facility.irb_rwa) WHERE counterparty_id = target \u2192 counterparty.irb_rwa",
      "desk": "SUM: \u03a3(facility.irb_rwa) WHERE desk_id = target \u2192 desk.irb_rwa",
      "portfolio": "SUM: \u03a3(facility.irb_rwa) WHERE portfolio_id = target \u2192 portfolio.irb_rwa",
      "lob": "SUM: \u03a3(facility.irb_rwa) WHERE lob_id = target \u2192 lob.irb_rwa"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "CET1_CONSUMPTION",
    "variant_name": "CET1 Consumption",
    "parent_metric_id": "CET1_CONSUMPTION",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "RWA \u00d7 CET1_Ratio at facility; summed at all levels",
    "detailed_description": "CET1 Consumption calculated at facility. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.cet1_consumption = RWA \u00d7 CET1_Ratio",
      "counterparty": "SUM: counterparty.cet1_consumption = \u03a3(facility_i.cet1_consumption) WHERE counterparty_id matches",
      "desk": "SUM: desk.cet1_consumption = \u03a3(facility_i.cet1_consumption) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.cet1_consumption = \u03a3(facility_i.cet1_consumption) WHERE portfolio_id matches",
      "lob": "SUM: lob.cet1_consumption = \u03a3(facility_i.cet1_consumption) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Capital Engine",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "RWA, CET1_ratio",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Capital Management System",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "CET1 Consumption sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Capital Engine \u2192 facility.cet1_consumption = RWA \u00d7 CET1_Ratio \u2192 facility.cet1_consumption\nDependencies: RWA, CET1_ratio",
      "counterparty": "SUM: \u03a3(facility.cet1_consumption) WHERE counterparty_id = target \u2192 counterparty.cet1_consumption",
      "desk": "SUM: \u03a3(facility.cet1_consumption) WHERE desk_id = target \u2192 desk.cet1_consumption",
      "portfolio": "SUM: \u03a3(facility.cet1_consumption) WHERE portfolio_id = target \u2192 portfolio.cet1_consumption",
      "lob": "SUM: \u03a3(facility.cet1_consumption) WHERE lob_id = target \u2192 lob.cet1_consumption"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "LEVERAGE_EXP",
    "variant_name": "Leverage Exposure",
    "parent_metric_id": "LEVERAGE_EXP",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "On-balance + Off-balance adj at facility; summed at all levels",
    "detailed_description": "Leverage Exposure calculated at facility. Summed additively at all aggregation levels.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.leverage_exp = On-balance + Off-balance adj",
      "counterparty": "SUM: counterparty.leverage_exp = \u03a3(facility_i.leverage_exp) WHERE counterparty_id matches",
      "desk": "SUM: desk.leverage_exp = \u03a3(facility_i.leverage_exp) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.leverage_exp = \u03a3(facility_i.leverage_exp) WHERE portfolio_id matches",
      "lob": "SUM: lob.leverage_exp = \u03a3(facility_i.leverage_exp) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Capital Engine",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "on_balance_exp, off_balance_adj",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Capital Management System",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Leverage Exposure sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Capital Engine \u2192 facility.leverage_exp = On-balance + Off-balance adj \u2192 facility.leverage_exp\nDependencies: on_balance_exp, off_balance_adj",
      "counterparty": "SUM: \u03a3(facility.leverage_exp) WHERE counterparty_id = target \u2192 counterparty.leverage_exp",
      "desk": "SUM: \u03a3(facility.leverage_exp) WHERE desk_id = target \u2192 desk.leverage_exp",
      "portfolio": "SUM: \u03a3(facility.leverage_exp) WHERE portfolio_id = target \u2192 portfolio.leverage_exp",
      "lob": "SUM: \u03a3(facility.leverage_exp) WHERE lob_id = target \u2192 lob.leverage_exp"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "RWA_DENSITY",
    "variant_name": "RWA Density",
    "parent_metric_id": "RWA_DENSITY",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "RWA / Exposure \u00d7 100 \u2014 recalculated at each level",
    "detailed_description": "Capital intensity metric. Recalculated from summed RWA and exposure at each level.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.rwa_density = (facility.rwa / facility.exposure) \u00d7 100\nIf exposure = 0: rwa_density = NULL",
      "counterparty": "RECALCULATED: counterparty.rwa_density = (\u03a3 facility.rwa / \u03a3 facility.exposure) \u00d7 100\nNOT avg of facility-level rates \u2014 use component sums",
      "desk": "RECALCULATED: desk.rwa_density = (\u03a3 facility.rwa / \u03a3 facility.exposure) \u00d7 100 FOR ALL facility IN desk",
      "portfolio": "RECALCULATED: portfolio.rwa_density = (\u03a3 facility.rwa / \u03a3 facility.exposure) \u00d7 100 FOR ALL facility IN portfolio",
      "lob": "RECALCULATED: lob.rwa_density = (\u03a3 facility.rwa / \u03a3 facility.exposure) \u00d7 100 FOR ALL facility IN LOB"
    },
    "weighting_basis": "BY_EXPOSURE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from components",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T3 at all levels \u2014 always recalculated from component sums",
    "calculation_authority_components": "RWA (at level), Exposure (at level)",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in analytics layer",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "Ratio recalculated at every level from summed RWA and Exposure",
    "sourcing_category": "flexible_level",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: facility.rwa / facility.exposure \u00d7 100 \u2192 facility.rwa_density\nDependencies: RWA (facility), Exposure (facility)",
      "counterparty": "RECALCULATE: \u03a3(facility.rwa) / \u03a3(facility.exposure) \u00d7 100 \u2192 counterparty.rwa_density\nCRITICAL: Use component sums, not avg of rates",
      "desk": "RECALCULATE: \u03a3(fac.rwa) / \u03a3(fac.exposure) \u00d7 100 \u2192 desk.rwa_density",
      "portfolio": "RECALCULATE: \u03a3(fac.rwa) / \u03a3(fac.exposure) \u00d7 100 \u2192 portfolio.rwa_density",
      "lob": "RECALCULATE: \u03a3(fac.rwa) / \u03a3(fac.exposure) \u00d7 100 \u2192 lob.rwa_density"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "RAROC",
    "variant_name": "RAROC",
    "parent_metric_id": "RAROC",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "(Net Income - EL) / Capital Allocated \u00d7 100; recalculated at each level",
    "detailed_description": "Risk-adjusted return on capital. Recalculated at each level from aggregated components.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.raroc = (facility.net_income - facility.el) / facility.cap_alloc \u00d7 100",
      "counterparty": "WEIGHTED AVG: counterparty.raroc = \u03a3(facility_i.raroc \u00d7 facility_i.cap_alloc) / \u03a3(facility_i.cap_alloc) WHERE counterparty_id matches",
      "desk": "WEIGHTED AVG: desk.raroc = \u03a3(facility_i.raroc \u00d7 facility_i.cap_alloc) / \u03a3(facility_i.cap_alloc) WHERE desk_id matches",
      "portfolio": "WEIGHTED AVG: portfolio.raroc = \u03a3(facility_i.raroc \u00d7 facility_i.cap_alloc) / \u03a3(facility_i.cap_alloc) WHERE portfolio_id matches",
      "lob": "WEIGHTED AVG: lob.raroc = \u03a3(facility_i.raroc \u00d7 facility_i.cap_alloc) / \u03a3(facility_i.cap_alloc) WHERE lob_id matches"
    },
    "weighting_basis": "BY_CAPITAL",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Calculated from components",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T3",
    "calculation_authority_tier_future": "T3",
    "calculation_authority_rationale": "T2 at facility (calculated); T3 at all higher levels (weighted aggregation)",
    "calculation_authority_components": "net_income, el, cap_alloc",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Calculated in Capital Engine",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "RAROC calculated at facility; BY_CAPITAL weighted average at all higher levels",
    "sourcing_category": "facility",
    "data_lag": "T+2",
    "lineage_by_level": {
      "facility": "CALCULATE: Components \u2192 (NI - EL) / Capital \u2192 facility.raroc\nDependencies: NET_INCOME, EL, CAP_ALLOC",
      "counterparty": "AGGREGATE: {facility.raroc, facility.cap_alloc} \u2192 \u03a3(raroc\u00d7cap_alloc)/\u03a3(cap_alloc) \u2192 counterparty.raroc\nDependencies: RAROC (facility) + CAP_ALLOC (facility)",
      "desk": "AGGREGATE: {facility.raroc, facility.cap_alloc} \u2192 \u03a3(raroc\u00d7cap_alloc)/\u03a3(cap_alloc) \u2192 desk.raroc",
      "portfolio": "AGGREGATE: {facility.raroc, facility.cap_alloc} \u2192 \u03a3(raroc\u00d7cap_alloc)/\u03a3(cap_alloc) \u2192 portfolio.raroc",
      "lob": "AGGREGATE: {facility.raroc, facility.cap_alloc} \u2192 \u03a3(raroc\u00d7cap_alloc)/\u03a3(cap_alloc) \u2192 lob.raroc"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "FR2590_EXP",
    "variant_name": "FR 2590 Reportable Exposure",
    "parent_metric_id": "FR2590_EXP",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "SUM(exposure) WHERE counterparty meets 2590 threshold; summed at higher levels",
    "detailed_description": "FR 2590 large exposure reporting. Filtered by threshold (>5% of Tier 1 capital).",
    "rollup_logic": {
      "facility": "CALCULATED: counterparty.fr2590_exp = SUM(exposure) WHERE \u2265 threshold",
      "counterparty": "SUM: counterparty.fr2590_exp = \u03a3(facility_i.fr2590_exp) WHERE counterparty_id matches",
      "desk": "SUM: desk.fr2590_exp = \u03a3(facility_i.fr2590_exp) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.fr2590_exp = \u03a3(facility_i.fr2590_exp) WHERE portfolio_id matches",
      "lob": "SUM: lob.fr2590_exp = \u03a3(facility_i.fr2590_exp) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Regulatory Reporting",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "exposure (counterparty), tier_1_capital, 5% threshold",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Regulatory Reporting Engine",
    "atomic_sourcing_level": "counterparty",
    "reconciliation_anchor_levels": [
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "FR 2590 Reportable Exposure sourced at facility; summed additively at all levels",
    "sourcing_category": "obligor",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Regulatory Reporting \u2192 counterparty.fr2590_exp = SUM(exposure) WHERE \u2265 threshold \u2192 facility.fr2590_exp\nDependencies: exposure (counterparty), tier_1_capital, 5% threshold",
      "counterparty": "SUM: \u03a3(facility.fr2590_exp) WHERE counterparty_id = target \u2192 counterparty.fr2590_exp",
      "desk": "SUM: \u03a3(facility.fr2590_exp) WHERE desk_id = target \u2192 desk.fr2590_exp",
      "portfolio": "SUM: \u03a3(facility.fr2590_exp) WHERE portfolio_id = target \u2192 portfolio.fr2590_exp",
      "lob": "SUM: \u03a3(facility.fr2590_exp) WHERE lob_id = target \u2192 lob.fr2590_exp"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "Y14Q_EXP",
    "variant_name": "FR Y-14Q Schedule H.1 Exposure",
    "parent_metric_id": "Y14Q_EXP",
    "variant_type": "CALCULATED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Exposure per Y-14Q field definitions; summed at all levels",
    "detailed_description": "Wholesale credit exposure mapped to FR Y-14Q Schedule H.1 field definitions.",
    "rollup_logic": {
      "facility": "CALCULATED: facility.y14q_exp = exposure mapped to Y-14Q fields",
      "counterparty": "SUM: counterparty.y14q_exp = \u03a3(facility_i.y14q_exp) WHERE counterparty_id matches",
      "desk": "SUM: desk.y14q_exp = \u03a3(facility_i.y14q_exp) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.y14q_exp = \u03a3(facility_i.y14q_exp) WHERE portfolio_id matches",
      "lob": "SUM: lob.y14q_exp = \u03a3(facility_i.y14q_exp) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Regulatory Reporting",
    "refresh_frequency": "QUARTERLY",
    "calculation_authority_tier": "T2",
    "calculation_authority_tier_future": "T2",
    "calculation_authority_rationale": "T2 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "exposure, Y-14Q field mappings",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Regulatory Reporting Engine",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Regulatory feed",
    "source_endpoint_or_feed": "/feeds/y14q_exp",
    "source_variant_identifier": "fac_y14q_exp",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "exposure_usd",
        "required": true
      },
      {
        "field_name": "schedule_field_mappings",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Validate Y-14Q field mapping",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "FR Y-14Q Schedule H.1 Exposure sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+5",
    "lineage_by_level": {
      "facility": "CALCULATE: Regulatory Reporting \u2192 facility.y14q_exp = exposure mapped to Y-14Q fields \u2192 facility.y14q_exp\nDependencies: exposure, Y-14Q field mappings",
      "counterparty": "SUM: \u03a3(facility.y14q_exp) WHERE counterparty_id = target \u2192 counterparty.y14q_exp",
      "desk": "SUM: \u03a3(facility.y14q_exp) WHERE desk_id = target \u2192 desk.y14q_exp",
      "portfolio": "SUM: \u03a3(facility.y14q_exp) WHERE portfolio_id = target \u2192 portfolio.y14q_exp",
      "lob": "SUM: \u03a3(facility.y14q_exp) WHERE lob_id = target \u2192 lob.y14q_exp"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  },
  {
    "variant_id": "Y14M_EXP",
    "variant_name": "FR Y-14M Monthly Exposure",
    "parent_metric_id": "Y14M_EXP",
    "variant_type": "SOURCED",
    "status": "ACTIVE",
    "version": "v1.0",
    "effective_date": "2026-02-21",
    "formula_display": "Monthly facility exposure snapshot; summed at all levels",
    "detailed_description": "Monthly granular facility-level exposure for FR Y-14M.",
    "rollup_logic": {
      "facility": "RAW SOURCE: facility.y14m_exp = monthly exposure snapshot",
      "counterparty": "SUM: counterparty.y14m_exp = \u03a3(facility_i.y14m_exp) WHERE counterparty_id matches",
      "desk": "SUM: desk.y14m_exp = \u03a3(facility_i.y14m_exp) WHERE desk_id matches",
      "portfolio": "SUM: portfolio.y14m_exp = \u03a3(facility_i.y14m_exp) WHERE portfolio_id matches",
      "lob": "SUM: lob.y14m_exp = \u03a3(facility_i.y14m_exp) WHERE lob_id matches"
    },
    "weighting_basis": "ADDITIVE",
    "owner_team": "Risk",
    "review_cycle": "QUARTERLY",
    "source_system": "Regulatory Reporting",
    "refresh_frequency": "MONTHLY",
    "calculation_authority_tier": "T1",
    "calculation_authority_tier_future": "T1",
    "calculation_authority_rationale": "T1 at facility; T3 at all higher levels (additive sum)",
    "calculation_authority_components": "exposure_monthly_usd",
    "calculation_authority_future_evolution": "Stable",
    "calculation_authority_migration_path": "N/A",
    "expected_gsib_data_source": "Core Banking / Reg Reporting",
    "source_integration_pattern": "PUSH",
    "source_delivery_method": "Regulatory feed",
    "source_endpoint_or_feed": "/feeds/y14m_exp",
    "source_variant_identifier": "fac_y14m_exp",
    "source_payload_spec": [
      {
        "field_name": "facility_id",
        "required": true
      },
      {
        "field_name": "exposure_usd",
        "required": true
      },
      {
        "field_name": "as_of_month",
        "required": true
      }
    ],
    "source_setup_validation_notes": "Verify monthly snapshot date",
    "atomic_sourcing_level": "facility",
    "reconciliation_anchor_levels": [
      "facility",
      "counterparty",
      "desk",
      "portfolio",
      "lob"
    ],
    "sourcing_level_rationale": "FR Y-14M Monthly Exposure sourced at facility; summed additively at all levels",
    "sourcing_category": "facility",
    "data_format": "JSON",
    "data_lag": "T+1",
    "lineage_by_level": {
      "facility": "SOURCE: Regulatory Reporting \u2192 facility.y14m_exp = monthly exposure snapshot \u2192 facility.y14m_exp\nDependencies: exposure_monthly_usd",
      "counterparty": "SUM: \u03a3(facility.y14m_exp) WHERE counterparty_id = target \u2192 counterparty.y14m_exp",
      "desk": "SUM: \u03a3(facility.y14m_exp) WHERE desk_id = target \u2192 desk.y14m_exp",
      "portfolio": "SUM: \u03a3(facility.y14m_exp) WHERE portfolio_id = target \u2192 portfolio.y14m_exp",
      "lob": "SUM: \u03a3(facility.y14m_exp) WHERE lob_id = target \u2192 lob.y14m_exp"
    },
    "created_at": "2026-02-22T00:02:30.508713Z",
    "updated_at": "2026-02-22T00:02:30.508713Z"
  }
]