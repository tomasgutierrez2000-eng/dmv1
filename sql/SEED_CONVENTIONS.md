# Seed data conventions (MVP linked data)

Use a **single as_of_date** and **single run_version_id** for all artificial data, and **shared dimension IDs** across L1, L2, and L3 so joins and formulaSQL return consistent results.

## ID and date conventions

| Dimension        | Convention   | Used in |
|------------------|-------------|---------|
| `facility_id`    | 1..10       | L1.facility_master, L2.position, L2.facility_exposure_snapshot, L3 |
| `counterparty_id`| 1..10       | L1.counterparty, L2.position, L2.facility_exposure_snapshot, L3 |
| `legal_entity_id`| 1           | L1, L2, L3 |
| `as_of_date`     | 2025-01-31  | All L2 snapshots and L3 |
| `run_version_id` | RUN_MVP_001 | L3 only |

## Execution order

1. **L1**: Run `scripts/l1/output/ddl.sql` then `scripts/l1/output/seed.sql`.
2. **L2**: Run `scripts/l2/output/ddl.sql` then `scripts/l2/output/seed.sql` (generated by `npx tsx scripts/l2/generate.ts`).
3. **L3**: Run `sql/l3/01_DDL_all_tables.sql`; optionally `CALL l3.run_full_population('RUN_MVP_001', '2025-01-31');`.
4. **metric_value_fact**: Filled by app batch script or on-demand calculation.

## Linking rules

- L2 seed rows must reference only **facility_id** and **counterparty_id** values that exist in L1 seed (1..10).
- All L2 snapshot tables must use the same **as_of_date** (2025-01-31) so L3 population and metric formulaSQL joins resolve.
- When using the values API or batch job, pass **runVersion=RUN_MVP_001** and **asOfDate=2025-01-31** so the UI shows linked data.
